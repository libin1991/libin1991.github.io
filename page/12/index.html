<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="èˆåŠ¨ä¹¾å¤">
<meta property="og:url" content="http://yoursite.com/page/12/index.html">
<meta property="og:site_name" content="èˆåŠ¨ä¹¾å¤">
<meta property="og:description" content="Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="èˆåŠ¨ä¹¾å¤">
<meta name="twitter:description" content="Blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/12/">





  <title>èˆåŠ¨ä¹¾å¤ - æ˜Ÿå…‰ä¸é—®èµ¶è·¯äºº å²æœˆä¸è´Ÿæœ‰å¿ƒäºº</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband">
    	<div class="eevee"><div class="body"><div class="head"><div class="ears"><div class="ear"><div class="lobe"></div></div><div class="ear"><div class="lobe"></div></div></div><div class="face"><div class="eyes"><div class="eye"><div class="eyelid"></div></div><div class="eye"><div class="eyelid"></div></div></div><div class="nose"></div><div class="mouth"></div></div></div><div class="chest"><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div></div><div class="legs"><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div></div><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail -end"></div></div></div></div></div></div></div></div>
    </div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
    	<div id="sky">
				<div id="background" class="container">
			<!-- svg file -->
			<svg id="svgout" height="100%" width="100%" viewbox="0 0 550 400">
				<defs>
					<g id="bottomShadow">
						<path fill="#000000" stroke="none" d="
		M 270.5 225.95
		L 127.35 316.65 266.8 400 409.6 309.25 270.5 225.95 Z"/>
					</g>
					<g id="Layer52_0_FILL">
						<path class="topGrass" fill="#B9D668" stroke="none" d="
	M 397.85 229.3
	L 397.85 225.6 269.85 152 135.75 228.6 135.75 233.65 262.1 306.55 397.85 229.3 Z"/>
					</g>
					<g id="Layer51_0_FILL">
						<path class="leftSideGrass" fill="#6E9E4F" stroke="none" d="
	M 135.1 229.95
	L 135.1 256.85 262.1 328.4 262.1 301.85 135.1 229.95 Z"/>
					</g>
					<g id="Layer50_0_FILL">
						<path class="rightGrassTop" fill="#8CB154" stroke="none" d="
	M 397.85 225.95
	L 395.8 225.95 261.75 301.55 261.75 328.4 397.85 251.15 397.85 225.95 Z"/>
					</g>
					<g id="Layer48_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.45 282.4
	L 135.75 298.15 262.1 372.1 261.75 355.65 135.45 282.4 Z"/>
					</g>
					<g id="Layer47_0_FILL">
						<path class="middleLeftCrust" fill="#C77E61" stroke="none" d="
	M 135.1 270.3
	L 135.1 283.05 275.9 364.35 271.85 348.9 135.1 270.3 Z"/>
					</g>
					<g id="Layer46_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.1 255.15
	L 135.1 270.3 262.1 343.55 262.1 328.05 135.1 255.15 Z"/>
					</g>
					<g id="Layer45_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 294.5
	L 397.5 277 261.75 355.3 261.75 372.75 397.5 294.5 Z"/>
					</g>
					<g id="Layer44_0_FILL">
						<path class="middleRightCrust" fill="#C89451" stroke="none" d="
	M 397.5 269.95
	L 397.15 266.6 262.1 343.2 262.1 355.95 397.5 279.7 397.5 269.95 Z"/>
					</g>
					<g id="Layer43_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 266.6
	L 397.5 250.45 261.75 328.4 261.75 343.85 397.5 266.6 Z"/>
					</g>
					<g id="Layer41_0_FILL">
						<path class="greyRoad" fill="#B2B2B1" stroke="none" d="
	M 295.05 283.05
	Q 299.05 280.35 308.45 275.3 317.85 269.95 323.6 266.9
	L 268.8 233.65 338.05 191.35 309.15 174.55 177.75 254.5
	Q 191.55 262.2 198.25 266.25 204.65 269.95 209.7 271.95
	L 241.6 250.45 295.05 283.05 Z"/>
					</g>
					<g id="Layer40_0_FILL">
						<path fill="#FFFFFF" stroke="none" d="
	M 199.95 256.85
	Q 194.55 261.2 191.9 262.2
	L 194.9 263.9 200.95 259.2 199.95 256.85
	M 225.8 243.75
	L 224.8 241.75 211.05 250.8 212.05 252.8 225.8 243.75
	M 308.15 275.65
	L 296.7 266.6 295.35 268.6 306.8 277.7 308.15 275.65
	M 275.9 253.5
	L 274.55 255.5 285.95 264.55 287.3 262.55 275.9 253.5
	M 251.7 227.3
	L 250.7 225.25 236.9 234.35 237.9 236.35 251.7 227.3
	M 257.05 240.7
	L 254.05 240.7 268.8 249.8 269.5 247.75 257.05 240.7
	M 277.2 207.8
	L 263.45 216.85 264.45 218.9 278.25 209.8 277.2 207.8
	M 305.1 192.65
	L 304.1 190.65 290.3 199.75 291.35 201.75 305.1 192.65 Z"/>
					</g>
					<g id="Layer38_0_FILL">
						<path class="frontFascia" fill="#ECB27B" stroke="none" d="
	M 359.25 187.95
	L 346.4 174.95 333.85 202.9 359.25 187.95 Z"/>
					</g>
					<g id="Layer37_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 334 201.05
	L 334.35 232 359.2 217.55 359.25 187.95 334 201.05 Z"/>
					</g>
					<g id="Layer36_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 334.35 232.3
	L 334.35 205.1 305.1 191.35 305.1 216.85 334.35 232.3 Z"/>
					</g>
					<g id="Layer35_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 329.7 167.9
	L 331.05 167.9 344.55 176.7 347.85 176.7 363 192.25 363.15 189.55 350.65 176.7 350.55 176.7 334.25 167.5 334.25 159.1 329.7 159.1 329.7 164.9 322.65 160.95 322.3 162.15 329.7 167 329.7 167.9 Z"/>
					</g>
					<g id="Layer34_0_FILL">
						<path class="leftRoof" fill="#F2563B" stroke="none" d="
	M 334.05 207.05
	L 350.65 176.7 322.1 160.45 302.1 192.05 334.05 207.05 Z"/>
					</g>
					<g id="Layer30_0_FILL">
						<path id="windowFour" class="windows" stroke="none" fill="#975A42" d="
	M 341.35 203.3
	Q 340.9 203.45 340.5 203.8 340.1 204.2 339.85 204.75 339.7 205 339.7 205.3 339.6 205.75 339.7 206.1 339.7 206.15 339.7 206.2 339.8 206.5 340 206.8 340.55 207.4 341.45 207.4 342.35 207.4 343 206.8 343.4 206.5 343.65 206.1 343.85 205.75 343.95 205.3 344.05 204.4 343.55 203.8 343.3 203.45 343 203.3 342.65 203.15 342.2 203.15 341.8 203.15 341.35 203.3
	M 355.85 198.45
	Q 355.8 198.2 355.6 198 355.1 197.4 354.2 197.4 353.35 197.4 352.6 198 351.85 198.65 351.7 199.55 351.7 199.7 351.7 199.85 351.6 200.5 352 201.05 352.55 201.65 353.45 201.65 354.3 201.65 355.05 201.05 355.45 200.7 355.7 200.25 355.8 200.05 355.9 199.85 355.95 199.7 355.95 199.55 356.05 198.95 355.85 198.45 Z"/>
						<path class="door" fill="#B65041" stroke="none" d="
	M 351.95 211.2
	L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2
	M 351.2 211.2
	L 351.35 211.2 351.35 211.1 351.2 211.2 Z"/>
					</g>
					<g>
						<path id="Layer30_0_FILL" fill="#000000" fill-opacity="1" stroke="none" d="
	M 183.7 215.3
	L 183.7 215.6
	Q 187.25 231.75 212.25 234.35
	L 183.7 215.3 Z"/>
					</g>
					<g id="Layer29_0_FILL">
						<path fill="#000000" fill-opacity="0.4" stroke="none" d="
	M 305.1 216.85
	L 305.15 217.2
	Q 309.45 233.2 334.35 232.3
	L 305.1 216.85 Z"/>
					</g>
					<g id="Layer27_0_FILL">
						<path class="vegetation" fill="#78A950" stroke="none" d="
	M 177.45 231.65
	Q 175.75 235.35 181.8 239.35 185.5 235.7 185.15 231.3 182.8 230.65 181.45 234 179.45 231.3 177.45 231.65
	M 236.9 266.6
	Q 235.2 270.3 241.25 274.3 244.95 270.6 244.65 266.25 242.3 265.6 240.95 268.95 238.9 266.25 236.9 266.6
	M 254.7 277
	Q 253.05 280.7 259.1 284.75 262.75 281.05 262.45 276.65 260.1 276 258.75 279.35 256.7 276.65 254.7 277
	M 315.5 245.75
	Q 313.5 243.05 311.5 243.4 309.8 247.1 315.85 251.15 319.55 247.45 319.2 243.05 316.85 242.4 315.5 245.75
	M 295.35 232.65
	Q 293.7 236.35 299.75 240.4 303.45 236.7 303.1 232.3 300.75 231.65 299.4 235 297.4 232.3 295.35 232.65
	M 277.2 171.85
	Q 275.55 175.55 281.6 179.55 285.3 175.85 284.95 171.5 282.6 170.85 281.25 174.2 279.25 171.5 277.2 171.85 Z"/>
					</g>
					<g id="Layer26_0_FILL">
						<path class="treeWood" fill="#AE663D" stroke="none" d="
	M 175.1 177.55
	L 172.05 177.55 172.05 191.1 159.3 172.85
	Q 154.6 171.5 172.05 195.7
	L 172.05 212.5 175.1 212.5 175.1 177.55
	M 252.7 151.35
	L 249 151.35 249 176.9 252.7 176.9 252.7 151.35 Z"/>
					</g>
					<g id="Layer25_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 192.55 179.55
	Q 200.95 173.5 200.95 165.1 200.95 156.4 192.55 150 184.15 144.3 172.05 144.3 160.3 144.3 151.9 150 143.15 156.4 143.15 165.1 143.15 173.5 151.9 179.55 160.3 185.95 172.05 185.95 184.15 185.95 192.55 179.55
	M 236.25 106.65
	Q 230.2 116.05 230.2 129.15 230.2 142.25 236.25 151.35 242.3 160.75 250.7 160.75 258.75 160.75 264.8 151.35 270.85 142.25 270.85 129.15 270.85 116.05 264.8 106.65 258.75 97.6 250.7 97.6 242.3 97.6 236.25 106.65 Z"/>
					</g>
					<g id="Layer24_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 158.3 221.9
	Q 160.65 221.9 161.95 220.2 163 219.55 163.3 218.55 164.65 218.9 166.35 218.9 170.05 218.9 172.4 216.2 175.1 213.85 175.1 210.15 175.1 206.45 172.4 203.75 170.05 201.4 166.35 201.4 162.65 201.4 159.95 203.75 157.6 206.45 157.6 210.15 157.6 210.8 157.6 211.15 155.95 211.5 154.6 212.5 152.9 214.15 152.9 216.55 152.9 218.9 154.6 220.2 156.25 221.9 158.3 221.9
	M 338.35 240.05
	Q 341.05 237.7 341.05 234 341.05 230.3 338.35 227.6 336 225.25 332.3 225.25 328.65 225.25 325.95 227.6 323.6 230.3 323.6 234 323.6 237.7 325.95 240.05 328.65 242.75 332.3 242.75 336 242.75 338.35 240.05 Z"/>
					</g>
					<g id="Layer22_0_FILL">
						<path class="rightRoof" fill="#D05041" stroke="none" d="
	M 220 173.85
	L 236.8 186.7 264.35 171.15 244.5 159.55 220 173.85 Z"/>
					</g>
					<g id="Layer21_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 212.25 191.35
	L 183.35 172.3 183.7 215.3 212.25 234.35 212.25 191.35 Z"/>
					</g>
					<g id="Layer20_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 192.1 149.85
	L 236.45 174.8 243.1 171.4
	Q 220.05 150.55 196.3 139.95
	L 192.1 149.85 Z"/>
					</g>
					<g id="Layer19_0_FILL">
						<path class="frontFascia" fill="#EBB17B" stroke="none" d="
	M 226.85 160.95
	L 212 190.6 229.75 192.6 239.75 172.85 226.85 160.95 Z"/>
					</g>
					<g id="Layer18_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 240.15 172.65
	L 211.9 191.6 212.25 233.65 264.35 201.7 264.35 170.8 240.8 184.45 240.15 172.65 Z"/>
					</g>
					<g id="Layer17_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 210.9 142.2
	L 205.9 142.2 205.9 152.65 210.9 152.65 210.9 142.2 Z"/>
					</g>
					<g>
						<path id="Layer16_0_FILL" class="leftRoof" fill="#F2563B" stroke="none" d="
	M 210.25 195.5
	L 227.4 160.95 195.45 141.35 177.65 175.85 210.25 195.5 Z"/>
					</g>
					<g>
						<path id="sun" fill="#E3BD0E" stroke="none" d="
	M 257.05 15.95
	Q 251.7 15.95 248 19.65 244.3 23.35 244.3 28.7 244.3 34.1 248 37.8 251.7 41.5 257.05 41.5 262.45 41.5 266.15 37.8 269.85 34.1 269.85 28.7 269.85 23.35 266.15 19.65 262.45 15.95 257.05 15.95 Z"/>
					</g>
					<g id="Layer8_0_FILL">
						<path fill="#975A42" stroke="none" d="
	M 238.45 189.65
	Q 238.295703125 189.362109375 238.05 189.1 237.35 188.3 236.2 188.3 235.05 188.3 234.15 189.1 233.3 189.9 233.2 191.05 233.1 192.2 233.8 193 234.55 193.8 235.7 193.8 236.85 193.8 237.7 193 238.1970703125 192.558203125 238.45 192 238.6552734375 191.56484375 238.7 191.05 238.7671875 190.276953125 238.45 189.65
	M 220.55 197.55
	Q 220 197.55 219.5 197.75 218.95 197.95 218.5 198.35 217.933203125 198.8833984375 217.7 199.55 217.5833984375 199.916796875 217.55 200.3 217.4923828125 200.96171875 217.7 201.5 217.852734375 201.9103515625 218.15 202.25 218.95 203.05 220.1 203.05 221.25 203.05 222.05 202.25 222.95 201.45 223.05 200.3 223.15 199.15 222.4 198.35 222.05 197.95 221.65 197.75 221.15 197.55 220.55 197.55 Z"/>
					</g>
					<g id="Layer7_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 233.55 206.75
	L 225.9 211.95 226.25 225.5 233.95 220.35 233.55 206.75 Z"/>
					</g>
					<g>
						<path id="windowOne" class="windows" fill="#975A42" stroke="none" d="
	M 188.65 198.4
	L 188.8 204.1 198.65 210.45 198.55 204.75 188.65 198.4
	M 208.45 216.8
	L 208.35 211.1 198.55 204.75 198.65 210.45 208.45 216.8
	M 188.8 204.1
	L 188.95 209.8 198.8 216.15 198.65 210.45 188.8 204.1
	M 208.6 222.5
	L 208.45 216.8 198.65 210.45 198.8 216.15 208.6 222.5 Z"/>
					</g>
					<g>
						<path id="windowThree" class="windows" fill="#975A42" stroke="none" d="
	M 311.7 214.1
	L 318.55 217.55 318.45 211.9 311.6 208.45 311.7 214.1
	M 325.4 221
	L 325.25 215.35 318.45 211.9 318.55 217.55 325.4 221
	M 318.4 206.2
	L 311.5 202.75 311.6 208.45 318.45 211.9 318.4 206.2
	M 325.25 215.35
	L 325.2 209.7 318.4 206.2 318.45 211.9 325.25 215.35 Z"/>
					</g>
					<g id="Layer2_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 259.7 183.25
	L 244.6 191.9 244.6 213.8 259.7 204.55 259.7 183.25 Z"/>
					</g>
					<path id="windowTwo" fill="#975A42" class="windows" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" d="
	M 223.05 200.3
	Q 222.95 201.45 222.05 202.25 221.25 203.05 220.1 203.05 218.95 203.05 218.15 202.25 217.852734375 201.9103515625 217.7 201.5 217.4923828125 200.96171875 217.55 200.3 217.5833984375 199.916796875 217.7 199.575 217.933203125 198.8833984375 218.5 198.35 218.95 197.95 219.5 197.75 220 197.55 220.55 197.55 221.15 197.55 221.65 197.75 222.05 197.95 222.4 198.35 223.15 199.15 223.05 200.3 Z
	M 238.7 191.05
	Q 238.6552734375 191.56484375 238.45 192 238.1970703125 192.558203125 237.7 193 236.85 193.8 235.7 193.8 234.55 193.8 233.8 193 233.1 192.2 233.2 191.05 233.3 189.9 234.15 189.1 235.05 188.3 236.2 188.3 237.35 188.3 238.05 189.1 238.295703125 189.362109375 238.45 189.65 238.7671875 190.276953125 238.7 191.05 Z"/>
					<path fill="#F2563B" stroke="none" d=" M 351.95 211.2 L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2 Z"/>
					<path id="Layer6_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 198.55 204.75
	L 208.35 211.1 208.45 216.8 208.6 222.5 198.8 216.15 188.95 209.8 188.8 204.1 188.65 198.4 198.55 204.75 198.65 210.45 208.45 216.8
	M 198.8 216.15
	L 198.65 210.45 188.8 204.1"/>
					<path id="Layer5_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 325.25 215.35
	L 325.4 221 318.55 217.55 311.7 214.1 311.6 208.45 311.5 202.75 318.4 206.2 325.2 209.7 325.25 215.35 318.45 211.9 318.55 217.55
	M 318.4 206.2
	L 318.45 211.9 311.6 208.45"/>
				</defs>
				<g id="shadow">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use xlink:href="#bottomShadow"/>
					</g>
				</g>
				<g transform="matrix( 1, 0, 0, 1, 0,0) ">
					<use xlink:href="#sun"/>
				</g>
				<g id="earth">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer52_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer51_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer50_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer48_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer47_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer46_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer45_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer44_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer43_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer41_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer40_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer38_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer37_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer36_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer35_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer34_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowFour"/>
						<use class="element" xlink:href="#Layer32_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer30_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer27_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer26_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer25_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer24_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer22_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer21_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer20_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer19_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer18_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer17_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer16_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer8_0_FILL"/>
						<use class="element" xlink:href="#windowTwo"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer7_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowOne"/>
						<use class="element" xlink:href="#Layer6_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowThree"/>
						<use class="element" xlink:href="#Layer5_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer2_0_FILL"/>
					</g>
				</g>
			</svg>
			<! -- End of SVG file -->
			<! -- Moon/Sun Toggle -->
			<div id="toggleButton" class="day-toggle">
				<div class="sun-icon"></div>
				<label class="switch">
            <input id="toggleCheckbox" type="checkbox">
            <div class="slider"></div>
        </label>
				<div class="cloud-icon"></div>
			</div>
			<! -- Moon/Sun Toggle -->
			<! -- End of Container -->
		</div>
			</div>
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">èˆåŠ¨ä¹¾å¤</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">æ˜Ÿå…‰ä¸é—®èµ¶è·¯äºº å²æœˆä¸è´Ÿæœ‰å¿ƒäºº</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="æœç´¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/09/Node-jsçš„æ–‡ä»¶è·¯å¾„çš„ä¸€äº›å‘/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/09/Node-jsçš„æ–‡ä»¶è·¯å¾„çš„ä¸€äº›å‘/" itemprop="url">Node.jsçš„æ–‡ä»¶è·¯å¾„çš„ä¸€äº›å‘</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-07-09T18:16:04+08:00">
                2017-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘åœ¨å†™ä¸€ç¯‡weexçš„webpacké…ç½®ï¼Œåˆšåˆšè¸©å‘äº†ï¼Œweekpackä¸­ä¼šç”¨åˆ°pathæ¨¡å—ï¼Œè€Œå¯¹äºè¿™ä¸ªæ¨¡å—ï¼Œæˆ‘æƒ³æŠ½ç¦»å‡ºæ¥çœ‹ä¸€ä¸‹ï¼Œå› ä¸ºè¿™ä¸ªç”¨åˆ°çš„è¿˜æ˜¯æ¯”è¾ƒå¤šçš„,å–œæ¬¢çš„æœ‹å‹å¯ä»¥ç‚¹ä¸ªå–œæ¬¢ï¼Œæˆ–è€…å»æˆ‘çš„<a href="https://link.zhihu.com/?target=https%3A//link.juejin.im/%3Ftarget%3Dhttps%253A%252F%252Fgithub.com%252Flaihuamin%252FJS-total" target="_blank" rel="noopener">github</a>ç‚¹ä¸ªstarä¹Ÿè¡Œï¼Œè°¢è°¢æ”¯æŒï¼Œä¸¾èµ·å°æ‰‹æŒ‡ç‚¹ä¸€ç‚¹å“¦ğŸ˜¯ï¼Œå†™çš„ä¸å¯¹çš„åœ°æ–¹ï¼Œè¯„è®ºæ‹ç –ï¼Œè°¢è°¢ã€‚</p>
<h2 id="nodeä¸­çš„è·¯å¾„åˆ†ç±»"><a href="#nodeä¸­çš„è·¯å¾„åˆ†ç±»" class="headerlink" title="nodeä¸­çš„è·¯å¾„åˆ†ç±»"></a>nodeä¸­çš„è·¯å¾„åˆ†ç±»</h2><p>nodeä¸­çš„è·¯å¾„å¤§è‡´åˆ†5ç±»ï¼Œdirname,filename,process.cwd(),./,../,å…¶ä¸­å‰ä¸‰ä¸ªéƒ½æ˜¯ç»å¯¹è·¯å¾„</p>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•ç‚¹çš„ä¾‹å­</p>
<p>å‡å¦‚ï¼Œæˆ‘æœ‰ä¸€ä¸ªæ–‡ä»¶çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code>editor/
  - dist/
  - src/
      - task.js
</code></pre><p>ç„¶åæˆ‘ä»¬åœ¨task.jsæ–‡ä»¶ä¸­å†™å…¥ä¸€ä¸‹ä»£ç </p>
<pre><code>const path = require(&apos;path&apos;);
console.log(__dirname);
console.log(__filename);
console.log(process.cwd());
console.log(path.resolve(&apos;./&apos;));
</code></pre><p>åœ¨editorç›®å½•ä¸‹è¿è¡Œnode src/task.jsï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>/Users/laihuamin/Documents/richEditor/editor/src
/Users/laihuamin/Documents/richEditor/editor/src/task.js
/Users/laihuamin/Documents/richEditor/editor
/Users/laihuamin/Documents/richEditor/editor
</code></pre><p>ç„¶åæˆ‘ä»¬æœ‰å¯ä»¥åœ¨srcç›®å½•ä¸‹è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œnode task.js,è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>/Users/laihuamin/Documents/richEditor/editor/src
/Users/laihuamin/Documents/richEditor/editor/src/task.js
/Users/laihuamin/Documents/richEditor/editor/src
/Users/laihuamin/Documents/richEditor/editor/src
</code></pre><p>å¯¹æ¯”ä¸¤ä¸ªè¾“å‡ºç»“æœï¼Œæˆ‘ä»¬å¯ä»¥å½’çº³ä¸€ä¸‹å‡ ç‚¹ï¼š</p>
<p>1.<strong>dirname:è¿”å›çš„æ˜¯è¿™ä¸ªæ–‡ä»¶æ‰€åœ¨æ–‡ä»¶å¤¹çš„ä½ç½®<br>2.</strong>filename:ä½ è¿è¡Œå‘½ä»¤ä»£è¡¨çš„æ˜¯æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ï¼Œä¸ç®¡ä½ è¿è¡Œä»€ä¹ˆå‘½ä»¤ï¼Œéƒ½æ˜¯æŒ‡å‘æ–‡ä»¶<br>3.process.cwd():ä½ è¿è¡Œnodeå‘½ä»¤æ‰€åœ¨æ–‡ä»¶å¤¹çš„ä½ç½®ï¼Œæ¯”å¦‚ä½ åœ¨srcç›®å½•ä¸‹è¿è¡Œï¼Œé‚£ä¹ˆå°±æ˜¯è¾“å‡ºåˆ°srcä¸ºæ­¢ï¼Œä¸‹é¢çš„åŒç†ã€‚</p>
<hr>
<p>Node.jsä¸­çš„æ–‡ä»¶è·¯å¾„å¤§æ¦‚æœ‰ <strong>dirname, </strong>filename, process.cwd(), ./ æˆ–è€… ../ï¼Œå‰ä¸‰ä¸ªéƒ½æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¸ºäº†ä¾¿äºæ¯”è¾ƒï¼Œ./ å’Œ ../ æˆ‘ä»¬é€šè¿‡ path.resolve(â€˜./â€˜)æ¥è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ã€‚<br>ç®€å•è¯´ä¸€ä¸‹è¿™å‡ ä¸ªè·¯å¾„çš„æ„æ€ï¼Œï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__dirnameï¼š    è·å¾—å½“å‰æ‰§è¡Œæ–‡ä»¶æ‰€åœ¨ç›®å½•çš„å®Œæ•´ç›®å½•å</span><br><span class="line">__filenameï¼š   è·å¾—å½“å‰æ‰§è¡Œæ–‡ä»¶çš„å¸¦æœ‰å®Œæ•´ç»å¯¹è·¯å¾„çš„æ–‡ä»¶å</span><br><span class="line">process.cwd()ï¼šè·å¾—å½“å‰æ‰§è¡Œnodeå‘½ä»¤æ—¶å€™çš„æ–‡ä»¶å¤¹ç›®å½•å </span><br><span class="line">./ï¼š           æ–‡ä»¶æ‰€åœ¨ç›®å½•</span><br></pre></td></tr></table></figure></p>
<p>å…ˆçœ‹ä¸€çœ‹æˆ‘ç”µè„‘å½“å‰çš„ç›®å½•ç»“æ„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">syntax/</span><br><span class="line">    -nodejs/</span><br><span class="line">        -1.findLargest.js</span><br><span class="line">        -2.path.js</span><br><span class="line">        -3.fs.js</span><br><span class="line">    -regs</span><br><span class="line">        -regx.js</span><br><span class="line">        -test.txt</span><br></pre></td></tr></table></figure></p>
<p>åœ¨ path.js é‡Œé¢æˆ‘ä»¬å†™è¿™äº›ä»£ç ï¼Œçœ‹çœ‹è¾“å‡ºæ˜¯ä»€ä¹ˆï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">console.log(&apos;__dirnameï¼š&apos;, __dirname)</span><br><span class="line">console.log(&apos;__filenameï¼š&apos;, __filename)</span><br><span class="line">console.log(&apos;process.cwd()ï¼š&apos;, process.cwd())</span><br><span class="line">console.log(&apos;./ï¼š&apos;, path.resolve(&apos;./&apos;))</span><br></pre></td></tr></table></figure></p>
<p>åœ¨å½“å‰ç›®å½•ä¸‹ä¹Ÿå°±æ˜¯nodejsç›®å½•è¿è¡Œ<code>node path.js</code>ï¼Œæˆ‘ä»¬çœ‹çœ‹è¾“å‡ºç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__dirnameï¼š     /Users/jawil/Desktop/nodejs/demo/ES6-lottery/syntax/nodejs</span><br><span class="line">__filenameï¼š    /Users/jawil/Desktop/nodejs/demo/ES6-lottery/syntax/nodejs/2.path.js</span><br><span class="line">process.cwd()ï¼š /Users/jawil/Desktop/nodejs/demo/ES6-lottery/syntax/nodejs</span><br><span class="line">./ï¼š            /Users/jawil/Desktop/nodejs/demo/ES6-lottery/syntax/nodejs</span><br></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨ é¡¹ç›®æ ¹ç›®å½•ES6-lottery ç›®å½•ä¸‹è¿è¡Œ <code>node syntax/nodejs/2.path.js</code>ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹è¾“å‡ºç»“æœï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__dirnameï¼š     /Users/jawil/Desktop/nodejs/demo/ES6-lottery/syntax/nodejs</span><br><span class="line">__filenameï¼š    /Users/jawil/Desktop/nodejs/demo/ES6-lottery/syntax/nodejs/2.path.js</span><br><span class="line">process.cwd()ï¼š /Users/jawil/Desktop/nodejs/demo/ES6-lottery</span><br><span class="line">./ï¼š            /Users/jawil/Desktop/nodejs/demo/ES6-lottery</span><br></pre></td></tr></table></figure></p>
<p>ç­”æ¡ˆæ˜¾è€Œæ˜“è§ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šé¢çš„ä¾‹å­å¯¹æ¯”ï¼Œæš‚æ—¶å¾—å‡ºè¡¨é¢çš„ç»“è®ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__dirname: æ€»æ˜¯è¿”å›è¢«æ‰§è¡Œçš„ js æ‰€åœ¨æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„</span><br><span class="line">__filename: æ€»æ˜¯è¿”å›è¢«æ‰§è¡Œçš„ js çš„ç»å¯¹è·¯å¾„</span><br><span class="line">process.cwd(): æ€»æ˜¯è¿”å›è¿è¡Œ node å‘½ä»¤æ—¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„</span><br><span class="line">./: è·Ÿ process.cwd() ä¸€æ ·ï¼Œè¿”å› node å‘½ä»¤æ—¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure></p>
<h2 id="require-æºç è§£è¯»"><a href="#require-æºç è§£è¯»" class="headerlink" title="require() æºç è§£è¯»"></a><a href="http://www.ruanyifeng.com/blog/2015/05/require.html" target="_blank" rel="noopener">require() æºç è§£è¯»</a></h2><p><img src="/2017/07/09/Node-jsçš„æ–‡ä»¶è·¯å¾„çš„ä¸€äº›å‘/1.webp" alt=""></p>
<p>é‚£ä¹ˆå…³äº ./ æ­£ç¡®çš„ç»“è®ºæ˜¯ï¼š</p>
<blockquote>
<p>åœ¨ require() ä¸­ä½¿ç”¨æ˜¯è·Ÿ __dirname çš„æ•ˆæœç›¸åŒï¼Œä¸ä¼šå› ä¸ºå¯åŠ¨è„šæœ¬çš„ç›®å½•ä¸ä¸€æ ·è€Œæ”¹å˜ï¼Œåœ¨å…¶ä»–æƒ…å†µä¸‹è·Ÿ process.cwd() æ•ˆæœç›¸åŒï¼Œæ˜¯ç›¸å¯¹äºå¯åŠ¨è„šæœ¬æ‰€åœ¨ç›®å½•çš„è·¯å¾„ã€‚<br>åªæœ‰åœ¨ require() æ—¶æ‰ä½¿ç”¨ç›¸å¯¹è·¯å¾„(./, ../)çš„å†™æ³•ï¼Œå…¶ä»–åœ°æ–¹ä¸€å¾‹ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œå¦‚ä¸‹ï¼š</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// å½“å‰ç›®å½•ä¸‹</span><br><span class="line"> path.dirname(__filename) + &apos;/path.js&apos;; </span><br><span class="line">// ç›¸é‚»ç›®å½•ä¸‹</span><br><span class="line"> path.resolve(__dirname, &apos;../regx/regx.js&apos;);</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="path"><a href="#path" class="headerlink" title="path"></a>path</h2><p>è®²å®Œå‰é¢ä¸‰ä¸ªç»å¯¹è·¯å¾„ï¼Œæˆ‘å€’æ˜¯æŒºæƒ³æ¥èŠèŠpathè¿™ä¸ªæ¨¡å—çš„ï¼Œè¿™ä¸ªnodeæ¨¡å—åœ¨å¾ˆå¤šåœ°æ–¹éƒ½æœ‰åº”ç”¨ï¼Œæ‰€ä»¥ï¼Œå¯¹äºæˆ‘ä»¬æ¥è¯´ï¼ŒæŒæ¡ä»–ï¼Œå¯¹æˆ‘ä»¬ä»¥åçš„å‘å±•æ›´æœ‰åˆ©ï¼Œä¸ç”¨æ¯æ¬¡çœ‹webpackçš„é…ç½®æ–‡ä»¶è¿˜è¦å»æŸ¥è¯¢ä¸€ä¸‹è¿™ä¸ªapiæ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Œå¾ˆå½±å“æˆ‘ä»¬çš„æ•ˆç‡</p>
<p><a href="https://link.zhihu.com/?target=https%3A//link.juejin.im/%3Ftarget%3Dhttps%253A%252F%252Fnodejs.org%252Fapi%252Fpath.html" target="_blank" rel="noopener">nodeJS/path</a></p>
<p>ä¸Šé¢é‚£ä¸ªç½‘ç«™æœ‰è¯¦ç»†çš„apiï¼Œä½†æ˜¯æˆ‘ä»¬è¿™é‡Œä¸ç”¨éƒ½æŒæ¡å§ï¼Œæˆ‘å°±è®²å‡ ä¸ªæˆ‘é‡åˆ°è¿‡çš„ï¼Œæˆ‘è§‰å¾—webpackç­‰å·¥ç¨‹é…ç½®ä¸­ä¼šç”¨åˆ°çš„</p>
<h2 id="path-normalize"><a href="#path-normalize" class="headerlink" title="path.normalize"></a>path.normalize</h2><p>è¿™ä¸ªæ–¹æ³•å°±æ˜¯æŠŠä¸è§„èŒƒçš„è·¯å¾„è§„èŒƒåŒ–ï¼Œæ¯”å¦‚çœ‹ä¸‹é¢çš„ä¾‹å­</p>
<pre><code>const path = require(&apos;path&apos;);
console.log(path.normalize(&apos;/foo/bar//baz/asdf/quux/..&apos;));
</code></pre><p>è¾“å‡ºç»“æœï¼š</p>
<pre><code>/foo/bar/baz/asdf
</code></pre><h2 id="path-join"><a href="#path-join" class="headerlink" title="path.join"></a>path.join</h2><pre><code>const path = require(&apos;path&apos;);
console.log(path.join(&apos;src&apos;, &apos;task.js&apos;));

const path = require(&apos;path&apos;);
console.log(path.join(&apos;dist&apos;, &apos;task.js&apos;));

const path = require(&apos;path&apos;);
console.log(path.join(&apos;&apos;));
</code></pre><p>è¿™ä¹ˆä¸¤ä¸ªçš„è¾“å‡ºç»“æœæ˜¯ï¼š</p>
<pre><code>src/task.js
dist/task.js
.
</code></pre><p>ä»–çš„ä½œç”¨ä¹Ÿå°±æ˜¾è€Œæ˜“è§ï¼Œä»–æœ‰ä¸€ä¸‹å‡ æ¡è§„åˆ™ï¼š<br>1.ä¼ å…¥çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²çš„è·¯å¾„ç‰‡æ®µï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª</p>
<p>2.è¿”å›çš„æ˜¯ä¸€ä¸ªæ‹¼æ¥å¥½çš„è·¯å¾„ï¼Œä½†æ˜¯æ ¹æ®å¹³å°çš„ä¸åŒï¼Œä»–ä¼šå¯¹è·¯å¾„è¿›è¡Œä¸åŒçš„è§„èŒƒåŒ–ï¼Œä¸¾ä¸ªä¾‹å­ï¼ŒUnixç³»ç»Ÿæ˜¯â€/â€œï¼ŒWindowsç³»ç»Ÿæ˜¯â€\â€œï¼Œé‚£ä¹ˆä½ åœ¨ä¸¤ä¸ªç³»ç»Ÿä¸‹çœ‹åˆ°çš„è¿”å›ç»“æœå°±ä¸ä¸€æ ·ã€‚</p>
<p>3.å¦‚æœè¿”å›çš„è·¯å¾„å­—ç¬¦ä¸²é•¿åº¦ä¸ºé›¶ï¼Œé‚£ä¹ˆä»–ä¼šè¿”å›ä¸€ä¸ªâ€™.â€™ï¼Œä»£è¡¨å½“å‰çš„æ–‡ä»¶å¤¹ã€‚</p>
<p>4.å¦‚æœä¼ å…¥çš„å‚æ•°ä¸­æœ‰ä¸æ˜¯å­—ç¬¦ä¸²çš„ï¼Œé‚£å°±ç›´æ¥ä¼šæŠ¥é”™</p>
<h2 id="path-parse"><a href="#path-parse" class="headerlink" title="path.parse"></a>path.parse</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸ªä¾‹å­ï¼Œåœ¨srcç›®å½•ä¸‹çš„task.jså†™å…¥</p>
<pre><code>const path = require(&apos;path&apos;);
console.log(path.parse(&apos;/Users/laihuamin/Documents/richEditor/editor&apos;));
</code></pre><p>ç„¶åè¿è¡Œnode src/task.jsä¹‹å,è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<pre><code>{ 
  root: &apos;/&apos;,
  dir: &apos;/Users/laihuamin/Documents/richEditor&apos;,
  base: &apos;editor&apos;,
  ext: &apos;&apos;,
  name: &apos;editor&apos; 
}
</code></pre><p>ä»–è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥æŠŠè¿™ä¹ˆå‡ ä¸ªåè¯ç†Ÿæ‚‰ä¸€ä¸‹ï¼š</p>
<p><img src="https://pic3.zhimg.com/v2-b7c5d496b89fde98f097a4a6e2ba7d03_b.jpg" alt=""><img src="https://pic3.zhimg.com/80/v2-b7c5d496b89fde98f097a4a6e2ba7d03_hd.jpg" alt=""></p>
<p>è¿™ä¸ªè¡¨æ ¼åº”è¯¥å±•ç¤ºçš„å¾ˆå½¢è±¡ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯æ¥è§£é‡Šä¸€ä¸‹è¿™äº›åè¯ï¼š<br>1.rootï¼šä»£è¡¨æ ¹ç›®å½•<br>2.dirï¼šä»£è¡¨æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹<br>3.baseï¼šä»£è¡¨æ•´ä¸€ä¸ªæ–‡ä»¶<br>4.nameï¼šä»£è¡¨æ–‡ä»¶å<br>5.ext: ä»£è¡¨æ–‡ä»¶çš„åç¼€å</p>
<p>é‚£æˆ‘ä»¬æ ¹æ®ä¸‹é¢çš„è§„åˆ™ï¼Œæ¥çœ‹ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œæœ€å¥½è‡ªå·±è„‘å­åšä¸€é</p>
<pre><code>const path = require(&apos;path&apos;);
console.log(path.parse(&apos;/Users/laihuamin/Documents/richEditor/editor/src/task.js&apos;));
</code></pre><p>è¾“å‡ºçš„ç»“æœï¼š</p>
<pre><code>{ 
  root: &apos;/&apos;,
  dir: &apos;/Users/laihuamin/Documents/richEditor/editor/src&apos;,
  base: &apos;task.js&apos;,
  ext: &apos;.js&apos;,
  name: &apos;task&apos; 
}
</code></pre><p>ä½ åšå¯¹äº†ä¹ˆï¼Ÿ0.0</p>
<h2 id="path-basename"><a href="#path-basename" class="headerlink" title="path.basename"></a>path.basename</h2><p>é‚£æœ‰äº†å‰é¢è¿™ä¸ªé“ºå«ï¼Œæƒ³å¿…è¿™ä¸ªæ¥å£çŒœä¹Ÿèƒ½çŒœçš„åˆ°äº†ã€‚ã€‚ã€‚ã€‚æˆ‘ä»¬çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­</p>
<pre><code>const path = require(&apos;path&apos;);
console.log(path.basename(&apos;/Users/laihuamin/Documents/richEditor/editor/src/task.js&apos;));
</code></pre><p>è¾“å‡ºçš„ç»“æœæ˜¯ï¼š</p>
<pre><code>task.js
</code></pre><p>æˆ‘ä»¬è¿˜æ˜¯ç®€å•ä»‹ç»ä¸€ä¸‹ï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯path,è¿˜æœ‰ä¸€ä¸ªæ˜¯extï¼ˆå¯é€‰å‚æ•°ï¼‰.</p>
<pre><code>const path = require(&apos;path&apos;)
console.log(path.basename(&apos;/Users/laihuamin/Documents/richEditor/editor/src/task.js&apos;, &apos;.js&apos;));
</code></pre><p>è¾“å‡ºç»“æœ:</p>
<pre><code>task
</code></pre><h2 id="path-dirname"><a href="#path-dirname" class="headerlink" title="path.dirname"></a>path.dirname</h2><p>è¿™ä¸ªæ¥å£æ¯”basenameè¿˜è¦ç®€å•ï¼Œæˆ‘å°±ä¸å¤šè¯´äº†ï¼Œçœ‹ä¾‹å­ï¼Œçœ‹ç»“æœ</p>
<pre><code>const path = require(&apos;path&apos;);
console.log(path.basename(&apos;/Users/laihuamin/Documents/richEditor/editor/src/task.js&apos;));
</code></pre><p>è¾“å‡ºçš„ç»“æœ:</p>
<pre><code>/Users/laihuamin/Documents/richEditor/editor/src
</code></pre><p>æ³¨æ„ä¸€ä¸‹ï¼Œæ¥æ”¶çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ç±»å‹</p>
<h2 id="path-extname"><a href="#path-extname" class="headerlink" title="path.extname"></a>path.extname</h2><p>è¿™ä¸ªå°±æ˜¯å±•ç¤ºæ–‡ä»¶çš„æ‰©å±•åï¼Œæˆ‘ä»¬å¾—æ³¨æ„å‡ ç§æƒ…å†µ</p>
<pre><code>const path = require(&apos;path&apos;);
path.extname(&apos;index.html&apos;);
path.extname(&apos;index.coffee.md&apos;);
path.extname(&apos;index.&apos;);
path.extname(&apos;index&apos;);
path.extname(&apos;.index&apos;);
</code></pre><p>è¾“å‡ºçš„ç»“æœæ˜¯ï¼š</p>
<pre><code>.html
.md
.
&apos;&apos;
&apos;&apos;
</code></pre><p>è‡ªå·±æ³¨æ„ä¸€ä¸‹è¿™å‡ ä¸ªæƒ…å†µ</p>
<h2 id="path-resolve"><a href="#path-resolve" class="headerlink" title="path.resolve"></a>path.resolve</h2><p>æˆ‘ä»¬é€šè¿‡ä¸‹é¢è¿™å‡ ä¸ªä¾‹å­å…ˆæ¥ç†Ÿæ‚‰ä¸€ä¸‹ï¼š</p>
<pre><code>const path = require(&apos;path&apos;);
console.log(path.resolve(&apos;/foo/bar&apos;, &apos;/bar/faa&apos;, &apos;..&apos;, &apos;a/../c&apos;));
</code></pre><p>è¾“å‡ºçš„ç»“æœæ˜¯</p>
<pre><code>/bar/c
</code></pre><p>ä»–å°±ç›¸å½“äºä¸€å †cdæ“ä½œï¼Œæˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥çœ‹</p>
<pre><code>cd /foo/bar/    //è¿™æ˜¯ç¬¬ä¸€æ­¥, ç°åœ¨çš„ä½ç½®æ˜¯/foo/bar/
cd /bar/faa     //è¿™æ˜¯ç¬¬äºŒæ­¥ï¼Œè¿™é‡Œå’Œç¬¬ä¸€æ­¥æœ‰åŒºåˆ«ï¼Œä»–æ˜¯ä»/è¿›å…¥çš„ï¼Œä¹Ÿå°±æ—¶å€™æ ¹ç›®å½•ï¼Œç°åœ¨çš„ä½ç½®æ˜¯/bar/faa
cd ..       //ç¬¬ä¸‰æ­¥ï¼Œä»faaé€€å‡ºæ¥ï¼Œç°åœ¨çš„ä½ç½®æ˜¯ /bar
cd a/../c   //ç¬¬å››æ­¥ï¼Œè¿›å…¥aï¼Œç„¶ååœ¨æ¨å‡ºï¼Œåœ¨è¿›å…¥cï¼Œæœ€åä½ç½®æ˜¯/bar/c
</code></pre><p>ä½†æ˜¯è¿™ä¸ªæ“ä½œå’Œcdè¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œè¿™ä¸ªè·¯å¾„ä¸ä¸€å®šè¦å­˜åœ¨ï¼Œè€Œä¸”æœ€åçš„å¯ä»¥æ˜¯æ–‡ä»¶</p>
<h2 id="path-relative"><a href="#path-relative" class="headerlink" title="path.relative"></a>path.relative</h2><p>è¿™ä¸ªè¿”å›çš„æ˜¯fromåˆ°toçš„ç›¸å¯¹è·¯å¾„ï¼Œä»€ä¹ˆæ„æ€å‘¢ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢çš„ä¾‹å­å°±çŸ¥é“äº†.</p>
<pre><code>const path = require(&apos;path&apos;);
console.log(path.relative(&apos;src/bar/baz&apos;, &apos;src/aaa/bbb&apos;));
</code></pre><p>è¾“å‡ºçš„ç»“æœæ˜¯ï¼š</p>
<pre><code>../../aaa/bbb
</code></pre><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™äº›æ¯”è¾ƒå®ç”¨çš„æ–¹æ³•ï¼Œåˆ†äº«ç»™å¤§å®¶ï¼Œè‡ªå·±è¿˜æ˜¯è€è€å®å®å»çœ‹weektoolçš„webpackçš„é…ç½®æ–‡ä»¶äº†ï¼Œå–œæ¬¢çš„æœ‹å‹å¯ä»¥ç‚¹ä¸ªå–œæ¬¢ï¼Œæˆ–è€…å»æˆ‘çš„<a href="https://link.zhihu.com/?target=https%3A//link.juejin.im/%3Ftarget%3Dhttps%253A%252F%252Fgithub.com%252Flaihuamin%252FJS-total" target="_blank" rel="noopener">github</a>ç‚¹ä¸ªstarä¹Ÿè¡Œï¼Œè°¢è°¢æ”¯æŒï¼Œä¸¾èµ·å°æ‰‹æŒ‡ç‚¹ä¸€ç‚¹å“¦ğŸ˜¯ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/04/100-100çš„-canvas-å å¤šå°‘å†…å­˜/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/04/100-100çš„-canvas-å å¤šå°‘å†…å­˜/" itemprop="url">100*100çš„ canvas å å¤šå°‘å†…å­˜</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-06-04T18:55:12+08:00">
                2017-06-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="é¢˜ç›®"><a href="#é¢˜ç›®" class="headerlink" title="é¢˜ç›®"></a>é¢˜ç›®</h2><p>100*100çš„ canvas å å¤šå°‘å†…å­˜ï¼Ÿ</p>
<h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>å…¶å®çœŸæ­£çš„ç­”æ¡ˆæ˜¯å¤šå°‘æˆ‘å¹¶ä¸æ¸…æ¥šï¼Œé¢è¯•è¿‡ç¨‹ä¸­é¢è¯•å®˜ä¹Ÿä¸æœŸå¾…ä¸€ä¸ªå‡†ç¡®çš„ç­”æ¡ˆï¼Œè€Œæ˜¯çœ‹ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚</p>
<p>å¦‚æœäº†è§£è¿‡ Canvas ä¸”åšè¿‡æ»¤é•œç›¸å…³çš„å·¥ä½œï¼Œå¯èƒ½è°ƒç”¨è¿‡ <code>imageData = ctx.getImageData(sx, sy, sw, sh);</code> è¿™ä¸ª APIã€‚æˆ‘è®°å¾—è¿™ä¸ª API è¿”å›çš„æ˜¯ä¸€ä¸ª ImageData æ•°ç»„ï¼ŒåŒ…å«äº† sx, sy, sw, sh è¡¨ç¤ºçš„çŸ©å½¢çš„åƒç´ æ•°æ®ã€‚</p>
<p>è€Œä¸”è¿™ä¸ªæ•°ç»„æ˜¯ Uint8 ç±»å‹çš„ï¼Œä¸”å››ä½è¡¨ç¤ºä¸€ä¸ªåƒç´ ã€‚</p>
<p>æˆ‘åœ¨é¢è¯•çš„æ—¶å€™åªèƒ½æƒ³èµ·æ¥è¿™äº›ä¿¡æ¯ã€‚çŒœæƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨å®šä¹‰é¢œè‰²çš„æ—¶å€™å°±æ˜¯ä½¿ç”¨ rgba(r,g,b,a) å››ä¸ªç»´åº¦æ¥è¡¨ç¤ºï¼Œè€Œä¸”æ¯ä¸ªåƒç´ å€¼å°±æ˜¯ç”¨åå…­ä½ 00-ff è¡¨ç¤ºï¼Œå³æ¯ä¸ªç»´åº¦çš„èŒƒå›´æ˜¯ 0~255ï¼Œå³ 2^8 ä½ï¼Œå³ 1 byte, ä¹Ÿå°±æ˜¯ Uint8 èƒ½è¡¨ç¤ºçš„èŒƒå›´ã€‚</p>
<font color="#ff0000"><strong> æ‰€ä»¥ 100 <em> 100 canvas å çš„å†…å­˜æ˜¯ 100 </em> 100 * 4 bytes = 40,000 bytesã€‚</strong></font>

<h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>è¿™é‡Œçš„ç­”æ¡ˆå¹¶ä¸ä¸€å®šå‡†ç¡®ã€‚</p>
<h2 id="å…³äº-alpha-çš„äº‰è®º"><a href="#å…³äº-alpha-çš„äº‰è®º" class="headerlink" title="å…³äº alpha çš„äº‰è®º"></a>å…³äº alpha çš„äº‰è®º</h2><p>æœ‰åŒå­¦æŒ‡å‡ºï¼Œalpha ä¸æ˜¯ 0-100 ä¹ˆï¼Ÿæˆ‘èµ·åˆä¹Ÿæœ‰è¿™æ ·çš„ç–‘é—®ï¼Œä¸è¿‡è¿™ç¯‡æ–‡ç« ä¸­ <a href="https://link.juejin.im?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FAPI%2FCanvas_API%2FTutorial%2FPixel_manipulation_with_canvas" target="_blank" rel="noopener">developer.mozilla.org/en-US/docs/â€¦</a> è¯´</p>
<blockquote>
<p>The data property returns a Uint8ClampedArray which can be accessed to look at the raw pixel data; each pixel is represented by four one-byte values (red, green, blue, and alpha, in that order; that is, â€œRGBAâ€ format). Each color component is represented by an integer between 0 and 255.</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´å³ä¾¿æ˜¯ alpha ä¹Ÿæ˜¯ 0-255</p>
<p>é‚£ä¹ˆå¦‚ä½•è¡¨ç¤º alpha å‘¢ï¼Ÿ</p>
<p>æ¥ä¸‹æ¥è¿™æ®µä»£ç ä¸­<br><img src="/2017/06/04/100-100çš„-canvas-å å¤šå°‘å†…å­˜/166de139a0bb874e.webp" alt=""><br>å¯ä»¥çœ‹å‡ºï¼Œåªéœ€è¦ç”¨ 0-255 è¡¨ç¤º 0-100 å°±å¯ä»¥å•¦~</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/19/for-in-ã€Object-keys-å’ŒObject-getOwnPropertyNames-for-of/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/19/for-in-ã€Object-keys-å’ŒObject-getOwnPropertyNames-for-of/" itemprop="url">(for..in)ã€Object.keys()å’ŒObject.getOwnPropertyNames(),for...of</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-05-19T23:15:50+08:00">
                2017-05-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://pic2.zhimg.com/v2-8b77517cd30c95a804e67ebf584d888a_b.jpg" alt=""><img src="https://pic2.zhimg.com/80/v2-8b77517cd30c95a804e67ebf584d888a_hd.jpg" alt=""></p>
<p><img src="https://pic3.zhimg.com/v2-474fc5622ed4a673ef33d34a682250bc_b.jpg" alt=""><img src="https://pic3.zhimg.com/80/v2-474fc5622ed4a673ef33d34a682250bc_hd.jpg" alt=""></p>
<p>Object.keysï¼ˆobjï¼‰ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„é‡Œæ˜¯è¯¥objå¯è¢«æšä¸¾çš„æ‰€æœ‰å±æ€§ã€‚è¯·çœ‹ç¤ºä¾‹ï¼š</p>
<p>ç¤ºä¾‹ä¸€ï¼š</p>
<pre><code>function Pasta(grain, width, shape) {
          this.grain = grain;
          this.width = width;
          this.shape = shape;
          this.toString = function () {
                  return (this.grain + &quot;, &quot; + this.width + &quot;, &quot; + this.shape);
          }
  }
  console.log(Object.keys(Pasta)); //console: []
  var spaghetti = new Pasta(&quot;wheat&quot;, 0.2, &quot;circle&quot;);
  console.log(Object.keys(spaghetti)); //console: [&quot;grain&quot;, &quot;width&quot;, &quot;shape&quot;, &quot;toString&quot;]
</code></pre><p>ç¤ºä¾‹äºŒï¼š</p>
<pre><code>var arr = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;];
   console.log(Object.keys(arr)); // console: [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;]
   var obj = { 0 : &quot;a&quot;, 1 : &quot;b&quot;, 2 : &quot;c&quot;};
   console.log(Object.keys(obj)); // console: [&quot;0&quot;, &quot;1&quot;, &quot;2&quot;]
   var an_obj = { 100: &quot;a&quot;, 2: &quot;b&quot;, 7: &quot;c&quot;};
   console.log(Object.keys(an_obj)); // console: [&quot;2&quot;, &quot;7&quot;, &quot;100&quot;]
   var my_obj = Object.create({}, { getFoo : { value : function () { return this.foo } } });
   my_obj.foo = 1;
   console.log(Object.keys(my_obj)); // console: [&quot;foo&quot;]
</code></pre><p>jsä¸­å‡ ç§éå†å¯¹è±¡çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬for inã€Object.keysã€Object.getOwnProperty,å®ƒä»¬åœ¨ä½¿ç”¨åœºæ™¯æ–¹é¢å„æœ‰ä¸åŒã€‚</p>
<p>for in</p>
<p>ä¸»è¦ç”¨äºéå†å¯¹è±¡çš„å¯æšä¸¾å±æ€§ï¼ŒåŒ…æ‹¬è‡ªæœ‰å±æ€§ã€ç»§æ‰¿è‡ªåŸå‹çš„å±æ€§</p>
<pre><code>var obj = {&quot;name&quot;:&quot;Poly&quot;, &quot;career&quot;:&quot;it&quot;}
Object.defineProperty(obj, &quot;age&quot;, {value:&quot;forever 18&quot;, enumerable:false});
Object.prototype.protoPer1 = function(){console.log(&quot;proto&quot;);};
Object.prototype.protoPer2 = 2;
console.log(&quot;For In : &quot;);
for(var a in obj) console.log(a);
</code></pre><p><img src="https://pic4.zhimg.com/v2-07286d25bcdcd379c3da29cf98076e14_b.jpg" alt=""><img src="https://pic4.zhimg.com/80/v2-07286d25bcdcd379c3da29cf98076e14_hd.jpg" alt=""></p>
<p><img src="https://pic4.zhimg.com/v2-ae93be2db86b326d8c5081a88bcf7636_b.jpg" alt=""><img src="https://pic4.zhimg.com/80/v2-ae93be2db86b326d8c5081a88bcf7636_hd.jpg" alt=""></p>
<p>Object.keys</p>
<p>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ å‡ä¸ºå¯¹è±¡è‡ªæœ‰çš„å¯æšä¸¾å±æ€§</p>
<pre><code>var obj = {&quot;name&quot;:&quot;Poly&quot;, &quot;career&quot;:&quot;it&quot;}
Object.defineProperty(obj, &quot;age&quot;, {value:&quot;forever 18&quot;, enumerable:false});
Object.prototype.protoPer1 = function(){console.log(&quot;proto&quot;);};
Object.prototype.protoPer2 = 2;
console.log(&quot;Object.keys:&quot;)
console.log(Object.keys(obj));
</code></pre><p><img src="https://pic1.zhimg.com/v2-a1f7c5f0d6d306c25660d0087ccd477e_b.jpg" alt=""><img src="https://pic1.zhimg.com/80/v2-a1f7c5f0d6d306c25660d0087ccd477e_hd.jpg" alt=""></p>
<p><img src="https://pic4.zhimg.com/v2-fd283ee34f31f9aa9133cd96c0ac3fdd_b.jpg" alt=""><img src="https://pic4.zhimg.com/80/v2-fd283ee34f31f9aa9133cd96c0ac3fdd_hd.jpg" alt=""></p>
<p><img src="https://pic3.zhimg.com/v2-e02bca1186672970087d9a8bc8a5ff08_b.jpg" alt=""><img src="https://pic3.zhimg.com/80/v2-e02bca1186672970087d9a8bc8a5ff08_hd.jpg" alt=""></p>
<p><img src="https://pic2.zhimg.com/v2-65ab14f08c0821aaddf792402b19aeec_b.jpg" alt=""><img src="https://pic2.zhimg.com/80/v2-65ab14f08c0821aaddf792402b19aeec_hd.jpg" alt=""></p>
<p>Object.getOwnProperty</p>
<p>ç”¨äºè¿”å›å¯¹è±¡çš„è‡ªæœ‰å±æ€§ï¼ŒåŒ…æ‹¬å¯æšä¸¾å’Œä¸å¯æšä¸¾çš„</p>
<pre><code>var obj = {&quot;name&quot;:&quot;Poly&quot;, &quot;career&quot;:&quot;it&quot;}
Object.defineProperty(obj, &quot;age&quot;, {value:&quot;forever 18&quot;, enumerable:false});
Object.prototype.protoPer1 = function(){console.log(&quot;proto&quot;);};
Object.prototype.protoPer2 = 2;
console.log(&quot;Object.getOwnPropertyNames: &quot;);
console.log(Object.getOwnPropertyNames(obj));
</code></pre><p><img src="https://pic3.zhimg.com/v2-e58a5ceb8f77c623bd452a5fc8063745_b.jpg" alt=""><img src="https://pic3.zhimg.com/80/v2-e58a5ceb8f77c623bd452a5fc8063745_hd.jpg" alt=""></p>
<p>for..of</p>
<pre><code>var obj = {&quot;name&quot;:&quot;Poly&quot;, &quot;career&quot;:&quot;it&quot;}
Object.defineProperty(obj, &quot;age&quot;, {value:&quot;forever 18&quot;, enumerable:false});
Object.prototype.protoPer1 = function(){console.log(&quot;proto&quot;);};
Object.prototype.protoPer2 = 2;
console.log(&quot;For of : &quot;);
for(var a of Object.entries(obj)) console.log(a);
</code></pre><p><img src="https://pic1.zhimg.com/v2-cb632b12eee1e290befbd61a0da022fd_b.jpg" alt=""></p>
<p><img src="https://pic2.zhimg.com/v2-32223787728e13f239b4f59b0aa64a94_b.jpg" alt=""></p>
<p><img src="https://pic1.zhimg.com/v2-6ce8346c2e1e4479f49c6acf22292fac_b.jpg" alt=""></p>
<p><img src="https://pic1.zhimg.com/v2-ec6d7c3be11ccc0101407a2f40ef803a_b.jpg" alt=""></p>
<p><img src="https://pic3.zhimg.com/v2-84d13fa8dbdace85c39378fd2e9dc09a_b.jpg" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/18/æ¢ç´¢webpack-æœºåˆ¶/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/18/æ¢ç´¢webpack-æœºåˆ¶/" itemprop="url">æ¢ç´¢webpack æœºåˆ¶</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-05-18T22:20:52+08:00">
                2017-05-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æœ¬æ–‡ä»ç®€å•çš„ä¾‹å­å…¥æ‰‹ï¼Œä»æ‰“åŒ…æ–‡ä»¶å»åˆ†æä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼šwebpackæ‰“åŒ…æ–‡ä»¶æ˜¯æ€æ ·çš„ï¼Ÿå¦‚ä½•åšåˆ°å…¼å®¹å„å¤§æ¨¡å—åŒ–æ–¹æ¡ˆçš„ï¼Ÿwebpack3å¸¦æ¥çš„æ–°ç‰¹æ€§åˆæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<h2 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>ä¸€ä¸ªç®€å•çš„ä¾‹å­</h2><p>webpacké…ç½®</p>
<pre><code>// webpack.config.js
module.exports = {
  entry: &apos;./src/index.js&apos;,
  output: {
    filename: &apos;bundle.js&apos;,
    path: path.resolve(__dirname, &apos;dist&apos;)
  },
};
</code></pre><p>ç®€å•çš„jsæ–‡ä»¶</p>
<pre><code>// src/index.js
 console.log(&apos;hello world&apos;);
</code></pre><p>webpackæ‰“åŒ…åçš„ä»£ç </p>
<pre><code>// dist/bundle.js
 /******/ (function(modules) { // webpackBootstrap
/******/     // The module cache
/******/     var installedModules = {};
/******/
/******/     // The require function
/******/     function __webpack_require__(moduleId) {
/******/
/******/         // Check if module is in cache
/******/         if(installedModules[moduleId]) {
/******/             return installedModules[moduleId].exports;
/******/         }
/******/         // Create a new module (and put it into the cache)
/******/         var module = installedModules[moduleId] = {
/******/             i: moduleId,
/******/             l: false,
/******/             exports: {}
/******/         };
/******/
/******/         // Execute the module function
/******/         modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/         // Flag the module as loaded
/******/         module.l = true;
/******/
/******/         // Return the exports of the module
/******/         return module.exports;
/******/     }
/******/
/******/
/******/     // expose the modules object (__webpack_modules__)
/******/     __webpack_require__.m = modules;
/******/
/******/     // expose the module cache
/******/     __webpack_require__.c = installedModules;
/******/
/******/     // define getter function for harmony exports
/******/     __webpack_require__.d = function(exports, name, getter) {
/******/         if(!__webpack_require__.o(exports, name)) {
/******/             Object.defineProperty(exports, name, {
/******/                 configurable: false,
/******/                 enumerable: true,
/******/                 get: getter
/******/             });
/******/         }
/******/     };
/******/
/******/     // getDefaultExport function for compatibility with non-harmony modules
/******/     __webpack_require__.n = function(module) {
/******/         var getter = module &amp;&amp; module.__esModule ?
/******/             function getDefault() { return module[&apos;default&apos;]; } :
/******/             function getModuleExports() { return module; };
/******/         __webpack_require__.d(getter, &apos;a&apos;, getter);
/******/         return getter;
/******/     };
/******/
/******/     // Object.prototype.hasOwnProperty.call
/******/     __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/     // __webpack_public_path__
/******/     __webpack_require__.p = &quot;&quot;;
/******/
/******/     // Load entry module and return exports
/******/     return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

console.log(&apos;hello world&apos;);


/***/ })
/******/ ]);
</code></pre><p>ä¸€çœ‹ä½ å°±ä¼šæƒ³ï¼Œæˆ‘å°±ä¸€è¡Œä»£ç ï¼Œä½ ç»™æˆ‘æ‰“åŒ…é‚£ä¹ˆå¤šï¼Ÿï¼Ÿï¼Ÿï¼ˆé»‘äººé—®å·ï¼‰</p>
<p>æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹è¿™éƒ¨åˆ†ä»£ç ï¼Œå…ˆç²¾ç®€ä¸€ä¸‹ï¼Œå…¶å®æ•´ä½“å°±æ˜¯ä¸€ä¸ªè‡ªæ‰§è¡Œå‡½æ•°ï¼Œç„¶åä¼ å…¥ä¸€ä¸ªæ¨¡å—æ•°ç»„</p>
<pre><code>(function(modules) { 
     //...
 })([function(module, exports) {
     //..
 }])
</code></pre><p>å¥½äº†ï¼Œä¼ å…¥æ¨¡å—æ•°ç»„åšäº†ä»€ä¹ˆ(å…¶å®æ³¨é‡Šéƒ½å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘åªæ˜¯å¤§æ¦‚ç¿»è¯‘ä¸€ä¸‹ï¼‰</p>
<pre><code>/******/ (function(modules) { // webpackBootstrap
/******/     // The module cache  ç¼“å­˜å·²ç»loadè¿‡çš„æ¨¡å—
/******/     var installedModules = {};
/******/
/******/     // The require function  å¼•ç”¨çš„å‡½æ•°
/******/     function __webpack_require__(moduleId) {
/******/
/******/         // Check if module is in cache å‡å¦‚åœ¨ç¼“å­˜é‡Œå°±ç›´æ¥è¿”å›
/******/         if(installedModules[moduleId]) {
/******/             return installedModules[moduleId].exports;
/******/         }
/******/         // Create a new module (and put it into the cache) æ„é€ ä¸€ä¸ªæ¨¡å—å¹¶æ”¾å…¥ç¼“å­˜
/******/         var module = installedModules[moduleId] = {
/******/             i: moduleId, //æ¨¡å—id
/******/             l: false, // æ˜¯å¦å·²ç»åŠ è½½å®Œæ¯•
/******/             exports: {} // å¯¹å¤–æš´éœ²çš„å†…å®¹
/******/         };
/******/
/******/         // Execute the module function ä¼ å…¥æ¨¡å—å‚æ•°ï¼Œå¹¶æ‰§è¡Œæ¨¡å—
/******/         modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/         // Flag the module as loaded æ ‡è®°æ¨¡å—å·²ç»åŠ è½½å®Œæ¯•
/******/         module.l = true;
/******/
/******/         // Return the exports of the module è¿”å›æ¨¡å—æš´éœ²çš„å†…å®¹
/******/         return module.exports;
/******/     }
/******/
/******/
/******/     // expose the modules object (__webpack_modules__) æš´éœ²æ¨¡å—æ•°ç»„
/******/     __webpack_require__.m = modules;
/******/
/******/     // expose the module cache æš´éœ²ç¼“å­˜æ•°ç»„
/******/     __webpack_require__.c = installedModules;
/******/
/******/     // define getter function for harmony exports ä¸ºES6 exportså®šä¹‰getter
/******/     __webpack_require__.d = function(exports, name, getter) {
/******/         if(!__webpack_require__.o(exports, name)) { // å‡å¦‚exportsæœ¬èº«ä¸å«æœ‰nameè¿™ä¸ªå±æ€§
/******/             Object.defineProperty(exports, name, {
/******/                 configurable: false,
/******/                 enumerable: true,
/******/                 get: getter
/******/             });
/******/         }
/******/     };
/******/
/******/     // getDefaultExport function for compatibility with non-harmony modules è§£å†³ES moduleå’ŒCommon js moduleçš„å†²çªï¼ŒESåˆ™è¿”å›module[&apos;default&apos;]
/******/     __webpack_require__.n = function(module) {
/******/         var getter = module &amp;&amp; module.__esModule ?
/******/             function getDefault() { return module[&apos;default&apos;]; } :
/******/             function getModuleExports() { return module; };
/******/         __webpack_require__.d(getter, &apos;a&apos;, getter);
/******/         return getter;
/******/     };
/******/
/******/     // Object.prototype.hasOwnProperty.call
/******/     __webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/     // __webpack_public_path__ webpacké…ç½®ä¸‹çš„å…¬å…±è·¯å¾„
/******/     __webpack_require__.p = &quot;&quot;;
/******/
/******/     // Load entry module and return exports æœ€åæ‰§è¡Œentryæ¨¡å—å¹¶ä¸”è¿”å›å®ƒçš„æš´éœ²å†…å®¹
/******/     return __webpack_require__(__webpack_require__.s = 0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports) {

console.log(&apos;hello world&apos;);


/***/ })
/******/ ]);
</code></pre><p>æ•´ä½“æµç¨‹æ˜¯æ€æ ·çš„å‘¢</p>
<ul>
<li>ä¼ å…¥moduleæ•°ç»„</li>
<li><p>è°ƒç”¨<strong>webpack_require</strong>(<strong>webpack_require</strong>.s = 0)</p>
</li>
<li><p>æ„é€ moduleå¯¹è±¡ï¼Œæ”¾å…¥ç¼“å­˜</p>
</li>
<li>è°ƒç”¨module,ä¼ å…¥ç›¸åº”å‚æ•°modules[moduleId].call(module.exports, module, module.exports, <strong>webpack_require</strong>); ï¼ˆè¿™é‡Œexportsä¼šè¢«å‡½æ•°å†…éƒ¨çš„ä¸œè¥¿ä¿®æ”¹ï¼‰</li>
<li>æ ‡è®°moduleå¯¹è±¡å·²ç»åŠ è½½å®Œæ¯•</li>
<li><p>è¿”å›æ¨¡å—æš´éœ²çš„å†…å®¹ï¼ˆæ³¨æ„åˆ°ä¸Šé¢å‡½æ•°ä¼ å…¥äº†module.exports,å¯ä»¥å¯¹å¼•ç”¨è¿›è¡Œä¿®æ”¹ï¼‰</p>
</li>
<li><p>æ¨¡å—å‡½æ•°ä¸­ä¼ å…¥module, module.exports, webpack_require</p>
</li>
<li>æ‰§è¡Œè¿‡ç¨‹ä¸­é€šè¿‡å¯¹ä¸Šé¢ä¸‰è€…çš„å¼•ç”¨ä¿®æ”¹ï¼Œå®Œæˆå˜é‡æš´éœ²å’Œå¼•ç”¨</li>
</ul>
<h2 id="webpackæ¨¡å—æœºåˆ¶æ˜¯æ€æ ·çš„"><a href="#webpackæ¨¡å—æœºåˆ¶æ˜¯æ€æ ·çš„" class="headerlink" title="webpackæ¨¡å—æœºåˆ¶æ˜¯æ€æ ·çš„"></a>webpackæ¨¡å—æœºåˆ¶æ˜¯æ€æ ·çš„</h2><p>æˆ‘ä»¬å¯ä»¥å»å®˜ç½‘çœ‹ä¸‹webpackæ¨¡å—</p>
<blockquote>
<p><a href="https://link.zhihu.com/?target=https%3A//doc.webpack-china.org/concepts/modules%23-webpack-" target="_blank" rel="noopener">https://doc.webpack-china.org/concepts/modules#-webpack-</a><br>webpack æ¨¡å—èƒ½å¤Ÿä»¥å„ç§æ–¹å¼è¡¨è¾¾å®ƒä»¬çš„ä¾èµ–å…³ç³»ï¼Œå‡ ä¸ªä¾‹å­å¦‚ä¸‹ï¼š</p>
</blockquote>
<ul>
<li>ES2015 import è¯­å¥</li>
<li>CommonJS require() è¯­å¥</li>
<li>AMD define å’Œ require è¯­å¥</li>
<li>css/sass/less æ–‡ä»¶ä¸­çš„ @import è¯­å¥ã€‚</li>
<li>æ ·å¼(url(â€¦))æˆ– HTML æ–‡ä»¶(<img src="/2017/05/18/æ¢ç´¢webpack-æœºåˆ¶/...">)ä¸­çš„å›¾ç‰‡é“¾æ¥(image url)</li>
</ul>
<p>å¼ºå¤§çš„webpackæ¨¡å—å¯ä»¥å…¼å®¹å„ç§æ¨¡å—åŒ–æ–¹æ¡ˆï¼Œå¹¶ä¸”æ— ä¾µå…¥æ€§(non-opinionated)</p>
<p>æˆ‘ä»¬å¯ä»¥å†ç¼–å†™ä¾‹å­ä¸€æ¢ç©¶ç«Ÿ</p>
<h2 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h2><p>ä¿®æ”¹src/index.js</p>
<pre><code>var cj = require(&apos;./cj.js&apos;);

console.log(&apos;hello world&apos;);
cj();
</code></pre><p>æ–°å¢src/cj.jsï¼Œä¿æŒå‰é¢ä¾‹å­å…¶ä»–ä¸å˜</p>
<pre><code>// src/cj.js
function a() {
    console.log(&quot;CommonJS&quot;);
}
module.exports = a;
</code></pre><p>å†æ¬¡è¿è¡Œwebpack</p>
<pre><code>/******/ (function(modules) { // webpackBootstrap
  //... çœç•¥ä»£ç 
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

let cj = __webpack_require__(1);

console.log(&apos;hello world&apos;);
cj();


/***/ }),
/* 1 */
/***/ (function(module, exports) {

function a() {
    console.log(&quot;CommonJS&quot;);
}
module.exports = a;


/***/ })
/******/ ]);
</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¨¡å—æ•°ç»„å¤šäº†ä¸ªå¼•å…¥çš„æ–‡ä»¶ï¼Œç„¶åindex.jsæ¨¡å—å‡½æ•°å¤šäº†ä¸ªå‚æ•°<strong>webpack_require</strong>ï¼Œå»å¼•ç”¨æ–‡ä»¶ï¼ˆ<strong>webpack_require</strong>åœ¨ä¸Šä¸€èŠ‚æœ‰ä»‹ç»ï¼‰ï¼Œæ•´ä½“ä¸Šå°±æ˜¯ä¾èµ–çš„æ¨¡å—ä¿®æ”¹äº†module.exportsï¼Œç„¶åä¸»æ¨¡å—æ‰§è¡Œä¾èµ–æ¨¡å—ï¼Œè·å–exportså³å¯</p>
<h2 id="ES2015-import"><a href="#ES2015-import" class="headerlink" title="ES2015 import"></a>ES2015 import</h2><p>æ–°å¢src/es.js</p>
<pre><code>// src/es.js
export default function b() {
    console.log(&apos;ES Modules&apos;);
}
</code></pre><p>ä¿®æ”¹src/index.js</p>
<pre><code>// src/index.js
import es from &apos;./es.js&apos;;

console.log(&apos;hello world&apos;);
es();
</code></pre><p>webpack.config.jsä¸å˜ï¼Œæ‰§è¡Œwebpack</p>
<pre><code>/******/ (function(modules) { // webpackBootstrap
// ... çœç•¥ä»£ç 
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

&quot;use strict&quot;;
Object.defineProperty(__webpack_exports__, &quot;__esModule&quot;, { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__es_js__ = __webpack_require__(1);


console.log(&apos;hello world&apos;);
Object(__WEBPACK_IMPORTED_MODULE_0__es_js__[&quot;a&quot; /* default */])();


/***/ }),
/* 1 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

&quot;use strict&quot;;
/* harmony export (immutable) */ __webpack_exports__[&quot;a&quot;] = b;
function b() {
    console.log(&apos;ES Modules&apos;);
}


/***/ })
/******/ ]);
</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒä»¬éƒ½å˜æˆäº†ä¸¥æ ¼æ¨¡å¼ï¼Œwebpackè‡ªåŠ¨é‡‡ç”¨çš„</p>
<p>è¡¨ç°å…¶å®è·ŸCommonJSç›¸ä¼¼ï¼Œä¹Ÿæ˜¯ä¼ å…¥exportç„¶åä¿®æ”¹ï¼Œåœ¨ä¸»æ¨¡å—å†requireè¿›æ¥ï¼Œ</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸ª</p>
<pre><code>Object.defineProperty(__webpack_exports__, &quot;__esModule&quot;, { value: true });
</code></pre><p>è¿™ä¸ªå¹²å˜›ç”¨çš„ï¼Ÿå…¶å®å°±æ˜¯æ ‡è®°å½“å‰çš„exportsæ˜¯esæ¨¡å—ï¼Œè¿˜è®°å¾—ä¹‹å‰çš„<strong>webpack_require</strong>.nå—ï¼Œæˆ‘ä»¬å†æ‹¿å‡ºæ¥çœ‹çœ‹</p>
<pre><code>/******/     // getDefaultExport function for compatibility with non-harmony modules è§£å†³ES moduleå’ŒCommon js moduleçš„å†²çªï¼ŒESåˆ™è¿”å›module[&apos;default&apos;]
/******/     __webpack_require__.n = function(module) {
/******/         var getter = module &amp;&amp; module.__esModule ?
/******/             function getDefault() { return module[&apos;default&apos;]; } :
/******/             function getModuleExports() { return module; };
/******/         __webpack_require__.d(getter, &apos;a&apos;, getter);
/******/         return getter;
/******/     };
</code></pre><p>ä¸ºäº†é¿å…è·ŸéES Moduleså†²çªï¼Ÿå†²çªåœ¨å“ªé‡Œå‘¢ï¼Ÿ<br>å…¶å®è¿™éƒ¨åˆ†å¦‚æœä½ çœ‹åˆ°babelè½¬æ¢ES Modulesæºç å°±çŸ¥é“äº†ï¼Œä¸ºäº†å…¼å®¹æ¨¡å—ï¼Œä¼šæŠŠES Modulesç›´æ¥æŒ‚åœ¨exports.defaultä¸Šï¼Œç„¶ååŠ ä¸Š__esModuleå±æ€§ï¼Œå¼•å…¥çš„æ—¶å€™åˆ¤æ–­ä¸€æ¬¡æ˜¯å¦æ˜¯è½¬æ¢æ¨¡å—ï¼Œæ˜¯åˆ™å¼•å…¥module[â€˜defaultâ€™]ï¼Œä¸æ˜¯åˆ™å¼•å…¥module</p>
<p>æˆ‘ä»¬å†å¤šå¼•å…¥å‡ ä¸ªES Modulesçœ‹çœ‹æ•ˆæœ</p>
<pre><code>// src/es.js
export function es() {
    console.log(&apos;ES Modules&apos;);
}

export function esTwo() {
    console.log(&apos;ES Modules Two&apos;);
}

export function esThree() {
    console.log(&apos;ES Modules Three&apos;);
}

export function esFour() {
    console.log(&apos;ES Modules Four&apos;);
}
</code></pre><p>æˆ‘ä»¬å¤šå¼•å…¥esTwoå’ŒesFourï¼Œä½†æ˜¯ä¸ä½¿ç”¨esFour</p>
<pre><code>// src/index.js
import { es, esTwo, esFour} from &apos;./es.js&apos;;

console.log(&apos;hello world&apos;);
es();
esTwo();
</code></pre><p>å¾—å‡º</p>
<pre><code>/******/ (function(modules) { // webpackBootstrap
// ...
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

&quot;use strict&quot;;
Object.defineProperty(__webpack_exports__, &quot;__esModule&quot;, { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__es_js__ = __webpack_require__(1);


console.log(&apos;hello world&apos;);
Object(__WEBPACK_IMPORTED_MODULE_0__es_js__[&quot;a&quot; /* es */])();
Object(__WEBPACK_IMPORTED_MODULE_0__es_js__[&quot;b&quot; /* esTwo */])();


/***/ }),
/* 1 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

&quot;use strict&quot;;
/* harmony export (immutable) */ __webpack_exports__[&quot;a&quot;] = es;
/* harmony export (immutable) */ __webpack_exports__[&quot;b&quot;] = esTwo;
/* unused harmony export esThree */
/* unused harmony export esFour */
function es() {
    console.log(&apos;ES Modules&apos;);
}

function esTwo() {
    console.log(&apos;ES Modules Two&apos;);
}

function esThree() {
    console.log(&apos;ES Modules Three&apos;);
}

function esFour() {
    console.log(&apos;ES Modules Four&apos;);
}



/***/ })
/******/ ]);
</code></pre><p>å—¯å—¯å…¶å®è·Ÿå‰é¢æ˜¯ä¸€æ ·çš„ï¼Œä¸¾å‡ºè¿™ä¸ªä¾‹å­é‡ç‚¹åœ¨å“ªé‡Œå‘¢ï¼Œæœ‰æ²¡æœ‰æ³¨æ„åˆ°æ³¨é‡Šä¸­</p>
<pre><code>/* unused harmony export esThree */
/* unused harmony export esFour */
</code></pre><p>esThreeæ˜¯æˆ‘ä»¬æ²¡æœ‰å¼•å…¥çš„æ¨¡å—ï¼ŒesFouræ˜¯æˆ‘ä»¬å¼•ç”¨ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨çš„æ¨¡å—ï¼Œwebpackå‡å¯¹å®ƒä»¬åšäº†unusedçš„æ ‡è®°ï¼Œå…¶å®è¿™ä¸ªå¦‚æœä½ ä½¿ç”¨äº†webpackæ’ä»¶uglifyï¼Œé€šè¿‡æ ‡è®°ï¼Œå°±ä¼šæŠŠesThreeå’ŒesFourè¿™ä¸¤ä¸ªæœªä½¿ç”¨çš„ä»£ç æ¶ˆé™¤ï¼ˆå…¶å®å®ƒå°±æ˜¯tree-shaking)</p>
<h2 id="AMD"><a href="#AMD" class="headerlink" title="AMD"></a>AMD</h2><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹webpackæ€ä¹ˆæ”¯æŒAMD</p>
<p>æ–°å¢src/amd.js</p>
<pre><code>// src/amd.js
define([
],function(){
    return {
        amd:function(){
            console.log(&apos;AMD&apos;);
        }
    };
});
</code></pre><p>ä¿®æ”¹index.js</p>
<pre><code>// src/index.js
define([
    &apos;./amd.js&apos;
],function(amdModule){
    amdModule.amd();
});
</code></pre><p>å¾—åˆ°</p>
<pre><code>/******/ (function(modules) { // webpackBootstrap
// ... çœç•¥ä»£ç 
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [
    __webpack_require__(1)
], __WEBPACK_AMD_DEFINE_RESULT__ = function(amdModule){
    amdModule.amd();
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
                __WEBPACK_AMD_DEFINE_RESULT__ !== undefined &amp;&amp; (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ }),
/* 1 */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [
], __WEBPACK_AMD_DEFINE_RESULT__ = function(){
    return {
        amd:function(){
            console.log(&apos;AMD&apos;);
        }
    };
}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),
                __WEBPACK_AMD_DEFINE_RESULT__ !== undefined &amp;&amp; (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));


/***/ })
/******/ ]);
</code></pre><p>å…ˆçœ‹amd.jsæ•´ç†ä¸€ä¸‹ä»£ç </p>
<pre><code>function(module, exports, __webpack_require__) {
    var __WEBPACK_AMD_DEFINE_ARRAY__,
        __WEBPACK_AMD_DEFINE_RESULT__;

    !(
        __WEBPACK_AMD_DEFINE_ARRAY__ = [],

        __WEBPACK_AMD_DEFINE_RESULT__ = function() {
            return {
                amd: function() {
                    console.log(&apos;AMD&apos;);
                }
            };
        }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),

        __WEBPACK_AMD_DEFINE_RESULT__ !== undefined &amp;&amp;
        (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)

    );
})
</code></pre><p>ç®€å•æ¥è®²æ”¶é›†define Arrayç„¶åç½®å…¥è¿”å›å‡½æ•°ï¼Œæ ¹æ®å‚æ•°è·å–ä¾èµ–</p>
<blockquote>
<p>applyå¯¹æ•°ç»„æ‹†è§£æˆä¸€ä¸ªä¸€ä¸ªå‚æ•°</p>
</blockquote>
<p>å†çœ‹index.jsæ¨¡å—éƒ¨åˆ†</p>
<pre><code>function(module, exports, __webpack_require__) {

    var __WEBPACK_AMD_DEFINE_ARRAY__,
        __WEBPACK_AMD_DEFINE_RESULT__;
    !(
        __WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(1)],
        __WEBPACK_AMD_DEFINE_RESULT__ = function(amdModule) {
                amdModule.amd();
        }.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),

        __WEBPACK_AMD_DEFINE_RESULT__ !== undefined &amp;&amp; 
        (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)
    );
}
</code></pre><p>å…¶å®å°±æ˜¯å¼•å…¥äº†amd.jsæš´éœ²çš„{amd:[Function: amd]}</p>
<h2 id="css-image"><a href="#css-image" class="headerlink" title="css/image?"></a>css/image?</h2><p>csså’Œimageä¹Ÿå¯ä»¥æˆä¸ºwebpackçš„æ¨¡å—ï¼Œè¿™æ˜¯ä»¤äººéœ‡æƒŠçš„ï¼Œè¿™å°±ä¸èƒ½é€šè¿‡æ™®é€šçš„hack commonjsæˆ–è€…å‡½æ•°è°ƒç”¨ç®€å•å»è°ƒç”¨äº†ï¼Œè¿™å°±æ˜¯anything to JSï¼Œå®ƒå°±éœ€è¦å€ŸåŠ©webpack loaderå»å®ç°äº†</p>
<blockquote>
<p>åƒcsså°±æ˜¯è½¬æ¢æˆä¸€æ®µjsä»£ç ï¼Œé€šè¿‡å¤„ç†ï¼Œè°ƒç”¨æ—¶å°±æ˜¯å¯ä»¥ç”¨jså°†è¿™æ®µcssæ’å…¥åˆ°styleä¸­ï¼Œimageä¹Ÿç±»ä¼¼ï¼Œè¿™éƒ¨åˆ†å°±ä¸è¯¦ç»†é˜è¿°äº†ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥æ·±å…¥å»ç ”ç©¶</p>
</blockquote>
<h2 id="webpack3æ–°ç‰¹æ€§"><a href="#webpack3æ–°ç‰¹æ€§" class="headerlink" title="webpack3æ–°ç‰¹æ€§"></a>webpack3æ–°ç‰¹æ€§</h2><p>æˆ‘ä»¬å¯ä»¥å†é¡ºä¾¿çœ‹ä¸‹webpack3æ–°ç‰¹æ€§çš„è¡¨ç°<br>å…·ä½“å¯ä»¥çœ‹è¿™é‡Œ<a href="https://link.zhihu.com/?target=https%3A//medium.com/webpack/webpack-3-official-release-15fd2dd8f07b" target="_blank" rel="noopener">https://medium.com/webpack/webpack-3-official-release-15fd2dd8f07b</a></p>
<h2 id="Scope-Hoisting"><a href="#Scope-Hoisting" class="headerlink" title="Scope Hoisting"></a>Scope Hoisting</h2><p>æˆ‘ä»¬å¯ä»¥å‘ç°æ¨¡å—æ•°ç»„æ˜¯ä¸€ä¸ªä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°ç„¶åé—­åŒ…å¼•ç”¨webpackä¸»å‡½æ•°çš„ç›¸åº”å†…å®¹ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œç„¶åå¸¦æ¥çš„ç»“æœæ˜¯åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œé€Ÿåº¦å˜æ…¢ï¼Œç„¶åwebpack3å­¦ä¹ äº†Closure Compilerå’ŒRollupJSè¿™ä¸¤ä¸ªå·¥å…·ï¼Œè¿æ¥æ‰€æœ‰é—­åŒ…åˆ°ä¸€ä¸ªé—­åŒ…é‡Œï¼Œæ”¾å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè®©æ‰§è¡Œé€Ÿåº¦æ›´å¿«,å¹¶ä¸”æ•´ä½“ä»£ç ä½“ç§¯ä¹Ÿä¼šæœ‰æ‰€ç¼©å°</p>
<p>æˆ‘ä»¬å¯ä»¥å®é™…çœ‹ä¸€ä¸‹æ•ˆæœï¼ˆè¦æ³¨æ„çš„æ˜¯è¿™ä¸ªç‰¹æ€§åªæ”¯æŒES Modules,æ˜¯ä¸æ”¯æŒCommonJså’ŒAMDçš„ï¼‰<br>ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œé…ç½®webpack.config.jsï¼Œå¢åŠ new webpack.optimize.ModuleConcatenationPlugin()</p>
<pre><code>const path = require(&apos;path&apos;);
const webpack = require(&apos;webpack&apos;);

module.exports = {
  entry: &apos;./src/index.js&apos;,
  output: {
    filename: &apos;bundle.js&apos;,
    path: path.resolve(__dirname, &apos;dist&apos;)
  },
  module: {
  },
  plugins: [
    new webpack.optimize.ModuleConcatenationPlugin(),
  ]
};
</code></pre><p>æ‰“åŒ…</p>
<pre><code>/******/ (function(modules) { // webpackBootstrap
// ... çœç•¥ä»£ç 
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

&quot;use strict&quot;;
Object.defineProperty(__webpack_exports__, &quot;__esModule&quot;, { value: true });

// CONCATENATED MODULE: ./src/es.js
function es() {
    console.log(&apos;ES Modules&apos;);
}

function esTwo() {
    console.log(&apos;ES Modules Two&apos;);
}

function esThree() {
    console.log(&apos;ES Modules Three&apos;);
}

function esFour() {
    console.log(&apos;ES Modules Four&apos;);
}


// CONCATENATED MODULE: ./src/index.js
// src/index.js


console.log(&apos;hello world&apos;);
es();


/***/ })
/******/ ]);
</code></pre><p>æˆ‘ä»¬å¯ä»¥æƒŠå–œçš„å‘ç°æ²¡æœ‰ä»€ä¹ˆrequireäº†ï¼Œå®ƒä»¬æ‹¼æ¥æˆäº†ä¸€ä¸ªå‡½æ•°ï¼Œgood!?</p>
<h2 id="Magic-Comments"><a href="#Magic-Comments" class="headerlink" title="Magic Comments"></a>Magic Comments</h2><p>code splittingæ˜¯webpackä¸€ä¸ªé‡ç‚¹ç‰¹æ€§ä¹‹ä¸€ï¼Œæ¶‰åŠåˆ°è¦åŠ¨æ€å¼•å…¥çš„æ—¶å€™ï¼Œwebpackå¯ä»¥ä½¿ç”¨ require.ensureå»å®ç°ï¼Œåæ¥webpack2æ”¯æŒä½¿ç”¨äº†ç¬¦åˆ ECMAScript ææ¡ˆ çš„ import() è¯­æ³•ï¼Œä½†æ˜¯å®ƒæœ‰ä¸ªä¸è¶³ä¹‹å¤„ï¼Œæ— æ³•æŒ‡å®šchunkçš„åç§°chunkName,ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå‡ºç°äº†Magic Commentsï¼Œæ”¯æŒç”¨æ³¨é‡Šçš„æ–¹å¼å»æŒ‡å®šï¼Œå¦‚ä¸‹</p>
<pre><code>import(/* webpackChunkName: &quot;my-chunk-name&quot; */ &apos;module&apos;);
</code></pre><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>webpackæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ¨¡å—æ‰“åŒ…å·¥å…·ï¼Œåœ¨å¤„ç†ä¾èµ–ã€æ¨¡å—ä¸Šéƒ½å¾ˆä¼˜ç§€ï¼Œæœ¬æ–‡ä»bundle.jsæ–‡ä»¶åˆ†æå‡ºå‘å»æ¢ç´¢äº†ä¸åŒæ¨¡å—æ–¹æ¡ˆçš„åŠ è½½æœºåˆ¶ï¼Œåˆæ­¥å»ç†è§£webpackï¼Œå¹¶ä¸”å¯¹webpack3ç‰¹æ€§è¿›è¡Œé˜è¿°ï¼Œå½“ç„¶ï¼Œwebpackè¿˜æœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦å»æ¢ç´¢æ·±ç©¶ï¼Œæ•¬è¯·æœŸå¾…ä»¥åçš„æ–‡ç« å§ï½</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/03/ä½ ä¸çŸ¥é“çš„-Promise-å¯¹è±¡é»‘ç§‘æŠ€/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/03/ä½ ä¸çŸ¥é“çš„-Promise-å¯¹è±¡é»‘ç§‘æŠ€/" itemprop="url">ä½ ä¸çŸ¥é“çš„ Promise å¯¹è±¡é»‘ç§‘æŠ€</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-05-03T11:10:58+08:00">
                2017-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Promise-å¿…çŸ¥å¿…ä¼šï¼ˆåé“é¢˜ï¼‰"><a href="#Promise-å¿…çŸ¥å¿…ä¼šï¼ˆåé“é¢˜ï¼‰" class="headerlink" title="Promise å¿…çŸ¥å¿…ä¼šï¼ˆåé“é¢˜ï¼‰"></a><a href="https://libin1991.github.io/2018/09/25/Promise-%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/" target="_blank" rel="noopener">Promise å¿…çŸ¥å¿…ä¼šï¼ˆåé“é¢˜ï¼‰</a></h2><h2 id="ä¸€ã€resolve-åçš„æ‰§è¡Œæƒ…å†µ"><a href="#ä¸€ã€resolve-åçš„æ‰§è¡Œæƒ…å†µ" class="headerlink" title="ä¸€ã€resolve åçš„æ‰§è¡Œæƒ…å†µ"></a>ä¸€ã€resolve åçš„æ‰§è¡Œæƒ…å†µ</h2><p>æ— è®ºæ˜¯ resolve, rejectï¼Œéƒ½ä¼šå°†å‡½æ•°å‰©ä½™çš„ä»£ç æ‰§è¡Œå®Œ</p>
<pre><code>const promise = new Promise((resolve, reject) =&gt; {
    console.log(&apos;mark 1&apos;);
    resolve(&apos;hello world&apos;);     // reject(&apos;hello world&apos;);
    console.log(&apos;mark 2&apos;);
});

promise.then(result =&gt; {
    console.log(result);
}).catch(err =&gt; {
    console.log(err);
});
</code></pre><p>ç›¸å½“äºï¼š</p>
<pre><code>const promise = new Promise((resolve, reject) =&gt; {
    console.log(&apos;mark 1&apos;);
    console.log(&apos;mark 2&apos;);
    resolve(&apos;hello world&apos;);     // reject(&apos;hello world&apos;);
});

promise.then(result =&gt; {
    console.log(result);
}).catch(err =&gt; {
    console.log(err);
});
</code></pre><p>å¦‚æœä½ ä¸æƒ³åœ¨ resolve æˆ– reject åæ‰§è¡Œå‰©ä¸‹çš„ä»£ç æ®µï¼Œå¯ä»¥åœ¨ resolve åå°†å…¶è¿”å›<br><img src="https://pic4.zhimg.com/v2-f5b865c8a9df8ce752d057fe177c855e_b.jpg" alt=""><img src="https://pic4.zhimg.com/80/v2-f5b865c8a9df8ce752d057fe177c855e_hd.jpg" alt=""></p>
<pre><code>const promise = new Promise((resolve, reject) =&gt; {
    console.log(&apos;mark 1&apos;);
    return resolve(&apos;hello world&apos;);     // reject(&apos;hello world&apos;);
    console.log(&apos;mark 2&apos;);             // never be here
});

promise.then(result =&gt; {
    console.log(result);
}).catch(err =&gt; {
    console.log(err);
});
</code></pre><h2 id="äºŒã€ä¸²è¡Œæ‰§è¡Œå’Œå¹¶è¡Œæ‰§è¡Œï¼š"><a href="#äºŒã€ä¸²è¡Œæ‰§è¡Œå’Œå¹¶è¡Œæ‰§è¡Œï¼š" class="headerlink" title="äºŒã€ä¸²è¡Œæ‰§è¡Œå’Œå¹¶è¡Œæ‰§è¡Œï¼š"></a>äºŒã€ä¸²è¡Œæ‰§è¡Œå’Œå¹¶è¡Œæ‰§è¡Œï¼š</h2><ol>
<li>ä¸²è¡Œæ‰§è¡Œï¼šæœ‰ä¸€å † Promise å¯¹è±¡ï¼Œå®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯å›ºå®šçš„ï¼Œå‰ä¸€ä¸ª promise æ‰§è¡Œå®Œåï¼Œåä¸€ä¸ª promise æ‰å¼€å§‹æ‰§è¡Œï¼Œæ¯”å¦‚æ•°æ®åº“æŸ¥è¯¢ï¼Œå®ƒä»¬å¾€å¾€æœ‰å‰åçš„å› æœå…³ç³»ã€‚</li>
<li>å¹¶è¡Œæ‰§è¡Œï¼šæœ‰ä¸€å † Promise å¯¹è±¡ï¼Œå®ƒä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸å›ºå®šçš„ï¼Œæ²¡æœ‰å‰åå› æœå…³ç³»ï¼Œå¯ä»¥å¹¶å‘åœ°å»æ‰§è¡Œã€‚</li>
</ol>
<p>å¹¶è¡Œæ‰§è¡Œå¾ˆå¥½è§£å†³ï¼Œåœ¨ Promiseä¸­æœ‰ all è¿™ä¸ªå‡½æ•°æ”¯æŒ, Promise.all æ–¹æ³•ç”¨äºå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚å½“å¤šä¸ª Promise å®ä¾‹æ‰§è¡Œå®Œåæ‰å»æ‰§è¡Œæœ€åæ–°çš„ Promise å®ä¾‹ã€‚</p>
<pre><code>const datum = [];
for(let i = 0; i &lt; 10; i++) {
    datum.push(i);
}

Promise.all(datum.map(i =&gt; {
    return new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
        console.log(i * 200 + &quot; ms åæ‰§è¡Œç»“æŸ&quot;);
        resolve(&quot;ç¬¬ &quot; + (i + 1) + &quot; ä¸ª Promise æ‰§è¡Œç»“æŸ&quot;);
    }, i * 200);
    })
})).then((data) =&gt; {
    console.log(data);
});
</code></pre><p>å¦‚æœä¸ä½¿ç”¨ Promise.all è¿™ä¸ªæ–¹æ³•çš„è¯ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨åƒ ES7 çš„ async/await</p>
<pre><code>const asyncFun = async () =&gt; {
    const datum = []
    for(let i = 0; i &lt; 10; i++) {
        datum.push(new Promise((resolve, reject) =&gt; {
            setTimeout(() =&gt; {
                console.log(i * 200 + &apos;ms åæ‰§è¡Œç»“æŸ&apos;)
                resolve(&apos;ç¬¬ &apos; + (i + 1) + &apos; ä¸ª Promise æ‰§è¡Œç»“æŸ&apos;)
            }, i * 200)
        }))
    }
    const result = []
    for(let promise of datum) {
        result.push(await promise)
    }
    console.log(result)
}
asyncFun()
</code></pre><p>ä¸²è¡Œæ‰§è¡Œï¼šè¿™é‡Œæä¾›ä¸¤ç§æ–¹å¼</p>
<pre><code>const datum = [];
for(let i = 0; i &lt; 10; i++) {
    datum.push(i);
}

let serial = Promise.resolve();

for(let i of datum) {
    serial = serial.then(data =&gt; {
        console.log(data);
    return new Promise((resolve, reject) =&gt; {
        setTimeout(() =&gt; {
        console.log(i * 200 + &quot; ms åæ‰§è¡Œç»“æŸ&quot;);
        resolve(&quot;ç¬¬ &quot; + (i + 1) + &quot; ä¸ª Promise æ‰§è¡Œç»“æŸ&quot;);
        }, i * 200);
    })    
    });
}
</code></pre><p>å¦å¤–å¯ä»¥ä½¿ç”¨ reduce æ¥ä¸²è¡Œï¼š</p>
<pre><code>const datum = [];
for(let i = 0; i &lt; 10; i++) {
    datum.push(i);
}

datum.reduce((prev, cur) =&gt; {
    return prev.then(data =&gt; {
    console.log(data);
    return new Promise((resolve, reject) =&gt; {
        setTimeout(() =&gt; {
        console.log(cur * 200 + &quot; ms åæ‰§è¡Œç»“æŸ&quot;);
        resolve(&quot;ç¬¬ &quot; + (cur + 1) + &quot; ä¸ª Promise æ‰§è¡Œç»“æŸ&quot;);
        }, cur * 200);
    })    
    })
}, Promise.resolve(true));
</code></pre><h2 id="ä¸‰ã€å€¼ç©¿é€é—®é¢˜ï¼š"><a href="#ä¸‰ã€å€¼ç©¿é€é—®é¢˜ï¼š" class="headerlink" title="ä¸‰ã€å€¼ç©¿é€é—®é¢˜ï¼š"></a>ä¸‰ã€å€¼ç©¿é€é—®é¢˜ï¼š</h2><pre><code>let promise = new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
        resolve(&apos;Hello World!&apos;);
    }, 1000)
});

promise.then(&apos;å‘µå‘µå“’&apos;).then((data) =&gt; {
    console.log(data);           // Hello World
})
</code></pre><p>è¿™æ˜¯ä¸€ç§å€¼ç©¿é€çš„æƒ…å†µï¼Œä¸€èˆ¬æœ‰ä¸‹é¢ä¸¤ç§æƒ…å†µï¼š<br>promise å·²ç»æ˜¯ FULFILLED/REJECTED æ—¶ï¼Œé€šè¿‡ return this å®ç°çš„å€¼ç©¿é€ï¼š<br><img src="https://pic3.zhimg.com/v2-99374235673349f56d708c28511c27d2_b.jpg" alt=""><img src="https://pic3.zhimg.com/80/v2-99374235673349f56d708c28511c27d2_hd.jpg" alt=""></p>
<pre><code>let promise = new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
        resolve(&apos;Hello World!&apos;);
    }, 1000)
});

promise.then(() =&gt; {
    promise.then().then(null).then(&apos;å‘µå‘µå“’&apos;).then((res) =&gt; {
        console.log(res)
    })
    promise.catch().catch(null).then(&apos;å‘µå‘µå“’&apos;).then((res) =&gt; {
        console.log(res) 
    })
})
</code></pre><p>promise æ˜¯ PENDING æ—¶ï¼Œé€šè¿‡ç”Ÿæˆæ–°çš„ promise åŠ å…¥åˆ°çˆ¶ promise çš„ queueï¼Œçˆ¶ promise æœ‰å€¼æ—¶è°ƒç”¨ callFulfilled-&gt;doResolve æˆ– callRejected-&gt;doRejectï¼ˆå› ä¸º then/catch ä¼ å…¥çš„å‚æ•°ä¸æ˜¯å‡½æ•°ï¼‰è®¾ç½®å­ promise çš„çŠ¶æ€å’Œå€¼ä¸ºçˆ¶ promise çš„çŠ¶æ€å’Œå€¼ã€‚å¦‚ï¼š<br><img src="https://pic2.zhimg.com/v2-7d3d3728e3b1f90d905d4f4782c1f97a_b.jpg" alt=""><img src="https://pic2.zhimg.com/80/v2-7d3d3728e3b1f90d905d4f4782c1f97a_hd.jpg" alt=""></p>
<pre><code>let promise = new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
        resolve(&apos;Hello World!&apos;);
    }, 1000)
});

let a = promise.then(&apos;å‘µå‘µå“’&apos;);
a.then(res =&gt; {
    console.log(res);
});

let b = promise.catch(&apos;å‘µå‘µå“’&apos;);
b.then(res =&gt; {
    console.log(res);
})
</code></pre><p>æ€»è€Œè¨€ä¹‹ï¼Œå½“ä½ ç»™ then() ä¼ é€’ä¸€ä¸ªéå‡½æ•°ï¼ˆæ¯”å¦‚ä¸€ä¸ª promise ï¼‰å€¼çš„æ—¶å€™ï¼Œå®ƒå®é™…ä¸Šä¼šè§£é‡Šä¸º then(null) ï¼Œè¿™ä¼šå¯¼è‡´ä¹‹å‰çš„ promise çš„ç»“æœä¸¢å¤±ã€‚ä¾‹å¦‚:<br><img src="https://pic1.zhimg.com/v2-14fe675c00c5bc8154d161e3afed0f41_b.jpg" alt=""><img src="https://pic1.zhimg.com/80/v2-14fe675c00c5bc8154d161e3afed0f41_hd.jpg" alt=""></p>
<pre><code>Promise.resolve(&apos;First Value&apos;).then(Promise.resolve(&apos;Second Value&apos;)).then(null).then((value) =&gt; {
    console.log(value)    // First Value
})
</code></pre><h2 id="å››ã€ä¸è¦åœ¨å¼‚æ­¥å›è°ƒå‡½æ•°ä¸­ä½¿ç”¨-throw-Error"><a href="#å››ã€ä¸è¦åœ¨å¼‚æ­¥å›è°ƒå‡½æ•°ä¸­ä½¿ç”¨-throw-Error" class="headerlink" title="å››ã€ä¸è¦åœ¨å¼‚æ­¥å›è°ƒå‡½æ•°ä¸­ä½¿ç”¨ throw Error"></a>å››ã€ä¸è¦åœ¨å¼‚æ­¥å›è°ƒå‡½æ•°ä¸­ä½¿ç”¨ throw Error</h2><p>ä¸ä»… rejectï¼ŒæŠ›å‡ºçš„å¼‚å¸¸ä¹Ÿä¼šè¢«ä½œä¸ºæ‹’ç»çŠ¶æ€è¢« Promise æ•è·</p>
<pre><code>let promise = new Promise((resolve, reject) =&gt; {
    reject(&apos;This is an error&apos;);
});

promise.then(result =&gt; {
    console.log(result);
}).catch(error =&gt; {
    console.log(&apos;handle error: &apos;, error);  //handle error:  Error: This is an error
})
</code></pre><p>ä½†æ˜¯ï¼Œæ°¸è¿œä¸è¦åœ¨å›è°ƒé˜Ÿåˆ—ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œå› ä¸ºå›è°ƒé˜Ÿåˆ—è„±ç¦»äº†è¿è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå¼‚å¸¸æ— æ³•è¢«å½“å‰ä½œç”¨åŸŸæ•è·ã€‚</p>
<pre><code>let promise = new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
        throw Error(&apos;This is an error&apos;);
    });
});

promise.then(result =&gt; {
    console.log(result);
}).catch(error =&gt; {
    console.log(&apos;handle error: &apos;, error);  // Error: This is an error
});
</code></pre><p>ç®€å•è¯´æ¥ï¼Œå›è°ƒé˜Ÿåˆ—æŒ‡çš„æ˜¯ JS äº‹ä»¶å¾ªç¯ä¸­çš„ macrotask é˜Ÿåˆ—ï¼Œæ¯”å¦‚ setTimeout setInterval ä¼šæ’å…¥åˆ° macrotask ä¸­ã€‚å¦‚æœè¦åœ¨å›è°ƒå‡½æ•°ä¸­æ•è·å¼‚å¸¸ï¼Œè¯·ä½¿ç”¨ rejectï¼Œæ°¸è¿œä¸è¦ä½¿ç”¨ Errorã€‚<br>ä¸Šè¿°çš„ä»£ç åº”æ”¹æˆï¼š</p>
<pre><code>let promise = new Promise((resolve, reject) =&gt; {
    setTimeout(() =&gt; {
        reject(&apos;This is an error&apos;);
    });
});

promise.then(result =&gt; {
    console.log(result);
}).catch(error =&gt; {
    console.log(&apos;handle error: &apos;, error);  // Error: This is an error
});
</code></pre><h2 id="äº”ã€then-çš„ç¬¬äºŒä¸ªå‚æ•°è·Ÿ-catch-çš„åŒºåˆ«-ã€é¢è¯•å¸¸é—®ã€‘"><a href="#äº”ã€then-çš„ç¬¬äºŒä¸ªå‚æ•°è·Ÿ-catch-çš„åŒºåˆ«-ã€é¢è¯•å¸¸é—®ã€‘" class="headerlink" title="äº”ã€then çš„ç¬¬äºŒä¸ªå‚æ•°è·Ÿ catch çš„åŒºåˆ« ã€é¢è¯•å¸¸é—®ã€‘"></a>äº”ã€then çš„ç¬¬äºŒä¸ªå‚æ•°è·Ÿ catch çš„åŒºåˆ« ã€é¢è¯•å¸¸é—®ã€‘</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ then çš„ç¬¬äºŒå‚æ•°è·Ÿ catch ç”¨æ³•å¾ˆåƒï¼Œéƒ½æ˜¯ç”¨æ¥è¿›è¡Œé”™è¯¯å¤„ç†çš„ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š</p>
<pre><code>let promise1 = new Promise((resolve, reject) =&gt; {
    reject(&apos;this is an error&apos;);
});

promise1.then(data =&gt; {
    console.log(data);
}, err =&gt; {
    console.log(&apos;handle err:&apos;, err);    // handle err: this is an error
});

let promise2 = new Promise((resolve, reject) =&gt; {
    reject(&apos;this is an error&apos;);
});
promise2.then(data =&gt; {
    console.log(data);
}).catch(err =&gt; {
    console.log(&apos;handle err:&apos;, err);    // handle err: this is an error
});
</code></pre><p>å½“æ—¶è¿™ä¸¤è€…è¿˜æ˜¯åŒºåˆ«çš„ï¼ŒåŒºåˆ«äº then çš„ç¬¬äºŒå‚æ•°æ— æ³•å¤„ç†ç¬¬ä¸€å‚æ•°å‡½æ•°ä¸­çš„é”™è¯¯ã€‚</p>
<pre><code>let promise1 = Promise.resolve();
promise1.then(() =&gt; {
    throw Error(&apos;this is a error&apos;);   //UnhandledPromiseRejectionWarning: Unhandled promise rejection
}, err =&gt; {
    console.log(err);
})

let promise2 = Promise.resolve();

promise2.then(() =&gt; {
    throw Error(&apos;this is a error&apos;);  
}).catch(err =&gt; {
    console.log(&apos;handle err:&apos;, err);    //handle err: Error: this is a error
})
</code></pre><blockquote>
<p>å½“ä½ ä½¿ç”¨then( resolveHandler, rejectHandler)æ ¼å¼ï¼Œå¦‚æœ resolveHandler è‡ªå·±æŠ›å‡ºä¸€ä¸ªé”™è¯¯ rejectHandler å¹¶ä¸èƒ½æ•è·ã€‚ç¬¬ä¸€ä¸ª Promise å¯¹è±¡æ— æ³•å¤„ç†åŒçº§ then ä¸­çš„å‡½æ•°æŠ›å‡ºçš„å¼‚å¸¸ï¼Œæ‰€ä»¥åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæœ€åç›´æ¥ä½¿ç”¨ catch æ¥è¿›è¡Œå¼‚å¸¸æ•è·æ¯”è¾ƒä¿é™©ã€‚</p>
</blockquote>
<h2 id="å…­ã€å¤„ç†æœ€å-catch-å‡½æ•°ä¸­çš„å¼‚å¸¸"><a href="#å…­ã€å¤„ç†æœ€å-catch-å‡½æ•°ä¸­çš„å¼‚å¸¸" class="headerlink" title="å…­ã€å¤„ç†æœ€å catch å‡½æ•°ä¸­çš„å¼‚å¸¸"></a>å…­ã€å¤„ç†æœ€å catch å‡½æ•°ä¸­çš„å¼‚å¸¸</h2><p>ä¸€èˆ¬æˆ‘ä»¬ç”¨ catch æ¥æ•æ‰å‰é¢æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä½†æ˜¯å¦‚æœè¯•æƒ³ä¸€ä¸‹å¦‚æœæœ€åä¸€ä¸ª catch å‡½æ•°ä¹ŸæŠ›å‡ºäº†å¼‚å¸¸ï¼Œåº”è¯¥æ€ä¹ˆå¤„ç†å‘¢?</p>
<pre><code>let promise = new Promise((resolve, reject) =&gt; {
    reject(&apos;Hello World&apos;)
});

promise.catch((err) =&gt; {
    throw(&apos;Unexpected Error&apos;);   // Uncaught (in promise) Unexpected Error
})
</code></pre><p>é¢å¯¹è¿™æ ·çš„é”™è¯¯ï¼Œä¸ç®¡ä»¥ then æ–¹æ³•æˆ– catch æ–¹æ³•ç»“å°¾ï¼Œè¦æ˜¯æœ€åä¸€ä¸ªæ–¹æ³•æŠ›å‡ºé”™è¯¯ï¼Œéƒ½æœ‰å¯èƒ½æ— æ³•æ•æ‰åˆ°ï¼ˆå› ä¸º Promise å†…éƒ¨çš„é”™è¯¯ä¸ä¼šå†’æ³¡åˆ°å…¨å±€ï¼‰è¿™é‡Œæä¾›ä¸¤ç§æ€è·¯ï¼š</p>
<ul>
<li><p>æ‹“å±• Promise.prototype çš„æ–¹æ³•ï¼Œæ·»åŠ ä¸€ä¸ª done å‡½æ•°ï¼Œå°†é”™è¯¯æŠ›å‘å…¨å±€ã€‚</p>
<p>  window.onerror = (err) =&gt; {</p>
<pre><code>console.log(err);
</code></pre><p>  }<br>  Promise.prototype.done = function (onFulfilled, onRejected) {</p>
<pre><code>this.then(onFulfilled, onRejected)
  .catch(function (reason) {
    // æŠ›å‡ºä¸€ä¸ªå…¨å±€é”™è¯¯
    setTimeout(() =&gt; { throw reason }, 0);
  });
</code></pre><p>  };<br>  let promise = new Promise((resolve, reject) =&gt; {</p>
<pre><code>reject(&apos;Hello World&apos;)
</code></pre><p>  });</p>
<p>  promise.catch((err) =&gt; {</p>
<pre><code>throw(&apos;Unexpected Error&apos;);     // Uncaught Unexpected Error
</code></pre><p>  }).done()</p>
</li>
</ul>
<ul>
<li>åœ¨å…¨å±€æ·»åŠ  unhandledrejection äº‹ä»¶æ•è· Promise å¼‚å¸¸ã€‚</li>
</ul>
<p><img src="https://pic3.zhimg.com/v2-b512c7648df6d0d6fefb64d01009c175_b.jpg" alt=""></p>
<pre><code>window.addEventListener(&quot;unhandledrejection&quot;, (e) =&gt;{
    console.log(e.reason)
})    

let promise = new Promise((resolve, reject) =&gt; {
    reject(&apos;Hello World&apos;)
});

promise.catch((err) =&gt; {
    throw(&apos;Unexpected Error&apos;);     // Unexpected Error
})
</code></pre><h2 id="ä¸ƒã€æœªæ•è·çš„é”™è¯¯å¯ä»¥è¢«æ¢å¤"><a href="#ä¸ƒã€æœªæ•è·çš„é”™è¯¯å¯ä»¥è¢«æ¢å¤" class="headerlink" title="ä¸ƒã€æœªæ•è·çš„é”™è¯¯å¯ä»¥è¢«æ¢å¤"></a>ä¸ƒã€æœªæ•è·çš„é”™è¯¯å¯ä»¥è¢«æ¢å¤</h2><pre><code>let promise = new Promise((resolve, reject) =&gt; [
    reject(&apos;Hello world&apos;)
]).then(() =&gt; {
    console.log(&apos;resolve&apos;)
})

setTimeout(() =&gt; {
    promise.catch((e) =&gt; {
        console.log(e)
    }).then(() =&gt; {
        console.log(&apos;catch resolve&apos;)
    })
}, 1000)
</code></pre><h2 id="å…«ã€resolved-çŠ¶æ€çš„-Promise-ä¸ä¼šç«‹å³æ‰§è¡Œ"><a href="#å…«ã€resolved-çŠ¶æ€çš„-Promise-ä¸ä¼šç«‹å³æ‰§è¡Œ" class="headerlink" title="å…«ã€resolved çŠ¶æ€çš„ Promise ä¸ä¼šç«‹å³æ‰§è¡Œ"></a>å…«ã€resolved çŠ¶æ€çš„ Promise ä¸ä¼šç«‹å³æ‰§è¡Œ</h2><pre><code>let i = 0;
Promise.resolve(&apos;resolved promise&apos;).then(() =&gt; {
    i += 2
})
console.log(i)  // 0
</code></pre><p>å³ä½¿æ˜¯ resolve çš„ Promise è°ƒç”¨ then æ–¹æ³•ä¹Ÿæ˜¯å¼‚æ­¥æ‰§è¡Œã€‚</p>
<h2 id="ä¹ã€ç»“åˆ-async-await-ç¼–å†™åŒæ­¥ä»£ç "><a href="#ä¹ã€ç»“åˆ-async-await-ç¼–å†™åŒæ­¥ä»£ç " class="headerlink" title="ä¹ã€ç»“åˆ async/await ç¼–å†™åŒæ­¥ä»£ç "></a>ä¹ã€ç»“åˆ async/await ç¼–å†™åŒæ­¥ä»£ç </h2><ol>
<li>async/await å‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬å½»åº•æ‘†è„±å›è°ƒåœ°ç‹±çš„çƒ¦æ¼ï¼Œç”¨ä¸€ç§åŒæ­¥çš„æ–¹å¼æ¥ç¼–å†™å¼‚æ­¥å‡½æ•°ã€‚</li>
<li>await åé¢å¯ä»¥æ¥æ•°å€¼ï¼Œå¦‚æœæ˜¯å¼‚æ­¥è¯·æ±‚çš„è¯å¯ä»¥æ¥ Thunk å‡½æ•°å’Œ Promise å¯¹è±¡ã€‚</li>
</ol>
<p><img src="https://pic4.zhimg.com/v2-3ca5e16c6ba1743725cc92a7a8e5a7e2_b.jpg" alt=""></p>
<pre><code>const timeout = (ms) =&gt; {
    return new Promise((resolve) =&gt; {
        setTimeout(() =&gt; {
            resolve(ms + &apos; passed&apos;)
        }, ms)
    })
}

const asyncFunc =  async () =&gt; {
    const value1 = await timeout(2000)
    console.log(value1)
    const value2 = await timeout(2000)
    console.log(value2)
}

asyncFunc()
console.log(&apos;now&apos;)
</code></pre><h2 id="åã€è°ƒç”¨-then-æ–¹æ³•è¿”å›æ–°çš„-Promise-å¯¹è±¡"><a href="#åã€è°ƒç”¨-then-æ–¹æ³•è¿”å›æ–°çš„-Promise-å¯¹è±¡" class="headerlink" title="åã€è°ƒç”¨ then æ–¹æ³•è¿”å›æ–°çš„ Promise å¯¹è±¡"></a>åã€è°ƒç”¨ then æ–¹æ³•è¿”å›æ–°çš„ Promise å¯¹è±¡</h2><pre><code>let promise1 = new Promise((resolve) =&gt; {
    resolve(&apos;Hello world&apos;)
})

let promise2 = promise1.then()

console.log(promise1 === promise2)    // false
console.log(promise1 instanceof Promise)  // true
console.log(promise2 instanceof Promise)  // true
</code></pre><p>æ¯æ¬¡è°ƒç”¨ then æ–¹æ³•åéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œå¹¶ä¸æ˜¯è¿”å›åŸæœ¬çš„ Promise å¯¹è±¡ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/05/01/å®ç°ä¸€ä¸ª-Virtual-DOM-ç®—æ³•/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/05/01/å®ç°ä¸€ä¸ª-Virtual-DOM-ç®—æ³•/" itemprop="url">å®ç°ä¸€ä¸ª Virtual DOM ç®—æ³•[è½¬]</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-05-01T20:04:50+08:00">
                2017-05-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="virtual-domå¾ˆå¤šæ—¶å€™éƒ½ä¸æ˜¯æœ€ä¼˜çš„æ“ä½œï¼Œä½†å®ƒå…·æœ‰æ™®é€‚æ€§ï¼Œåœ¨æ•ˆç‡ã€å¯ç»´æŠ¤æ€§ä¹‹é—´è¾¾å¹³è¡¡ã€‚"><a href="#virtual-domå¾ˆå¤šæ—¶å€™éƒ½ä¸æ˜¯æœ€ä¼˜çš„æ“ä½œï¼Œä½†å®ƒå…·æœ‰æ™®é€‚æ€§ï¼Œåœ¨æ•ˆç‡ã€å¯ç»´æŠ¤æ€§ä¹‹é—´è¾¾å¹³è¡¡ã€‚" class="headerlink" title=" virtual domå¾ˆå¤šæ—¶å€™éƒ½ä¸æ˜¯æœ€ä¼˜çš„æ“ä½œï¼Œä½†å®ƒå…·æœ‰æ™®é€‚æ€§ï¼Œåœ¨æ•ˆç‡ã€å¯ç»´æŠ¤æ€§ä¹‹é—´è¾¾å¹³è¡¡ã€‚"></a><font color="#dd0000"><strong> virtual domå¾ˆå¤šæ—¶å€™éƒ½ä¸æ˜¯æœ€ä¼˜çš„æ“ä½œï¼Œä½†å®ƒå…·æœ‰æ™®é€‚æ€§ï¼Œåœ¨æ•ˆç‡ã€å¯ç»´æŠ¤æ€§ä¹‹é—´è¾¾å¹³è¡¡ã€‚</strong></font></h2><h2 id="ç›®å½•ï¼š"><a href="#ç›®å½•ï¼š" class="headerlink" title="ç›®å½•ï¼š"></a>ç›®å½•ï¼š</h2><ul>
<li>1 å‰è¨€</li>
<li>2 å¯¹å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç†æ€è€ƒ</li>
<li>3 Virtual DOM ç®—æ³•</li>
<li>4 ç®—æ³•å®ç°<ul>
<li>4.1 æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘</li>
<li>4.2 æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚</li>
<li>4.3 æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š</li>
</ul>
</li>
<li>5 ç»“è¯­</li>
<li>6 References</li>
</ul>
<h2 id="1-å‰è¨€"><a href="#1-å‰è¨€" class="headerlink" title="1 å‰è¨€"></a>1 å‰è¨€</h2><p>æœ¬æ–‡ä¼šåœ¨æ•™ä½ æ€ä¹ˆç”¨ 300~400 è¡Œä»£ç å®ç°ä¸€ä¸ªåŸºæœ¬çš„ Virtual DOM ç®—æ³•ï¼Œå¹¶ä¸”å°è¯•å°½é‡æŠŠ Virtual DOM çš„ç®—æ³•æ€è·¯é˜è¿°æ¸…æ¥šã€‚å¸Œæœ›åœ¨é˜…è¯»æœ¬æ–‡åï¼Œèƒ½è®©ä½ æ·±å…¥ç†è§£ Virtual DOM ç®—æ³•ï¼Œç»™ä½ ç°æœ‰å‰ç«¯çš„ç¼–ç¨‹æä¾›ä¸€äº›æ–°çš„æ€è€ƒã€‚</p>
<h2 id="2-å¯¹å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç†çš„æ€è€ƒ"><a href="#2-å¯¹å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç†çš„æ€è€ƒ" class="headerlink" title="2 å¯¹å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç†çš„æ€è€ƒ"></a>2 å¯¹å‰ç«¯åº”ç”¨çŠ¶æ€ç®¡ç†çš„æ€è€ƒ</h2><p>å‡å¦‚ç°åœ¨ä½ éœ€è¦å†™ä¸€ä¸ªåƒä¸‹é¢ä¸€æ ·çš„è¡¨æ ¼çš„åº”ç”¨ç¨‹åºï¼Œè¿™ä¸ªè¡¨æ ¼å¯ä»¥æ ¹æ®ä¸åŒçš„å­—æ®µè¿›è¡Œå‡åºæˆ–è€…é™åºçš„å±•ç¤ºã€‚<br> <img src="/2017/05/01/å®ç°ä¸€ä¸ª-Virtual-DOM-ç®—æ³•/1.png" alt=""><br>è¿™ä¸ªåº”ç”¨ç¨‹åºçœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½ å¯ä»¥æƒ³å‡ºå¥½å‡ ç§ä¸åŒçš„æ–¹å¼æ¥å†™ã€‚æœ€å®¹æ˜“æƒ³åˆ°çš„å¯èƒ½æ˜¯ï¼Œåœ¨ä½ çš„ JavaScript ä»£ç é‡Œé¢å­˜å‚¨è¿™æ ·çš„æ•°æ®ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var sortKey = &quot;new&quot; // æ’åºçš„å­—æ®µï¼Œæ–°å¢ï¼ˆnewï¼‰ã€å–æ¶ˆï¼ˆcancelï¼‰ã€å‡€å…³æ³¨ï¼ˆgainï¼‰ã€ç´¯ç§¯ï¼ˆcumulateï¼‰äººæ•°</span><br><span class="line">var sortType = 1 // å‡åºè¿˜æ˜¯é€†åº</span><br><span class="line">var data = [&#123;...&#125;, &#123;...&#125;, &#123;..&#125;, ..] // è¡¨æ ¼æ•°æ®</span><br></pre></td></tr></table></figure></p>
<p>ç”¨ä¸‰ä¸ªå­—æ®µåˆ†åˆ«å­˜å‚¨å½“å‰æ’åºçš„å­—æ®µã€æ’åºæ–¹å‘ã€è¿˜æœ‰è¡¨æ ¼æ•°æ®ï¼›ç„¶åç»™è¡¨æ ¼å¤´éƒ¨åŠ ç‚¹å‡»äº‹ä»¶ï¼šå½“ç”¨æˆ·ç‚¹å‡»ç‰¹å®šçš„å­—æ®µçš„æ—¶å€™ï¼Œæ ¹æ®ä¸Šé¢å‡ ä¸ªå­—æ®µå­˜å‚¨çš„å†…å®¹æ¥å¯¹å†…å®¹è¿›è¡Œæ’åºï¼Œç„¶åç”¨ JS æˆ–è€… jQuery æ“ä½œ DOMï¼Œæ›´æ–°é¡µé¢çš„æ’åºçŠ¶æ€ï¼ˆè¡¨å¤´çš„é‚£å‡ ä¸ªç®­å¤´è¡¨ç¤ºå½“å‰æ’åºçŠ¶æ€ï¼Œä¹Ÿéœ€è¦æ›´æ–°ï¼‰å’Œè¡¨æ ¼å†…å®¹ã€‚</p>
<p>è¿™æ ·åšä¼šå¯¼è‡´çš„åæœå°±æ˜¯ï¼Œéšç€åº”ç”¨ç¨‹åºè¶Šæ¥è¶Šå¤æ‚ï¼Œéœ€è¦åœ¨JSé‡Œé¢ç»´æŠ¤çš„å­—æ®µä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œéœ€è¦ç›‘å¬äº‹ä»¶å’Œåœ¨äº‹ä»¶å›è°ƒç”¨æ›´æ–°é¡µé¢çš„DOMæ“ä½œä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œåº”ç”¨ç¨‹åºä¼šå˜å¾—éå¸¸éš¾ç»´æŠ¤ã€‚åæ¥äººä»¬ä½¿ç”¨äº† MVCã€MVP çš„æ¶æ„æ¨¡å¼ï¼Œå¸Œæœ›èƒ½ä»ä»£ç ç»„ç»‡æ–¹å¼æ¥é™ä½ç»´æŠ¤è¿™ç§å¤æ‚åº”ç”¨ç¨‹åºçš„éš¾åº¦ã€‚ä½†æ˜¯ MVC æ¶æ„æ²¡åŠæ³•å‡å°‘ä½ æ‰€ç»´æŠ¤çš„çŠ¶æ€ï¼Œä¹Ÿæ²¡æœ‰é™ä½çŠ¶æ€æ›´æ–°ä½ éœ€è¦å¯¹é¡µé¢çš„æ›´æ–°æ“ä½œï¼ˆå‰ç«¯æ¥è¯´å°±æ˜¯DOMæ“ä½œï¼‰ï¼Œä½ éœ€è¦æ“ä½œçš„DOMè¿˜æ˜¯éœ€è¦æ“ä½œï¼Œåªæ˜¯æ¢äº†ä¸ªåœ°æ–¹ã€‚</p>
<p>æ—¢ç„¶çŠ¶æ€æ”¹å˜äº†è¦æ“ä½œç›¸åº”çš„DOMå…ƒç´ ï¼Œä¸ºä»€ä¹ˆä¸åšä¸€ä¸ªä¸œè¥¿å¯ä»¥è®©è§†å›¾å’ŒçŠ¶æ€è¿›è¡Œç»‘å®šï¼ŒçŠ¶æ€å˜æ›´äº†è§†å›¾è‡ªåŠ¨å˜æ›´ï¼Œå°±ä¸ç”¨æ‰‹åŠ¨æ›´æ–°é¡µé¢äº†ã€‚è¿™å°±æ˜¯åæ¥äººä»¬æƒ³å‡ºäº† MVVM æ¨¡å¼ï¼Œåªè¦åœ¨æ¨¡ç‰ˆä¸­å£°æ˜è§†å›¾ç»„ä»¶æ˜¯å’Œä»€ä¹ˆçŠ¶æ€è¿›è¡Œç»‘å®šçš„ï¼ŒåŒå‘ç»‘å®šå¼•æ“å°±ä¼šåœ¨çŠ¶æ€æ›´æ–°çš„æ—¶å€™è‡ªåŠ¨æ›´æ–°è§†å›¾ï¼ˆå…³äºMV*æ¨¡å¼çš„å†…å®¹ï¼Œå¯ä»¥çœ‹<a href="https://github.com/livoras/blog/issues/11" target="_blank" rel="noopener">è¿™ç¯‡ä»‹ç»</a>ï¼‰ã€‚</p>
<p>MVVM å¯ä»¥å¾ˆå¥½çš„é™ä½æˆ‘ä»¬ç»´æŠ¤çŠ¶æ€ -&gt; è§†å›¾çš„å¤æ‚ç¨‹åº¦ï¼ˆå¤§å¤§å‡å°‘ä»£ç ä¸­çš„è§†å›¾æ›´æ–°é€»è¾‘ï¼‰ã€‚ä½†æ˜¯è¿™ä¸æ˜¯å”¯ä¸€çš„åŠæ³•ï¼Œè¿˜æœ‰ä¸€ä¸ªéå¸¸ç›´è§‚çš„æ–¹æ³•ï¼Œå¯ä»¥å¤§å¤§é™ä½è§†å›¾æ›´æ–°çš„æ“ä½œï¼šä¸€æ—¦çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ï¼Œå°±ç”¨æ¨¡ç‰ˆå¼•æ“é‡æ–°æ¸²æŸ“<strong>æ•´ä¸ªè§†å›¾</strong>ï¼Œç„¶åç”¨æ–°çš„è§†å›¾æ›´æ¢æ‰æ—§çš„è§†å›¾ã€‚å°±åƒä¸Šé¢çš„è¡¨æ ¼ï¼Œå½“ç”¨æˆ·ç‚¹å‡»çš„æ—¶å€™ï¼Œè¿˜æ˜¯åœ¨JSé‡Œé¢æ›´æ–°çŠ¶æ€ï¼Œä½†æ˜¯é¡µé¢æ›´æ–°å°±ä¸ç”¨æ‰‹åŠ¨æ“ä½œ DOM äº†ï¼Œç›´æ¥æŠŠæ•´ä¸ªè¡¨æ ¼ç”¨æ¨¡ç‰ˆå¼•æ“é‡æ–°æ¸²æŸ“ä¸€éï¼Œç„¶åè®¾ç½®ä¸€ä¸‹<code>innerHTML</code>å°±å®Œäº‹äº†ã€‚</p>
<p>å¬åˆ°è¿™æ ·çš„åšæ³•ï¼Œç»éªŒä¸°å¯Œçš„ä½ ä¸€å®šç¬¬ä¸€æ—¶é—´æ„è¯†è¿™æ ·çš„åšæ³•ä¼šå¯¼è‡´å¾ˆå¤šçš„é—®é¢˜ã€‚æœ€å¤§çš„é—®é¢˜å°±æ˜¯è¿™æ ·åšä¼šå¾ˆæ…¢ï¼Œå› ä¸ºå³ä½¿ä¸€ä¸ªå°å°çš„çŠ¶æ€å˜æ›´éƒ½è¦é‡æ–°æ„é€ æ•´æ£µ DOMï¼Œæ€§ä»·æ¯”å¤ªä½ï¼›è€Œä¸”è¿™æ ·åšçš„è¯ï¼Œ<code>input</code>å’Œ<code>textarea</code>çš„ä¼šå¤±å»åŸæœ‰çš„ç„¦ç‚¹ã€‚æœ€åçš„ç»“è®ºä¼šæ˜¯ï¼šå¯¹äºå±€éƒ¨çš„å°è§†å›¾çš„æ›´æ–°ï¼Œæ²¡æœ‰é—®é¢˜ï¼ˆBackboneå°±æ˜¯è¿™ä¹ˆå¹²çš„ï¼‰ï¼›ä½†æ˜¯å¯¹äºå¤§å‹è§†å›¾ï¼Œå¦‚å…¨å±€åº”ç”¨çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œéœ€è¦æ›´æ–°é¡µé¢è¾ƒå¤šå±€éƒ¨è§†å›¾çš„æ—¶å€™ï¼Œè¿™æ ·çš„åšæ³•ä¸å¯å–ã€‚</p>
<p><strong>ä½†æ˜¯è¿™é‡Œè¦æ˜ç™½å’Œè®°ä½è¿™ç§åšæ³•</strong>ï¼Œå› ä¸ºåé¢ä½ ä¼šå‘ç°ï¼Œ<strong>å…¶å® Virtual DOM å°±æ˜¯è¿™ä¹ˆåšçš„ï¼Œåªæ˜¯åŠ äº†ä¸€äº›ç‰¹åˆ«çš„æ­¥éª¤æ¥é¿å…äº†æ•´æ£µ DOM æ ‘å˜æ›´</strong>ã€‚</p>
<p>å¦å¤–ä¸€ç‚¹éœ€è¦æ³¨æ„çš„å°±æ˜¯ï¼Œä¸Šé¢æä¾›çš„å‡ ç§æ–¹æ³•ï¼Œå…¶å®éƒ½åœ¨è§£å†³åŒä¸€ä¸ªé—®é¢˜ï¼š<strong>ç»´æŠ¤çŠ¶æ€ï¼Œæ›´æ–°è§†å›¾</strong>ã€‚åœ¨ä¸€èˆ¬çš„åº”ç”¨å½“ä¸­ï¼Œå¦‚æœèƒ½å¤Ÿå¾ˆå¥½æ–¹æ¡ˆæ¥åº”å¯¹è¿™ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆå°±å‡ ä¹é™ä½äº†å¤§éƒ¨åˆ†å¤æ‚æ€§ã€‚</p>
<h2 id="3-Virtual-DOMç®—æ³•"><a href="#3-Virtual-DOMç®—æ³•" class="headerlink" title="3 Virtual DOMç®—æ³•"></a>3 Virtual DOMç®—æ³•</h2><p>DOMæ˜¯å¾ˆæ…¢çš„ã€‚å¦‚æœæˆ‘ä»¬æŠŠä¸€ä¸ªç®€å•çš„<code>div</code>å…ƒç´ çš„å±æ€§éƒ½æ‰“å°å‡ºæ¥ï¼Œä½ ä¼šçœ‹åˆ°ï¼š<br> <img src="/2017/05/01/å®ç°ä¸€ä¸ª-Virtual-DOM-ç®—æ³•/2.png" alt=""><br>è€Œè¿™ä»…ä»…æ˜¯ç¬¬ä¸€å±‚ã€‚çœŸæ­£çš„ DOM å…ƒç´ éå¸¸åºå¤§ï¼Œè¿™æ˜¯å› ä¸ºæ ‡å‡†å°±æ˜¯è¿™ä¹ˆè®¾è®¡çš„ã€‚è€Œä¸”æ“ä½œå®ƒä»¬çš„æ—¶å€™ä½ è¦å°å¿ƒç¿¼ç¿¼ï¼Œè½»å¾®çš„è§¦ç¢°å¯èƒ½å°±ä¼šå¯¼è‡´é¡µé¢é‡æ’ï¼Œè¿™å¯æ˜¯æ€æ­»æ€§èƒ½çš„ç½ªé­ç¥¸é¦–ã€‚</p>
<p>ç›¸å¯¹äº DOM å¯¹è±¡ï¼ŒåŸç”Ÿçš„ JavaScript å¯¹è±¡å¤„ç†èµ·æ¥æ›´å¿«ï¼Œè€Œä¸”æ›´ç®€å•ã€‚DOM æ ‘ä¸Šçš„ç»“æ„ã€å±æ€§ä¿¡æ¯æˆ‘ä»¬éƒ½å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨ JavaScript å¯¹è±¡è¡¨ç¤ºå‡ºæ¥ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var element = &#123;</span><br><span class="line">  tagName:&apos;ul&apos;, // èŠ‚ç‚¹æ ‡ç­¾å</span><br><span class="line">  props: &#123; // DOMçš„å±æ€§ï¼Œç”¨ä¸€ä¸ªå¯¹è±¡å­˜å‚¨é”®å€¼å¯¹</span><br><span class="line">    id:&apos;list&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  children: [ // è¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹</span><br><span class="line">    &#123;tagName:&apos;li&apos;, props: &#123;class:&apos;item&apos;&#125;, children: [&quot;Item 1&quot;]&#125;,</span><br><span class="line">    &#123;tagName:&apos;li&apos;, props: &#123;class:&apos;item&apos;&#125;, children: [&quot;Item 2&quot;]&#125;,</span><br><span class="line">    &#123;tagName:&apos;li&apos;, props: &#123;class:&apos;item&apos;&#125;, children: [&quot;Item 3&quot;]&#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢å¯¹åº”çš„HTMLå†™æ³•æ˜¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ulid=&apos;list&apos;&gt;</span><br><span class="line">  &lt;liclass=&apos;item&apos;&gt;Item 1&lt;/li&gt;</span><br><span class="line">  &lt;liclass=&apos;item&apos;&gt;Item 2&lt;/li&gt;</span><br><span class="line">  &lt;liclass=&apos;item&apos;&gt;Item 3&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure></p>
<p>æ—¢ç„¶åŸæ¥ DOM æ ‘çš„ä¿¡æ¯éƒ½å¯ä»¥ç”¨ JavaScript å¯¹è±¡æ¥è¡¨ç¤ºï¼Œåè¿‡æ¥ï¼Œä½ å°±å¯ä»¥æ ¹æ®è¿™ä¸ªç”¨ JavaScript å¯¹è±¡è¡¨ç¤ºçš„æ ‘ç»“æ„æ¥æ„å»ºä¸€æ£µçœŸæ­£çš„DOMæ ‘ã€‚</p>
<p>ä¹‹å‰çš„ç« èŠ‚æ‰€è¯´çš„ï¼ŒçŠ¶æ€å˜æ›´-&gt;é‡æ–°æ¸²æŸ“æ•´ä¸ªè§†å›¾çš„æ–¹å¼å¯ä»¥ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼šç”¨ JavaScript å¯¹è±¡è¡¨ç¤º DOM ä¿¡æ¯å’Œç»“æ„ï¼Œå½“çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œé‡æ–°æ¸²æŸ“è¿™ä¸ª JavaScript çš„å¯¹è±¡ç»“æ„ã€‚å½“ç„¶è¿™æ ·åšå…¶å®æ²¡ä»€ä¹ˆåµç”¨ï¼Œå› ä¸ºçœŸæ­£çš„é¡µé¢å…¶å®æ²¡æœ‰æ”¹å˜ã€‚</p>
<p>ä½†æ˜¯å¯ä»¥ç”¨æ–°æ¸²æŸ“çš„å¯¹è±¡æ ‘å»å’Œæ—§çš„æ ‘è¿›è¡Œå¯¹æ¯”ï¼Œè®°å½•è¿™ä¸¤æ£µæ ‘å·®å¼‚ã€‚è®°å½•ä¸‹æ¥çš„ä¸åŒå°±æ˜¯æˆ‘ä»¬éœ€è¦å¯¹é¡µé¢çœŸæ­£çš„ DOM æ“ä½œï¼Œç„¶åæŠŠå®ƒä»¬åº”ç”¨åœ¨çœŸæ­£çš„ DOM æ ‘ä¸Šï¼Œé¡µé¢å°±å˜æ›´äº†ã€‚è¿™æ ·å°±å¯ä»¥åšåˆ°ï¼šè§†å›¾çš„ç»“æ„ç¡®å®æ˜¯æ•´ä¸ªå…¨æ–°æ¸²æŸ“äº†ï¼Œä½†æ˜¯æœ€åæ“ä½œDOMçš„æ—¶å€™ç¡®å®åªå˜æ›´æœ‰ä¸åŒçš„åœ°æ–¹ã€‚</p>
<p>è¿™å°±æ˜¯æ‰€è°“çš„ Virtual DOM ç®—æ³•ã€‚åŒ…æ‹¬å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>ç”¨ JavaScript å¯¹è±¡ç»“æ„è¡¨ç¤º DOM æ ‘çš„ç»“æ„ï¼›ç„¶åç”¨è¿™ä¸ªæ ‘æ„å»ºä¸€ä¸ªçœŸæ­£çš„ DOM æ ‘ï¼Œæ’åˆ°æ–‡æ¡£å½“ä¸­</li>
<li>å½“çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œé‡æ–°æ„é€ ä¸€æ£µæ–°çš„å¯¹è±¡æ ‘ã€‚ç„¶åç”¨æ–°çš„æ ‘å’Œæ—§çš„æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œè®°å½•ä¸¤æ£µæ ‘å·®å¼‚</li>
<li>æŠŠ2æ‰€è®°å½•çš„å·®å¼‚åº”ç”¨åˆ°æ­¥éª¤1æ‰€æ„å»ºçš„çœŸæ­£çš„DOMæ ‘ä¸Šï¼Œè§†å›¾å°±æ›´æ–°äº†</li>
</ol>
<p>Virtual DOM æœ¬è´¨ä¸Šå°±æ˜¯åœ¨ JS å’Œ DOM ä¹‹é—´åšäº†ä¸€ä¸ªç¼“å­˜ã€‚å¯ä»¥ç±»æ¯” CPU å’Œç¡¬ç›˜ï¼Œæ—¢ç„¶ç¡¬ç›˜è¿™ä¹ˆæ…¢ï¼Œæˆ‘ä»¬å°±åœ¨å®ƒä»¬ä¹‹é—´åŠ ä¸ªç¼“å­˜ï¼šæ—¢ç„¶ DOM è¿™ä¹ˆæ…¢ï¼Œæˆ‘ä»¬å°±åœ¨å®ƒä»¬ JS å’Œ DOM ä¹‹é—´åŠ ä¸ªç¼“å­˜ã€‚CPUï¼ˆJSï¼‰åªæ“ä½œå†…å­˜ï¼ˆVirtual DOMï¼‰ï¼Œæœ€åçš„æ—¶å€™å†æŠŠå˜æ›´å†™å…¥ç¡¬ç›˜ï¼ˆDOMï¼‰ã€‚</p>
<h2 id="4-ç®—æ³•å®ç°"><a href="#4-ç®—æ³•å®ç°" class="headerlink" title="4 ç®—æ³•å®ç°"></a>4 ç®—æ³•å®ç°</h2><h3 id="4-1-æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘"><a href="#4-1-æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘" class="headerlink" title="4.1 æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘"></a>4.1 æ­¥éª¤ä¸€ï¼šç”¨JSå¯¹è±¡æ¨¡æ‹ŸDOMæ ‘</h3><p>ç”¨ JavaScript æ¥è¡¨ç¤ºä¸€ä¸ª DOM èŠ‚ç‚¹æ˜¯å¾ˆç®€å•çš„äº‹æƒ…ï¼Œä½ åªéœ€è¦è®°å½•å®ƒçš„èŠ‚ç‚¹ç±»å‹ã€å±æ€§ï¼Œè¿˜æœ‰å­èŠ‚ç‚¹ï¼š</p>
<p>element.js<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">functionElement (tagName, props, children) &#123;</span><br><span class="line">  this.tagName= tagName</span><br><span class="line">  this.props= props</span><br><span class="line">  this.children= children</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports=function (tagName, props, children) &#123;</span><br><span class="line">  returnnewElement(tagName, props, children)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¾‹å¦‚ä¸Šé¢çš„ DOM ç»“æ„å°±å¯ä»¥ç®€å•çš„è¡¨ç¤ºï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var el =require(&apos;./element&apos;)</span><br><span class="line"></span><br><span class="line">var ul =el(&apos;ul&apos;, &#123;id:&apos;list&apos;&#125;, [</span><br><span class="line">  el(&apos;li&apos;, &#123;class:&apos;item&apos;&#125;, [&apos;Item 1&apos;]),</span><br><span class="line">  el(&apos;li&apos;, &#123;class:&apos;item&apos;&#125;, [&apos;Item 2&apos;]),</span><br><span class="line">  el(&apos;li&apos;, &#123;class:&apos;item&apos;&#125;, [&apos;Item 3&apos;])</span><br><span class="line">])</span><br></pre></td></tr></table></figure></p>
<p>ç°åœ¨<code>ul</code>åªæ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡è¡¨ç¤ºçš„ DOM ç»“æ„ï¼Œé¡µé¢ä¸Šå¹¶æ²¡æœ‰è¿™ä¸ªç»“æ„ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ª<code>ul</code>æ„å»ºçœŸæ­£çš„<code>&lt;ul&gt;</code>ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Element.prototype.render=function () &#123;</span><br><span class="line">  var el =document.createElement(this.tagName) // æ ¹æ®tagNameæ„å»ºvar props =this.propsfor (var propName in props) &#123; // è®¾ç½®èŠ‚ç‚¹çš„DOMå±æ€§var propValue = props[propName]</span><br><span class="line">    el.setAttribute(propName, propValue)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  var children =this.children|| []</span><br><span class="line"></span><br><span class="line">  children.forEach(function (child) &#123;</span><br><span class="line">    var childEl = (child instanceofElement)</span><br><span class="line">      ?child.render() // å¦‚æœå­èŠ‚ç‚¹ä¹Ÿæ˜¯è™šæ‹ŸDOMï¼Œé€’å½’æ„å»ºDOMèŠ‚ç‚¹:document.createTextNode(child) // å¦‚æœå­—ç¬¦ä¸²ï¼Œåªæ„å»ºæ–‡æœ¬èŠ‚ç‚¹el.appendChild(childEl)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  return el</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>render</code>æ–¹æ³•ä¼šæ ¹æ®<code>tagName</code>æ„å»ºä¸€ä¸ªçœŸæ­£çš„DOMèŠ‚ç‚¹ï¼Œç„¶åè®¾ç½®è¿™ä¸ªèŠ‚ç‚¹çš„å±æ€§ï¼Œæœ€åé€’å½’åœ°æŠŠè‡ªå·±çš„å­èŠ‚ç‚¹ä¹Ÿæ„å»ºèµ·æ¥ã€‚æ‰€ä»¥åªéœ€è¦ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var ulRoot =ul.render()</span><br><span class="line">document.body.appendChild(ulRoot)</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„<code>ulRoot</code>æ˜¯çœŸæ­£çš„DOMèŠ‚ç‚¹ï¼ŒæŠŠå®ƒå¡å…¥æ–‡æ¡£ä¸­ï¼Œè¿™æ ·<code>body</code>é‡Œé¢å°±æœ‰äº†çœŸæ­£çš„<code>&lt;ul&gt;</code>çš„DOMç»“æ„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ulid=&apos;list&apos;&gt;</span><br><span class="line">  &lt;liclass=&apos;item&apos;&gt;Item 1&lt;/li&gt;</span><br><span class="line">  &lt;liclass=&apos;item&apos;&gt;Item 2&lt;/li&gt;</span><br><span class="line">  &lt;liclass=&apos;item&apos;&gt;Item 3&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure></p>
<p>å®Œæ•´ä»£ç å¯è§ <a href="https://github.com/livoras/simple-virtual-dom/blob/master/lib/element.js" target="_blank" rel="noopener">element.js</a>ã€‚</p>
<h3 id="4-2-æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚"><a href="#4-2-æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚" class="headerlink" title="4.2 æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚"></a>4.2 æ­¥éª¤äºŒï¼šæ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„å·®å¼‚</h3><p>æ­£å¦‚ä½ æ‰€é¢„æ–™çš„ï¼Œæ¯”è¾ƒä¸¤æ£µDOMæ ‘çš„å·®å¼‚æ˜¯ Virtual DOM ç®—æ³•æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œè¿™ä¹Ÿæ˜¯æ‰€è°“çš„ Virtual DOM çš„ diff ç®—æ³•ã€‚ä¸¤ä¸ªæ ‘çš„å®Œå…¨çš„ diff ç®—æ³•æ˜¯ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O(n^3) çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨å‰ç«¯å½“ä¸­ï¼Œä½ å¾ˆå°‘ä¼šè·¨è¶Šå±‚çº§åœ°ç§»åŠ¨DOMå…ƒç´ ã€‚æ‰€ä»¥ Virtual DOM åªä¼šå¯¹åŒä¸€ä¸ªå±‚çº§çš„å…ƒç´ è¿›è¡Œå¯¹æ¯”ï¼š<br> <img src="/2017/05/01/å®ç°ä¸€ä¸ª-Virtual-DOM-ç®—æ³•/3.png" alt=""><br>ä¸Šé¢çš„<code>div</code>åªä¼šå’ŒåŒä¸€å±‚çº§çš„<code>div</code>å¯¹æ¯”ï¼Œç¬¬äºŒå±‚çº§çš„åªä¼šè·Ÿç¬¬äºŒå±‚çº§å¯¹æ¯”ã€‚è¿™æ ·ç®—æ³•å¤æ‚åº¦å°±å¯ä»¥è¾¾åˆ° O(n)ã€‚</p>
<h4 id="4-2-1-æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚"><a href="#4-2-1-æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚" class="headerlink" title="4.2.1 æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚"></a>4.2.1 æ·±åº¦ä¼˜å…ˆéå†ï¼Œè®°å½•å·®å¼‚</h4><p>åœ¨å®é™…çš„ä»£ç ä¸­ï¼Œä¼šå¯¹æ–°æ—§ä¸¤æ£µæ ‘è¿›è¡Œä¸€ä¸ªæ·±åº¦ä¼˜å…ˆçš„éå†ï¼Œè¿™æ ·æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è®°ï¼š</p>
<p> <img src="/2017/05/01/å®ç°ä¸€ä¸ª-Virtual-DOM-ç®—æ³•/4.png" alt=""></p>
<p>åœ¨æ·±åº¦ä¼˜å…ˆéå†çš„æ—¶å€™ï¼Œæ¯éå†åˆ°ä¸€ä¸ªèŠ‚ç‚¹å°±æŠŠè¯¥èŠ‚ç‚¹å’Œæ–°çš„çš„æ ‘è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœæœ‰å·®å¼‚çš„è¯å°±è®°å½•åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// diff å‡½æ•°ï¼Œå¯¹æ¯”ä¸¤æ£µæ ‘functiondiff (oldTree, newTree) &#123;</span><br><span class="line">  var index =0// å½“å‰èŠ‚ç‚¹çš„æ ‡å¿—var patches = &#123;&#125; // ç”¨æ¥è®°å½•æ¯ä¸ªèŠ‚ç‚¹å·®å¼‚çš„å¯¹è±¡dfsWalk(oldTree, newTree, index, patches)</span><br><span class="line">  return patches</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// å¯¹ä¸¤æ£µæ ‘è¿›è¡Œæ·±åº¦ä¼˜å…ˆéå†functiondfsWalk (oldNode, newNode, index, patches) &#123;</span><br><span class="line">  // å¯¹æ¯”oldNodeå’ŒnewNodeçš„ä¸åŒï¼Œè®°å½•ä¸‹æ¥</span><br><span class="line">  patches[index] = [...]</span><br><span class="line"></span><br><span class="line">  diffChildren(oldNode.children, newNode.children, index, patches)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// éå†å­èŠ‚ç‚¹functiondiffChildren (oldChildren, newChildren, index, patches) &#123;</span><br><span class="line">  var leftNode =nullvar currentNodeIndex = index</span><br><span class="line">  oldChildren.forEach(function (child, i) &#123;</span><br><span class="line">    var newChild = newChildren[i]</span><br><span class="line">    currentNodeIndex = (leftNode &amp;&amp;leftNode.count) // è®¡ç®—èŠ‚ç‚¹çš„æ ‡è¯†? currentNodeIndex +leftNode.count+1: currentNodeIndex +1dfsWalk(child, newChild, currentNodeIndex, patches) // æ·±åº¦éå†å­èŠ‚ç‚¹</span><br><span class="line">    leftNode = child</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¾‹å¦‚ï¼Œä¸Šé¢çš„<code>div</code>å’Œæ–°çš„<code>div</code>æœ‰å·®å¼‚ï¼Œå½“å‰çš„æ ‡è®°æ˜¯0ï¼Œé‚£ä¹ˆï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">patches[0] = [&#123;difference&#125;, &#123;difference&#125;, ...] // ç”¨æ•°ç»„å­˜å‚¨æ–°æ—§èŠ‚ç‚¹çš„ä¸åŒ</span><br></pre></td></tr></table></figure></p>
<p>åŒç†<code>p</code>æ˜¯<code>patches[1]</code>ï¼Œ<code>ul</code>æ˜¯<code>patches[3]</code>ï¼Œç±»æ¨ã€‚</p>
<h4 id="4-2-2-å·®å¼‚ç±»å‹"><a href="#4-2-2-å·®å¼‚ç±»å‹" class="headerlink" title="4.2.2 å·®å¼‚ç±»å‹"></a>4.2.2 å·®å¼‚ç±»å‹</h4><p>ä¸Šé¢è¯´çš„èŠ‚ç‚¹çš„å·®å¼‚æŒ‡çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¯¹ DOM æ“ä½œå¯èƒ½ä¼šï¼š</p>
<ol>
<li>æ›¿æ¢æ‰åŸæ¥çš„èŠ‚ç‚¹ï¼Œä¾‹å¦‚æŠŠä¸Šé¢çš„<code>div</code>æ¢æˆäº†<code>section</code></li>
<li>ç§»åŠ¨ã€åˆ é™¤ã€æ–°å¢å­èŠ‚ç‚¹ï¼Œä¾‹å¦‚ä¸Šé¢<code>div</code>çš„å­èŠ‚ç‚¹ï¼ŒæŠŠ<code>p</code>å’Œ<code>ul</code>é¡ºåºäº’æ¢</li>
<li>ä¿®æ”¹äº†èŠ‚ç‚¹çš„å±æ€§</li>
<li>å¯¹äºæ–‡æœ¬èŠ‚ç‚¹ï¼Œæ–‡æœ¬å†…å®¹å¯èƒ½ä¼šæ”¹å˜ã€‚ä¾‹å¦‚ä¿®æ”¹ä¸Šé¢çš„æ–‡æœ¬èŠ‚ç‚¹2å†…å®¹ä¸º<code>Virtual DOM 2</code>ã€‚</li>
</ol>
<p>æ‰€ä»¥æˆ‘ä»¬å®šä¹‰äº†å‡ ç§å·®å¼‚ç±»å‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var REPLACE = 0</span><br><span class="line">var REORDER = 1</span><br><span class="line">var PROPS = 2</span><br><span class="line">var TEXT = 3</span><br></pre></td></tr></table></figure></p>
<p>å¯¹äºèŠ‚ç‚¹æ›¿æ¢ï¼Œå¾ˆç®€å•ã€‚åˆ¤æ–­æ–°æ—§èŠ‚ç‚¹çš„<code>tagName</code>å’Œæ˜¯ä¸æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä¸ä¸€æ ·çš„è¯´æ˜éœ€è¦æ›¿æ¢æ‰ã€‚å¦‚<code>div</code>æ¢æˆ<code>section</code>ï¼Œå°±è®°å½•ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">patches[0] = [&#123;</span><br><span class="line">  type:REPALCE,</span><br><span class="line">  node: newNode // el(&apos;section&apos;, props, children)</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœç»™<code>div</code>æ–°å¢äº†å±æ€§<code>id</code>ä¸º<code>container</code>ï¼Œå°±è®°å½•ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">patches[0] = [&#123;</span><br><span class="line">  type:REPALCE,</span><br><span class="line">  node: newNode // el(&apos;section&apos;, props, children)</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  type:PROPS,</span><br><span class="line">  props: &#123;</span><br><span class="line">    id:&quot;container&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure></p>
<p>å¦‚æœæ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¦‚ä¸Šé¢çš„æ–‡æœ¬èŠ‚ç‚¹2ï¼Œå°±è®°å½•ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">patches[2] = [&#123;</span><br><span class="line">  type:TEXT,</span><br><span class="line">  content:&quot;Virtual DOM2&quot;</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure></p>
<p>é‚£å¦‚æœæŠŠæˆ‘<code>div</code>çš„å­èŠ‚ç‚¹é‡æ–°æ’åºå‘¢ï¼Ÿä¾‹å¦‚<code>p, ul, div</code>çš„é¡ºåºæ¢æˆäº†<code>div, p, ul</code>ã€‚è¿™ä¸ªè¯¥æ€ä¹ˆå¯¹æ¯”ï¼Ÿå¦‚æœæŒ‰ç…§åŒå±‚çº§è¿›è¡Œé¡ºåºå¯¹æ¯”çš„è¯ï¼Œå®ƒä»¬éƒ½ä¼šè¢«æ›¿æ¢æ‰ã€‚å¦‚<code>p</code>å’Œ<code>div</code>çš„<code>tagName</code>ä¸åŒï¼Œ<code>p</code>ä¼šè¢«<code>div</code>æ‰€æ›¿ä»£ã€‚æœ€ç»ˆï¼Œä¸‰ä¸ªèŠ‚ç‚¹éƒ½ä¼šè¢«æ›¿æ¢ï¼Œè¿™æ ·DOMå¼€é”€å°±éå¸¸å¤§ã€‚è€Œå®é™…ä¸Šæ˜¯ä¸éœ€è¦æ›¿æ¢èŠ‚ç‚¹ï¼Œè€Œåªéœ€è¦ç»è¿‡èŠ‚ç‚¹ç§»åŠ¨å°±å¯ä»¥è¾¾åˆ°ï¼Œæˆ‘ä»¬åªéœ€çŸ¥é“æ€ä¹ˆè¿›è¡Œç§»åŠ¨ã€‚</p>
<p>è¿™ç‰µæ¶‰åˆ°ä¸¤ä¸ªåˆ—è¡¨çš„å¯¹æ¯”ç®—æ³•ï¼Œéœ€è¦å¦å¤–èµ·ä¸€ä¸ªå°èŠ‚æ¥è®¨è®ºã€‚</p>
<h4 id="4-2-3-åˆ—è¡¨å¯¹æ¯”ç®—æ³•"><a href="#4-2-3-åˆ—è¡¨å¯¹æ¯”ç®—æ³•" class="headerlink" title="4.2.3 åˆ—è¡¨å¯¹æ¯”ç®—æ³•"></a>4.2.3 åˆ—è¡¨å¯¹æ¯”ç®—æ³•</h4><p>å‡è®¾ç°åœ¨å¯ä»¥è‹±æ–‡å­—æ¯å”¯ä¸€åœ°æ ‡è¯†æ¯ä¸€ä¸ªå­èŠ‚ç‚¹ï¼š<br>æ—§çš„èŠ‚ç‚¹é¡ºåºï¼š</p>
<pre><code>a b c d e f g h i
</code></pre><p>ç°åœ¨å¯¹èŠ‚ç‚¹è¿›è¡Œäº†åˆ é™¤ã€æ’å…¥ã€ç§»åŠ¨çš„æ“ä½œã€‚æ–°å¢<code>j</code>èŠ‚ç‚¹ï¼Œåˆ é™¤<code>e</code>èŠ‚ç‚¹ï¼Œç§»åŠ¨<code>h</code>èŠ‚ç‚¹ï¼š<br>æ–°çš„èŠ‚ç‚¹é¡ºåºï¼š</p>
<pre><code>a b c h d f g i j
</code></pre><p>ç°åœ¨çŸ¥é“äº†æ–°æ—§çš„é¡ºåºï¼Œæ±‚æœ€å°çš„æ’å…¥ã€åˆ é™¤æ“ä½œï¼ˆç§»åŠ¨å¯ä»¥çœ‹æˆæ˜¯åˆ é™¤å’Œæ’å…¥æ“ä½œçš„ç»“åˆï¼‰ã€‚è¿™ä¸ªé—®é¢˜æŠ½è±¡å‡ºæ¥å…¶å®æ˜¯å­—ç¬¦ä¸²çš„æœ€å°ç¼–è¾‘è·ç¦»é—®é¢˜ï¼ˆ<a href="https://en.wikipedia.org/wiki/Edit_distance" target="_blank" rel="noopener">Edition Distance</a>ï¼‰ï¼Œæœ€å¸¸è§çš„è§£å†³ç®—æ³•æ˜¯ <a href="https://en.wikipedia.org/wiki/Levenshtein_distance" target="_blank" rel="noopener">Levenshtein Distance</a>ï¼Œé€šè¿‡åŠ¨æ€è§„åˆ’æ±‚è§£ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(M * N)ã€‚ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸éœ€è¦çœŸçš„è¾¾åˆ°æœ€å°çš„æ“ä½œï¼Œæˆ‘ä»¬åªéœ€è¦ä¼˜åŒ–ä¸€äº›æ¯”è¾ƒå¸¸è§çš„ç§»åŠ¨æƒ…å†µï¼Œç‰ºç‰²ä¸€å®šDOMæ“ä½œï¼Œè®©ç®—æ³•æ—¶é—´å¤æ‚åº¦è¾¾åˆ°çº¿æ€§çš„ï¼ˆO(max(M, N))ã€‚å…·ä½“ç®—æ³•ç»†èŠ‚æ¯”è¾ƒå¤šï¼Œè¿™é‡Œä¸ç´¯è¿°ï¼Œæœ‰å…´è¶£å¯ä»¥å‚è€ƒ<a href="https://github.com/livoras/list-diff/blob/master/lib/diff.js" target="_blank" rel="noopener">ä»£ç </a>ã€‚</p>
<p>æˆ‘ä»¬èƒ½å¤Ÿè·å–åˆ°æŸä¸ªçˆ¶èŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„æ“ä½œï¼Œå°±å¯ä»¥è®°å½•ä¸‹æ¥ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">patches[0] = [&#123;</span><br><span class="line">  type:REORDER,</span><br><span class="line">  moves: [&#123;remove or insert&#125;, &#123;remove or insert&#125;, ...]</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸º<code>tagName</code>æ˜¯å¯é‡å¤çš„ï¼Œä¸èƒ½ç”¨è¿™ä¸ªæ¥è¿›è¡Œå¯¹æ¯”ã€‚æ‰€ä»¥éœ€è¦ç»™å­èŠ‚ç‚¹åŠ ä¸Šå”¯ä¸€æ ‡è¯†<code>key</code>ï¼Œåˆ—è¡¨å¯¹æ¯”çš„æ—¶å€™ï¼Œä½¿ç”¨<code>key</code>è¿›è¡Œå¯¹æ¯”ï¼Œè¿™æ ·æ‰èƒ½å¤ç”¨è€çš„ DOM æ ‘ä¸Šçš„èŠ‚ç‚¹ã€‚</p>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡æ·±åº¦ä¼˜å…ˆéå†ä¸¤æ£µæ ‘ï¼Œæ¯å±‚çš„èŠ‚ç‚¹è¿›è¡Œå¯¹æ¯”ï¼Œè®°å½•ä¸‹æ¯ä¸ªèŠ‚ç‚¹çš„å·®å¼‚äº†ã€‚å®Œæ•´ diff ç®—æ³•ä»£ç å¯è§ <a href="https://github.com/livoras/simple-virtual-dom/blob/master/lib/diff.js" target="_blank" rel="noopener">diff.js</a>ã€‚</p>
<h3 id="4-3-æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š"><a href="#4-3-æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š" class="headerlink" title="4.3 æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š"></a>4.3 æ­¥éª¤ä¸‰ï¼šæŠŠå·®å¼‚åº”ç”¨åˆ°çœŸæ­£çš„DOMæ ‘ä¸Š</h3><p>å› ä¸ºæ­¥éª¤ä¸€æ‰€æ„å»ºçš„ JavaScript å¯¹è±¡æ ‘å’Œ<code>render</code>å‡ºæ¥çœŸæ­£çš„DOMæ ‘çš„ä¿¡æ¯ã€ç»“æ„æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹é‚£æ£µDOMæ ‘ä¹Ÿè¿›è¡Œæ·±åº¦ä¼˜å…ˆçš„éå†ï¼Œéå†çš„æ—¶å€™ä»æ­¥éª¤äºŒç”Ÿæˆçš„<code>patches</code>å¯¹è±¡ä¸­æ‰¾å‡ºå½“å‰éå†çš„èŠ‚ç‚¹å·®å¼‚ï¼Œç„¶åè¿›è¡Œ DOM æ“ä½œã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">functionpatch (node, patches) &#123;</span><br><span class="line">  var walker = &#123;index:0&#125;</span><br><span class="line">  dfsWalk(node, walker, patches)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">functiondfsWalk (node, walker, patches) &#123;</span><br><span class="line">  var currentPatches = patches[walker.index] // ä»patchesæ‹¿å‡ºå½“å‰èŠ‚ç‚¹çš„å·®å¼‚var len =node.childNodes?node.childNodes.length:0for (var i =0; i &lt; len; i++) &#123; // æ·±åº¦éå†å­èŠ‚ç‚¹var child =node.childNodes[i]</span><br><span class="line">    walker.index++dfsWalk(child, walker, patches)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (currentPatches) &#123;</span><br><span class="line">    applyPatches(node, currentPatches) // å¯¹å½“å‰èŠ‚ç‚¹è¿›è¡ŒDOMæ“ä½œ</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>applyPatchesï¼Œæ ¹æ®ä¸åŒç±»å‹çš„å·®å¼‚å¯¹å½“å‰èŠ‚ç‚¹è¿›è¡Œ DOM æ“ä½œï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">functionapplyPatches (node, currentPatches) &#123;</span><br><span class="line">  currentPatches.forEach(function (currentPatch) &#123;</span><br><span class="line">    switch (currentPatch.type) &#123;</span><br><span class="line">      caseREPLACE:</span><br><span class="line">        node.parentNode.replaceChild(currentPatch.node.render(), node)</span><br><span class="line">        breakcaseREORDER:</span><br><span class="line">        reorderChildren(node, currentPatch.moves)</span><br><span class="line">        breakcasePROPS:</span><br><span class="line">        setProps(node, currentPatch.props)</span><br><span class="line">        breakcaseTEXT:</span><br><span class="line">        node.textContent=currentPatch.contentbreakdefault:</span><br><span class="line">        thrownewError(&apos;Unknown patch type &apos;+currentPatch.type)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å®Œæ•´ä»£ç å¯è§ <a href="https://github.com/livoras/simple-virtual-dom/blob/master/lib/patch.js" target="_blank" rel="noopener">patch.js</a>ã€‚</p>
<h2 id="5-ç»“è¯­"><a href="#5-ç»“è¯­" class="headerlink" title="5 ç»“è¯­"></a>5 ç»“è¯­</h2><p>Virtual DOM ç®—æ³•ä¸»è¦æ˜¯å®ç°ä¸Šé¢æ­¥éª¤çš„ä¸‰ä¸ªå‡½æ•°ï¼š<a href="https://github.com/livoras/simple-virtual-dom/blob/master/lib/element.js" target="_blank" rel="noopener">element</a>ï¼Œ<a href="https://github.com/livoras/simple-virtual-dom/blob/master/lib/diff.js" target="_blank" rel="noopener">diff</a>ï¼Œ<a href="https://github.com/livoras/simple-virtual-dom/blob/master/lib/patch.js" target="_blank" rel="noopener">patch</a>ã€‚ç„¶åå°±å¯ä»¥å®é™…çš„è¿›è¡Œä½¿ç”¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// 1. æ„å»ºè™šæ‹ŸDOM</span><br><span class="line">var tree =el(&apos;div&apos;, &#123;&apos;id&apos;:&apos;container&apos;&#125;, [</span><br><span class="line">    el(&apos;h1&apos;, &#123;style:&apos;color: blue&apos;&#125;, [&apos;simple virtal dom&apos;]),</span><br><span class="line">    el(&apos;p&apos;, [&apos;Hello, virtual-dom&apos;]),</span><br><span class="line">    el(&apos;ul&apos;, [el(&apos;li&apos;)])</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">// 2. é€šè¿‡è™šæ‹ŸDOMæ„å»ºçœŸæ­£çš„DOM</span><br><span class="line">var root =tree.render()</span><br><span class="line">document.body.appendChild(root)</span><br><span class="line"></span><br><span class="line">// 3. ç”Ÿæˆæ–°çš„è™šæ‹ŸDOMvar newTree =el(&apos;div&apos;, &#123;&apos;id&apos;:&apos;container&apos;&#125;, [</span><br><span class="line">    el(&apos;h1&apos;, &#123;style:&apos;color: red&apos;&#125;, [&apos;simple virtal dom&apos;]),</span><br><span class="line">    el(&apos;p&apos;, [&apos;Hello, virtual-dom&apos;]),</span><br><span class="line">    el(&apos;ul&apos;, [el(&apos;li&apos;), el(&apos;li&apos;)])</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">// 4. æ¯”è¾ƒä¸¤æ£µè™šæ‹ŸDOMæ ‘çš„ä¸åŒ</span><br><span class="line">var patches =diff(tree, newTree)</span><br><span class="line"></span><br><span class="line">// 5. åœ¨çœŸæ­£çš„DOMå…ƒç´ ä¸Šåº”ç”¨å˜æ›´</span><br><span class="line">patch(root, patches)</span><br></pre></td></tr></table></figure></p>
<p>å½“ç„¶è¿™æ˜¯éå¸¸ç²—ç³™çš„å®è·µï¼Œå®é™…ä¸­è¿˜éœ€è¦å¤„ç†äº‹ä»¶ç›‘å¬ç­‰ï¼›ç”Ÿæˆè™šæ‹Ÿ DOM çš„æ—¶å€™ä¹Ÿå¯ä»¥åŠ å…¥ JSX è¯­æ³•ã€‚è¿™äº›äº‹æƒ…éƒ½åšäº†çš„è¯ï¼Œå°±å¯ä»¥æ„é€ ä¸€ä¸ªç®€å•çš„ReactJSäº†ã€‚</p>
<p>æœ¬æ–‡æ‰€å®ç°çš„å®Œæ•´ä»£ç å­˜æ”¾åœ¨ <a href="https://github.com/livoras/simple-virtual-dom" target="_blank" rel="noopener">Github</a>ï¼Œä»…ä¾›å­¦ä¹ ã€‚</p>
<p>æœ¬æ–‡æ‰€å®ç°çš„å®Œæ•´ä»£ç å­˜æ”¾åœ¨ <a href="https://github.com/livoras/simple-virtual-dom" target="_blank" rel="noopener">Github</a>ã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/23/Vueè‡ªé€‚åº”æ»šåŠ¨æ¡è§¦åº•æ›´æ–°/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/23/Vueè‡ªé€‚åº”æ»šåŠ¨æ¡è§¦åº•æ›´æ–°/" itemprop="url">Vueè‡ªé€‚åº”æ»šåŠ¨æ¡è§¦åº•æ›´æ–°</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-04-23T22:18:26+08:00">
                2017-04-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/2017/04/23/Vueè‡ªé€‚åº”æ»šåŠ¨æ¡è§¦åº•æ›´æ–°/1.jpg" alt=""></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div id=<span class="string">"box"</span>&gt;</span><br><span class="line">		&lt;scrollbar @bottom=<span class="string">"bottom"</span> @top=<span class="string">"top"</span> :changeTop.sync=<span class="string">"changeTop"</span>&gt;</span><br><span class="line">			&lt;div id=<span class="string">"container"</span>&gt;</span><br><span class="line">				&lt;p&gt;Vueè‡ªå®šä¹‰æ»šåŠ¨æ¡&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">				&lt;p v-for="n in 30"&gt;è‡ªå®šä¹‰æ»šåŠ¨æ¡&#123;&#123;n&#125;&#125;&lt;/</span>p&gt;</span><br><span class="line">				&lt;div v-<span class="keyword">for</span>=<span class="string">"(str,index) in data"</span>&gt;add data-&#123;&#123;str&#125;&#125;-&#123;&#123;index&#125;&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">			&lt;/</span>div&gt;</span><br><span class="line">		&lt;<span class="regexp">/scrollbar&gt;</span></span><br><span class="line"><span class="regexp">		&lt;div id="loadingbox" v-show="isloading"&gt;loading...&lt;/</span>div&gt;</span><br><span class="line">	&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">	<span class="keyword">import</span> scrollbar <span class="keyword">from</span> <span class="string">'./4'</span></span><br><span class="line">	<span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">		components: &#123;</span><br><span class="line">			scrollbar</span><br><span class="line">		&#125;,</span><br><span class="line">		data() &#123;</span><br><span class="line">			<span class="keyword">return</span> &#123;</span><br><span class="line">				data: [],</span><br><span class="line">				isloading: <span class="literal">false</span>,</span><br><span class="line">				changeTop: <span class="number">0</span>,</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		methods: &#123;</span><br><span class="line">			top() &#123;</span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">'top'</span>);</span><br><span class="line">			&#125;,</span><br><span class="line">			bottom() &#123;</span><br><span class="line">				<span class="built_in">console</span>.log(<span class="string">'bottom'</span>)</span><br><span class="line">				<span class="keyword">this</span>.isloading = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">var</span> newdata = [</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">					<span class="string">'æˆ‘æ˜¯æ–°åŠ çš„æ•°æ®'</span>,</span><br><span class="line">				];</span><br><span class="line">				setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">					<span class="keyword">this</span>.data = <span class="keyword">this</span>.data.concat(newdata);</span><br><span class="line">					<span class="keyword">this</span>.isloading = <span class="literal">false</span>;</span><br><span class="line">				&#125;, <span class="number">1000</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style&gt;</span></span><br><span class="line"><span class="regexp">	* &#123;</span></span><br><span class="line"><span class="regexp">		padding: 0px;</span></span><br><span class="line"><span class="regexp">		margin: 0px;</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">	</span></span><br><span class="line"><span class="regexp">	#box &#123;</span></span><br><span class="line"><span class="regexp">		margin: 0 auto;</span></span><br><span class="line"><span class="regexp">		text-align: center;</span></span><br><span class="line"><span class="regexp">		width: 500px;</span></span><br><span class="line"><span class="regexp">		height: 500px;</span></span><br><span class="line"><span class="regexp">		border: 1px solid red;</span></span><br><span class="line"><span class="regexp">		border-radius: 3px;</span></span><br><span class="line"><span class="regexp">		position: relative;</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">	</span></span><br><span class="line"><span class="regexp">	#container &#123;</span></span><br><span class="line"><span class="regexp">		width: 100%;</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">	</span></span><br><span class="line"><span class="regexp">	#loadingbox &#123;</span></span><br><span class="line"><span class="regexp">		width: 100%;</span></span><br><span class="line"><span class="regexp">		background: rgba(255, 255, 255, .8);</span></span><br><span class="line"><span class="regexp">		position: absolute;</span></span><br><span class="line"><span class="regexp">		left: 0;</span></span><br><span class="line"><span class="regexp">		bottom: 0;</span></span><br><span class="line"><span class="regexp">		text-align: center;</span></span><br><span class="line"><span class="regexp">		font-weight: bold;</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">	&lt;div ref=<span class="string">"box"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"scrollbar_box"</span> @wheel=<span class="string">"scroll"</span> @mouseenter=<span class="string">"mouseenter($event)"</span> @mouseleave=<span class="string">"mouseleave($event)"</span>&gt;</span><br><span class="line">		&lt;div ref=<span class="string">"container"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"scrollbar_container"</span> :style=<span class="string">"&#123; transform : `translate(0px, $&#123;top*-1&#125;px)` &#125;"</span>&gt;</span><br><span class="line">			&lt;slot&gt;<span class="xml"><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span></span><br><span class="line">		&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">		&lt;div ref="scrollbarPath" class="scrollbar_path" v-show="isVerticalBtn" :class="&#123;on: verticalCur&#125;"&gt;</span></span><br><span class="line"><span class="regexp">			&lt;div ref="verticalBtn" class="scrollbar_verticalBtn" :style="&#123; height: `$&#123;barHeight&#125;%`, top : `$&#123;barTop&#125;%` &#125;" </span></span><br><span class="line"><span class="regexp">				 @mousedown="startmoveV" &gt;</span></span><br><span class="line"><span class="regexp">			&lt;/</span>div&gt;</span><br><span class="line">		&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">	&lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">	export default &#123;</span></span><br><span class="line"><span class="regexp">		data() &#123;</span></span><br><span class="line"><span class="regexp">			return &#123;</span></span><br><span class="line"><span class="regexp">				top: 0, /</span><span class="regexp">/boxåç§»é‡px</span></span><br><span class="line"><span class="regexp">				barHeight: 0, /</span><span class="regexp">/ç«–ç›´æ»šåŠ¨æ¡é«˜åº¦</span></span><br><span class="line"><span class="regexp">				barTop: 0, /</span><span class="regexp">/ç«–ç›´æ»šåŠ¨æ¡ä¸Šä¸‹åç§»é‡%</span></span><br><span class="line"><span class="regexp">				isVerticalBtn: false, /</span><span class="regexp">/ç«–ç›´æ»šåŠ¨æ¡æ˜¯å¦æ˜¾ç¤º</span></span><br><span class="line"><span class="regexp">                verticalCur:false,</span></span><br><span class="line"><span class="regexp">                </span></span><br><span class="line"><span class="regexp">				isStartmoveV: false, /</span><span class="regexp">/ç‚¹å‡»æ‹–æ‹½å‚ç›´æ ‡å¿—ä½</span></span><br><span class="line"><span class="regexp">                </span></span><br><span class="line"><span class="regexp">				point: &#123; /</span><span class="regexp">/ç›¸å¯¹æ‹–å¿«å·¦ä¸Šè§’çš„x,yåæ ‡</span></span><br><span class="line"><span class="regexp">					x: 0,</span></span><br><span class="line"><span class="regexp">					y: 0,</span></span><br><span class="line"><span class="regexp">				&#125;,</span></span><br><span class="line"><span class="regexp">				boxPoint: &#123; /</span><span class="regexp">/ 4ä¸ªè§’å®¹å™¨çš„åæ ‡</span></span><br><span class="line"><span class="regexp">					minX: 0,</span></span><br><span class="line"><span class="regexp">					maxX: 0,</span></span><br><span class="line"><span class="regexp">					minY: 0,</span></span><br><span class="line"><span class="regexp">					maxY: 0,</span></span><br><span class="line"><span class="regexp">				&#125;,</span></span><br><span class="line"><span class="regexp">				isrun: false, /</span><span class="regexp">/æ˜¯å¦åœ¨è¿è¡Œ ä¼˜åŒ– å› ä¸º é¢‘ç¹ è§¦å‘ resize å‡½æ•°ï¼Œå¯¼è‡´é¡µé¢å¾ˆå¡çš„ é—®é¢˜ èŠ‚æµå‡½æ•°</span></span><br><span class="line"><span class="regexp">				throttleTime: 400, /</span><span class="regexp">/èŠ‚æµå‡½æ•°å®šæ—¶å™¨æ—¶é—´</span></span><br><span class="line"><span class="regexp">			&#125;</span></span><br><span class="line"><span class="regexp">		&#125;,</span></span><br><span class="line"><span class="regexp">		props: &#123;</span></span><br><span class="line"><span class="regexp">			speed: &#123;</span></span><br><span class="line"><span class="regexp">				type: Number,</span></span><br><span class="line"><span class="regexp">				default: 30</span></span><br><span class="line"><span class="regexp">			&#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">			changeTop: &#123; /</span><span class="regexp">/ä¸Šä¸‹åç§»é‡ px</span></span><br><span class="line"><span class="regexp">				type: Number,</span></span><br><span class="line"><span class="regexp">				default: 0</span></span><br><span class="line"><span class="regexp">			&#125;,</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">			timeOut: &#123; /</span><span class="regexp">/å»¶æ—¶è°ƒç”¨changeWinSize</span></span><br><span class="line"><span class="regexp">				type: Number,</span></span><br><span class="line"><span class="regexp">				default: 0</span></span><br><span class="line"><span class="regexp">			&#125;,</span></span><br><span class="line"><span class="regexp">		&#125;,</span></span><br><span class="line"><span class="regexp">		watch: &#123;</span></span><br><span class="line"><span class="regexp">			changeTop() &#123;  /</span><span class="regexp">/ å½“å¤–é¢ä¼ è¿™ä¸ªå‘é€å˜åŒ–æ—¶å°±è®©åˆ°è¿™ä¸ªä½ç½®</span></span><br><span class="line"><span class="regexp">				this.setbarTop();</span></span><br><span class="line"><span class="regexp">			&#125;</span></span><br><span class="line"><span class="regexp">		&#125;,</span></span><br><span class="line"><span class="regexp">		computed: &#123;&#125;,</span></span><br><span class="line"><span class="regexp">		methods: &#123;</span></span><br><span class="line"><span class="regexp">			mouseenter()&#123;</span></span><br><span class="line"><span class="regexp">				this.verticalCur=true;</span></span><br><span class="line"><span class="regexp">			&#125;,</span></span><br><span class="line"><span class="regexp">			mouseleave()&#123;</span></span><br><span class="line"><span class="regexp">				setTimeout(()=&gt;&#123;</span></span><br><span class="line"><span class="regexp">					this.verticalCur=false;</span></span><br><span class="line"><span class="regexp">				&#125;,1000)</span></span><br><span class="line"><span class="regexp">			&#125;,</span></span><br><span class="line"><span class="regexp">			/</span><span class="regexp">/ åˆå§‹åŒ–</span></span><br><span class="line"><span class="regexp">			getPropData() &#123;</span></span><br><span class="line"><span class="regexp">				this.setbarTop();</span></span><br><span class="line"><span class="regexp">			&#125;,</span></span><br><span class="line"><span class="regexp">			setbarTop() &#123;</span></span><br><span class="line"><span class="regexp">				if(this.top == this.changeTop) return false;</span></span><br><span class="line"><span class="regexp">				let size = this.getSize();</span></span><br><span class="line"><span class="regexp">				let topEnd = size.containerHeight - size.boxHeight;</span></span><br><span class="line"><span class="regexp">				if(this.changeTop &lt; 0) &#123;</span></span><br><span class="line"><span class="regexp">					this.top = 0;</span></span><br><span class="line"><span class="regexp">				&#125; else if(this.changeTop &gt;= topEnd) &#123;</span></span><br><span class="line"><span class="regexp">					this.top = topEnd;</span></span><br><span class="line"><span class="regexp">				&#125; else &#123;</span></span><br><span class="line"><span class="regexp">					this.top = this.changeTop;</span></span><br><span class="line"><span class="regexp">				&#125;</span></span><br><span class="line"><span class="regexp">				this.barTop = ((this.top * 100) /</span> size.containerHeight) * <span class="number">1</span>;</span><br><span class="line">			&#125;,</span><br><span class="line"></span><br><span class="line">			<span class="comment">// æ»šåŠ¨</span></span><br><span class="line">			scroll(e) &#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="keyword">this</span>.isVerticalBtn) &#123;</span><br><span class="line">					e.preventDefault();</span><br><span class="line">					e.stopPropagation();</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">let</span> speed = <span class="keyword">this</span>.speed;</span><br><span class="line">				<span class="keyword">let</span> shifted = e.shiftKey</span><br><span class="line">				<span class="keyword">let</span> scrollY = e.deltaY &gt; <span class="number">0</span> ? speed * <span class="number">1</span> : speed * <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(shifted &amp;&amp; e.deltaX == <span class="number">0</span>) scrollX = e.deltaY &gt; <span class="number">0</span> ? speed : speed * <span class="number">-1</span>;</span><br><span class="line">				<span class="keyword">let</span> nextY = <span class="keyword">this</span>.top * <span class="number">1</span> + scrollY;</span><br><span class="line"></span><br><span class="line">				<span class="comment">// å¦‚æœæ²¡æœ‰å‚ç›´çš„æ»šåŠ¨æ¡å°±æ»šåŠ¨æ¨ªå‘çš„</span></span><br><span class="line">				<span class="keyword">if</span>(<span class="keyword">this</span>.isVerticalBtn) &#123;</span><br><span class="line">					<span class="keyword">this</span>.setVerticalScroll(nextY)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="comment">// å‚ç›´btnç‚¹å‡»åçš„äº‹ä»¶</span></span><br><span class="line">			startmoveV(e) &#123;</span><br><span class="line">				<span class="keyword">this</span>.verticalCur=<span class="literal">true</span>;</span><br><span class="line">				e.preventDefault(); <span class="comment">//é˜»æ­¢é»˜è®¤äº‹ä»¶ï¼Œå–æ¶ˆæ–‡å­—é€‰ä¸­</span></span><br><span class="line">				<span class="keyword">let</span> _point = <span class="keyword">this</span>.windowToBox(e.clientX, e.clientY, <span class="keyword">this</span>.$refs.verticalBtn); <span class="comment">//å¾—å‡ºæ¥çš„æ˜¯ç›¸å¯¹è¿™å‚ç›´btnçš„ç‚¹ä½ç½®</span></span><br><span class="line">				<span class="keyword">this</span>.isStartmoveV = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">this</span>.point.x = _point.x;</span><br><span class="line">				<span class="keyword">this</span>.point.y = _point.y;</span><br><span class="line">				<span class="built_in">document</span>.addEventListener(<span class="string">'mousemove'</span>, <span class="keyword">this</span>.fnMousemoveV, <span class="literal">false</span>);</span><br><span class="line">				<span class="built_in">document</span>.addEventListener(<span class="string">'mouseup'</span>, <span class="keyword">this</span>.fnMouseup, <span class="literal">false</span>);</span><br><span class="line">			&#125;,</span><br><span class="line"></span><br><span class="line">			<span class="comment">// å‚ç›´ç§»åŠ¨ç›‘å¬</span></span><br><span class="line">			fnMousemoveV(e) &#123;</span><br><span class="line">				<span class="keyword">this</span>.verticalCur=<span class="literal">true</span>;</span><br><span class="line">				e.preventDefault();</span><br><span class="line">				<span class="keyword">if</span>(<span class="keyword">this</span>.isStartmoveV) &#123;</span><br><span class="line">					<span class="keyword">this</span>.setVerticalClick(e.clientY - <span class="keyword">this</span>.point.y);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line"></span><br><span class="line">			<span class="comment">// é¼ æ ‡æŠ¬èµ·ç›‘å¬</span></span><br><span class="line">			fnMouseup(e) &#123;</span><br><span class="line">				e.preventDefault();</span><br><span class="line">				<span class="keyword">this</span>.isStartmoveV = <span class="literal">false</span>;</span><br><span class="line">				<span class="keyword">this</span>.clearMousemove();</span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="comment">// æ¸…é™¤ç›‘å¬</span></span><br><span class="line">			clearMousemove() &#123;</span><br><span class="line">				<span class="built_in">document</span>.removeEventListener(<span class="string">'mousemove'</span>, <span class="keyword">this</span>.fnMousemoveV, <span class="literal">false</span>);</span><br><span class="line">				<span class="built_in">document</span>.removeEventListener(<span class="string">'mouseup'</span>, <span class="keyword">this</span>.fnMouseup, <span class="literal">false</span>);</span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="comment">// åŒ…å›´ç›’çš„ä¿¡æ¯åæ ‡è½´</span></span><br><span class="line">			windowToBox(x, y, el) &#123;</span><br><span class="line">				<span class="keyword">let</span> _bbox = el.getBoundingClientRect();</span><br><span class="line">				<span class="keyword">return</span> &#123;</span><br><span class="line">					x: x - _bbox.left,</span><br><span class="line">					y: y - _bbox.top</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;,</span><br><span class="line"></span><br><span class="line">			getSize() &#123; <span class="comment">// è¿”å›ç›’å­å°ºå¯¸</span></span><br><span class="line">				<span class="keyword">let</span> _container = <span class="keyword">this</span>.$refs.container;</span><br><span class="line">				<span class="keyword">let</span> _box = <span class="keyword">this</span>.$refs.box;</span><br><span class="line">				<span class="keyword">let</span> size = &#123;</span><br><span class="line"></span><br><span class="line">					containerHeight: _container.scrollHeight, <span class="comment">//æ»šåŠ¨å†…å®¹çš„é«˜åº¦å®½åº¦</span></span><br><span class="line">					containerWidth: _container.scrollWidth,</span><br><span class="line"></span><br><span class="line">					boxHeight: _box.clientHeight, <span class="comment">//æœ€å¤–é¢ç›’å­çš„é«˜åº¦å®½åº¦</span></span><br><span class="line">					boxWidth: _box.clientWidth,</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> size;</span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="comment">// ç‚¹å‡»æ‹–æ‹½è®¾ç½®</span></span><br><span class="line">			setVerticalClick(val) &#123;</span><br><span class="line">				<span class="keyword">let</span> size = <span class="keyword">this</span>.getSize();</span><br><span class="line">				<span class="keyword">let</span> barTop = ((val - <span class="keyword">this</span>.boxPoint.minY) / <span class="keyword">this</span>.$refs.box.clientHeight) * <span class="number">100</span>;  <span class="comment">//æ¢ç®—æˆç™¾åˆ†æ¯”</span></span><br><span class="line">				<span class="keyword">if</span>(barTop &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">					barTop = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">if</span>(<span class="keyword">this</span>.barTop == barTop) &#123;</span><br><span class="line">						<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">this</span>.$emit(<span class="string">'top'</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(barTop + <span class="keyword">this</span>.barHeight &gt;= <span class="number">100</span>) &#123;</span><br><span class="line">					barTop = <span class="number">100</span> - <span class="keyword">this</span>.barHeight;</span><br><span class="line">					<span class="keyword">if</span>(<span class="keyword">this</span>.barTop == barTop) &#123;</span><br><span class="line">						<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">this</span>.$emit(<span class="string">'bottom'</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">this</span>.barTop = barTop; <span class="comment">// è¿™é‡Œæ˜¯ç™¾åˆ†æ¯”çš„éœ€è¦è½¬æ¢</span></span><br><span class="line">				<span class="keyword">this</span>.top = ((barTop / <span class="number">100</span>) * size.containerHeight).toFixed(<span class="number">2</span>) * <span class="number">1</span>; <span class="comment">//æ¢ç®—ç™¾åˆ†ç™¾</span></span><br><span class="line">				<span class="keyword">this</span>.$emit(<span class="string">'update:changeTop'</span>, <span class="keyword">this</span>.top);</span><br><span class="line">			&#125;,</span><br><span class="line"></span><br><span class="line">			setVerticalScroll(val) &#123; <span class="comment">//valæ˜¯åç§»é‡ æ»šåŠ¨çš„ </span></span><br><span class="line">				<span class="keyword">let</span> size = <span class="keyword">this</span>.getSize();</span><br><span class="line">				<span class="keyword">let</span> topEnd = size.containerHeight - size.boxHeight;</span><br><span class="line">				<span class="keyword">if</span>(val &gt;= topEnd) &#123;</span><br><span class="line">					val = topEnd;</span><br><span class="line">					<span class="keyword">if</span>(<span class="keyword">this</span>.top == val) &#123; <span class="comment">// å·²ç»åˆ°åº•éƒ¨å°±ä¸ç”¨ç»§ç»­æ‰§è¡Œäº†</span></span><br><span class="line">						<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">this</span>.$emit(<span class="string">'bottom'</span>);</span><br><span class="line">				&#125;;</span><br><span class="line">				<span class="keyword">if</span>(val &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">					val = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">if</span>(<span class="keyword">this</span>.top == val) &#123; <span class="comment">// å·²ç»åˆ°é¡¶éƒ¨å°±ä¸ç”¨ç»§ç»­æ‰§è¡Œäº†</span></span><br><span class="line">						<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">this</span>.$emit(<span class="string">'top'</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">this</span>.top = val;</span><br><span class="line">				<span class="keyword">this</span>.$emit(<span class="string">'update:changeTop'</span>, <span class="keyword">this</span>.top);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">this</span>.barTop = (val / size.containerHeight) * <span class="number">100</span>; <span class="comment">// å¯¼èˆªæ¡çš„topçš„è®¡ç®— </span></span><br><span class="line">			&#125;,</span><br><span class="line">			changeWinSize() &#123;   <span class="comment">//æœ€é‡è¦çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè§¦åº•è®¡ç®—ï¼Œæ»‘å—çš„topä¸å˜ï¼Œåªæ”¹å˜é«˜åº¦</span></span><br><span class="line">				<span class="keyword">let</span> size = <span class="keyword">this</span>.getSize();</span><br><span class="line">				<span class="keyword">let</span> boxPoint = <span class="keyword">this</span>.$refs.box.getBoundingClientRect(); <span class="comment">// containerçš„æåæ ‡</span></span><br><span class="line">				<span class="comment">// ä¿å­˜boxçª—å£åæ ‡</span></span><br><span class="line">				<span class="keyword">this</span>.boxPoint.minX = boxPoint.left;</span><br><span class="line">				<span class="keyword">this</span>.boxPoint.maxX = boxPoint.right;</span><br><span class="line">				<span class="keyword">this</span>.boxPoint.minY = boxPoint.top;</span><br><span class="line">				<span class="keyword">this</span>.boxPoint.maxY = boxPoint.bottom;</span><br><span class="line">				<span class="comment">// è®¡ç®—æ‹–æ‹½æ¡çš„å®½é«˜</span></span><br><span class="line">				<span class="keyword">this</span>.barHeight = (size.boxHeight / size.containerHeight) * <span class="number">100</span>;  <span class="comment">//100æ˜¯ç™¾åˆ†æ¯”ï¼Œboxçš„é«˜åº¦æ˜¯100%,æ¯”ä¾‹è®¡ç®—</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">// æ˜¯å¦æ˜¾ç¤ºæ‹–æ‹½æ¡</span></span><br><span class="line">				<span class="keyword">this</span>.isVerticalBtn = (<span class="keyword">this</span>.barHeight &gt;= <span class="number">100</span> &amp;&amp; !!<span class="keyword">this</span>.barHeight) ? <span class="literal">false</span> : <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">if</span>(!<span class="keyword">this</span>.isVerticalBtn) &#123;</span><br><span class="line">					<span class="keyword">this</span>.top = <span class="number">0</span>;</span><br><span class="line">					<span class="keyword">this</span>.barTop = <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		mounted() &#123;</span><br><span class="line">			<span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">				<span class="keyword">this</span>.getPropData();</span><br><span class="line">				<span class="keyword">this</span>.changeWinSize();</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;,</span><br><span class="line">		updated() &#123; <span class="comment">//ç”±äºæ•°æ®æ›´æ”¹å¯¼è‡´çš„è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ï¼Œåœ¨è¿™ä¹‹åä¼šè°ƒç”¨è¯¥é’©å­</span></span><br><span class="line">			<span class="keyword">this</span>.$nextTick(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="keyword">this</span>.timeOut != <span class="number">0</span>) &#123; <span class="comment">//é˜²æ­¢æŸäº›åŠ¨ç”»å½±å“å¦‚el-collapse-transition</span></span><br><span class="line">					setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">						<span class="keyword">this</span>.changeWinSize();</span><br><span class="line">					&#125;, <span class="keyword">this</span>.timeOut);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="keyword">this</span>.changeWinSize();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style scoped lang="less"&gt;</span></span><br><span class="line"><span class="regexp">	.scrollbar_box &#123;</span></span><br><span class="line"><span class="regexp">		overflow: hidden;</span></span><br><span class="line"><span class="regexp">		position: relative;</span></span><br><span class="line"><span class="regexp">		height: 100%;</span></span><br><span class="line"><span class="regexp">		width: 100%;</span></span><br><span class="line"><span class="regexp">		transform: translateZ(0);</span></span><br><span class="line"><span class="regexp">		backface-visibility: hidden;</span></span><br><span class="line"><span class="regexp">		perspective: 1000;</span></span><br><span class="line"><span class="regexp">		transform: translate3d(0, 0, 0);</span></span><br><span class="line"><span class="regexp">		.scrollbar_container &#123;</span></span><br><span class="line"><span class="regexp">			overflow: visible;</span></span><br><span class="line"><span class="regexp">			width: 100%;</span></span><br><span class="line"><span class="regexp">			height: 100%;</span></span><br><span class="line"><span class="regexp">		&#125;</span></span><br><span class="line"><span class="regexp">		.scrollbar_path &#123;</span></span><br><span class="line"><span class="regexp">			position: absolute;</span></span><br><span class="line"><span class="regexp">			top: 0px;</span></span><br><span class="line"><span class="regexp">			right: 0px;</span></span><br><span class="line"><span class="regexp">			width: 6px;</span></span><br><span class="line"><span class="regexp">			height: 100%;</span></span><br><span class="line"><span class="regexp">			background-color: white;</span></span><br><span class="line"><span class="regexp">			opacity: 0;</span></span><br><span class="line"><span class="regexp">		    transition: opacity 500ms;</span></span><br><span class="line"><span class="regexp">		    &amp;.on&#123;</span></span><br><span class="line"><span class="regexp">		    	opacity: 1;</span></span><br><span class="line"><span class="regexp">		    &#125;</span></span><br><span class="line"><span class="regexp">			.scrollbar_verticalBtn &#123;</span></span><br><span class="line"><span class="regexp">				position: absolute;</span></span><br><span class="line"><span class="regexp">				top: 0px;</span></span><br><span class="line"><span class="regexp">				right: 0px;</span></span><br><span class="line"><span class="regexp">				width: 6px;</span></span><br><span class="line"><span class="regexp">				border-radius: 3px;</span></span><br><span class="line"><span class="regexp">				background-color: #51555e;</span></span><br><span class="line"><span class="regexp">				cursor: pointer;</span></span><br><span class="line"><span class="regexp">				z-index: 50;</span></span><br><span class="line"><span class="regexp">				&amp;:hover &#123;</span></span><br><span class="line"><span class="regexp">					background-color: green;z-index: 51;</span></span><br><span class="line"><span class="regexp">				&#125;</span></span><br><span class="line"><span class="regexp">			&#125;</span></span><br><span class="line"><span class="regexp">		&#125;</span></span><br><span class="line"><span class="regexp">	&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/21/NPMå­¦ä¹ ç¬”è®°æ•´ç†/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/21/NPMå­¦ä¹ ç¬”è®°æ•´ç†/" itemprop="url">NPMå­¦ä¹ ç¬”è®°æ•´ç†</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-04-21T18:35:10+08:00">
                2017-04-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="10ä¸ª-NPM-ä½¿ç”¨æŠ€å·§"><a href="#10ä¸ª-NPM-ä½¿ç”¨æŠ€å·§" class="headerlink" title="10ä¸ª NPM ä½¿ç”¨æŠ€å·§"></a><a href="https://github.com/dwqs/blog/issues/40" target="_blank" rel="noopener">10ä¸ª NPM ä½¿ç”¨æŠ€å·§</a></h1><h1 id="NPM-å­¦ä¹ ç¬”è®°æ•´ç†"><a href="#NPM-å­¦ä¹ ç¬”è®°æ•´ç†" class="headerlink" title="NPM å­¦ä¹ ç¬”è®°æ•´ç†"></a><a href="https://blog.ihoey.com/posts/Node/2017-05-10-npm.html" target="_blank" rel="noopener">NPM å­¦ä¹ ç¬”è®°æ•´ç†</a></h1><hr>
<h1 id="ä»€ä¹ˆæ˜¯-NPMä»€ä¹ˆæ˜¯-NPM"><a href="#ä»€ä¹ˆæ˜¯-NPMä»€ä¹ˆæ˜¯-NPM" class="headerlink" title="ä»€ä¹ˆæ˜¯-NPMä»€ä¹ˆæ˜¯ NPM"></a><a href="#ä»€ä¹ˆæ˜¯-NPM">ä»€ä¹ˆæ˜¯-NPM</a>ä»€ä¹ˆæ˜¯ NPM</h1><p><code>npm</code> ä¹‹äº <code>Node</code> ï¼Œå°±åƒ <code>pip</code> ä¹‹äº <code>Python</code> , <code>gem</code> ä¹‹äº <code>Ruby</code> , <code>composer</code> ä¹‹äº <code>PHP</code> ã€‚</p>
<p><code>npm</code> æ˜¯ <code>Node</code> å®˜æ–¹æä¾›çš„åŒ…ç®¡ç†å·¥å…·ï¼Œä»–å·²ç»æˆäº† <code>Node</code> åŒ…çš„æ ‡å‡†å‘å¸ƒå¹³å°ï¼Œç”¨äº <code>Node</code> åŒ…çš„å‘å¸ƒã€ä¼ æ’­ã€ä¾èµ–æ§åˆ¶ã€‚<br><code>npm</code> æä¾›äº†å‘½ä»¤è¡Œå·¥å…·ï¼Œä½¿ä½ å¯ä»¥æ–¹ä¾¿åœ°ä¸‹è½½ã€å®‰è£…ã€å‡çº§ã€åˆ é™¤åŒ…ï¼Œä¹Ÿå¯ä»¥è®©ä½ ä½œä¸ºå¼€å‘è€…å‘å¸ƒå¹¶ç»´æŠ¤åŒ…ã€‚</p>
<h1 id="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-NPMä¸ºä»€ä¹ˆè¦ä½¿ç”¨-NPM"><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-NPMä¸ºä»€ä¹ˆè¦ä½¿ç”¨-NPM" class="headerlink" title="ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-NPMä¸ºä»€ä¹ˆè¦ä½¿ç”¨ NPM"></a><a href="#ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-NPM">ä¸ºä»€ä¹ˆè¦ä½¿ç”¨-NPM</a>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ NPM</h1><p><code>npm</code> æ˜¯éšåŒ <code>Node</code> ä¸€èµ·å®‰è£…çš„åŒ…ç®¡ç†å·¥å…·ï¼Œèƒ½è§£å†³ <code>Node</code> ä»£ç éƒ¨ç½²ä¸Šçš„å¾ˆå¤šé—®é¢˜ï¼Œå¸¸è§çš„åœºæ™¯æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>å…è®¸ç”¨æˆ·ä» <code>npm</code> æœåŠ¡å™¨ä¸‹è½½åˆ«äººç¼–å†™çš„ç¬¬ä¸‰æ–¹åŒ…åˆ°æœ¬åœ°ä½¿ç”¨ã€‚</li>
<li>å…è®¸ç”¨æˆ·ä» <code>npm</code> æœåŠ¡å™¨ä¸‹è½½å¹¶å®‰è£…åˆ«äººç¼–å†™çš„å‘½ä»¤è¡Œç¨‹åºåˆ°æœ¬åœ°ä½¿ç”¨ã€‚</li>
<li>å…è®¸ç”¨æˆ·å°†è‡ªå·±ç¼–å†™çš„åŒ…æˆ–å‘½ä»¤è¡Œç¨‹åºä¸Šä¼ åˆ° <code>npm</code> æœåŠ¡å™¨ä¾›åˆ«äººä½¿ç”¨ã€‚</li>
</ul>
<p><code>npm</code> çš„èƒŒåï¼Œæ˜¯åŸºäº <code>CouchDB</code> çš„ä¸€ä¸ªæ•°æ®åº“ï¼Œè¯¦ç»†è®°å½•äº†æ¯ä¸ªåŒ…çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½œè€…ã€ç‰ˆæœ¬ã€ä¾èµ–ã€æˆæƒä¿¡æ¯ç­‰ã€‚å®ƒçš„ä¸€ä¸ªå¾ˆé‡è¦çš„ä½œç”¨å°±æ˜¯ï¼šå°†å¼€å‘è€…ä»ç¹ççš„åŒ…ç®¡ç†å·¥ä½œï¼ˆç‰ˆæœ¬ã€ä¾èµ–ç­‰ï¼‰ä¸­è§£æ”¾å‡ºæ¥ï¼Œæ›´åŠ ä¸“æ³¨äºåŠŸèƒ½çš„å¼€å‘ã€‚</p>
<h1 id="å¦‚ä½•ä½¿ç”¨-NPMå¦‚ä½•ä½¿ç”¨-NPM"><a href="#å¦‚ä½•ä½¿ç”¨-NPMå¦‚ä½•ä½¿ç”¨-NPM" class="headerlink" title="å¦‚ä½•ä½¿ç”¨-NPMå¦‚ä½•ä½¿ç”¨ NPM"></a><a href="#å¦‚ä½•ä½¿ç”¨-NPM">å¦‚ä½•ä½¿ç”¨-NPM</a>å¦‚ä½•ä½¿ç”¨ NPM</h1><h2 id="å®‰è£…å®‰è£…"><a href="#å®‰è£…å®‰è£…" class="headerlink" title="å®‰è£…å®‰è£…"></a><a href="#å®‰è£…">å®‰è£…</a>å®‰è£…</h2><p><code>npm</code> ä¸éœ€è¦å•ç‹¬å®‰è£…ã€‚åœ¨å®‰è£… <code>Node</code> çš„æ—¶å€™ï¼Œä¼šè¿å¸¦ä¸€èµ·å®‰è£… <code>npm</code> ã€‚ä½†æ˜¯ï¼Œ<code>Node</code> é™„å¸¦çš„ <code>npm</code> å¯èƒ½ä¸æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼Œæœ€åç”¨ä¸‹é¢çš„å‘½ä»¤ï¼Œæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚</p>
<pre><code>$ sudo npm install npm@latest -g
</code></pre><p>å¦‚æœæ˜¯ Window ç³»ç»Ÿä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯ï¼š</p>
<pre><code>npm install npm -g
</code></pre><p>ä¹Ÿå°±æ˜¯ä½¿ç”¨ <code>npm</code> å®‰è£…è‡ªå·±ã€‚ä¹‹æ‰€ä»¥å¯ä»¥è¿™æ ·ï¼Œæ˜¯å› ä¸º <code>npm</code> æœ¬èº«ä¸ <code>Node</code> çš„å…¶ä»–æ¨¡å—æ²¡æœ‰åŒºåˆ«ã€‚</p>
<p>ç„¶åï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒæŸ¥çœ‹å„ç§ä¿¡æ¯ã€‚</p>
<pre><code># æŸ¥çœ‹ npm å‘½ä»¤åˆ—è¡¨
$ npm help

# æŸ¥çœ‹å„ä¸ªå‘½ä»¤çš„ç®€å•ç”¨æ³•
$ npm -l

# æŸ¥çœ‹ npm çš„ç‰ˆæœ¬
$ npm -v

# æŸ¥çœ‹ npm çš„é…ç½®
$ npm config list -l
</code></pre><h2 id="ä½¿ç”¨ä½¿ç”¨"><a href="#ä½¿ç”¨ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨ä½¿ç”¨"></a><a href="#ä½¿ç”¨">ä½¿ç”¨</a>ä½¿ç”¨</h2><h3 id="npm-initnpm-init"><a href="#npm-initnpm-init" class="headerlink" title="npm-initnpm init"></a><a href="#npm-init">npm-init</a>npm init</h3><p><code>npm init</code> ç”¨æ¥åˆå§‹åŒ–ç”Ÿæˆä¸€ä¸ªæ–°çš„ <code>package.json</code> æ–‡ä»¶ã€‚å®ƒä¼šå‘ç”¨æˆ·æé—®ä¸€ç³»åˆ—é—®é¢˜ï¼Œå¦‚æœä½ è§‰å¾—ä¸ç”¨ä¿®æ”¹é»˜è®¤é…ç½®ï¼Œä¸€è·¯å›è½¦å°±å¯ä»¥äº†ã€‚<br>å¦‚æœä½¿ç”¨äº† <code>-f</code>ï¼ˆä»£è¡¨<code>force</code>ï¼‰ã€<code>-y</code>ï¼ˆä»£è¡¨<code>yes</code>ï¼‰ï¼Œåˆ™è·³è¿‡æé—®é˜¶æ®µï¼Œç›´æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„ <code>package.json</code> æ–‡ä»¶ã€‚</p>
<pre><code>$ npm init -y
</code></pre><h3 id="npm-setnpm-set"><a href="#npm-setnpm-set" class="headerlink" title="npm-setnpm set"></a><a href="#npm-set">npm-set</a>npm set</h3><p><code>npm set</code> ç”¨æ¥è®¾ç½®ç¯å¢ƒå˜é‡</p>
<pre><code>$ npm set init-author-name &apos;Your name&apos;
$ npm set init-author-email &apos;Your email&apos;
$ npm set init-author-url &apos;http://yourdomain.com&apos;
$ npm set init-license &apos;MIT&apos;
</code></pre><p>ä¸Šé¢å‘½ä»¤ç­‰äºä¸º <code>npm init</code> è®¾ç½®äº†é»˜è®¤å€¼ï¼Œä»¥åæ‰§è¡Œ <code>npm init</code> çš„æ—¶å€™ï¼Œ<code>package.json</code>çš„ä½œè€…å§“åã€é‚®ä»¶ã€ä¸»é¡µã€è®¸å¯è¯å­—æ®µå°±ä¼šè‡ªåŠ¨å†™å…¥é¢„è®¾çš„å€¼ã€‚è¿™äº›ä¿¡æ¯ä¼šå­˜æ”¾åœ¨ç”¨æˆ·ä¸»ç›®å½•çš„ <code>~/.npmrc</code>æ–‡ä»¶ï¼Œä½¿å¾—ç”¨æˆ·ä¸ç”¨æ¯ä¸ªé¡¹ç›®éƒ½è¾“å…¥ã€‚å¦‚æœæŸä¸ªé¡¹ç›®æœ‰ä¸åŒçš„è®¾ç½®ï¼Œå¯ä»¥é’ˆå¯¹è¯¥é¡¹ç›®è¿è¡Œ <code>npm config</code>ã€‚</p>
<h3 id="npm-infonpm-info"><a href="#npm-infonpm-info" class="headerlink" title="npm-infonpm info"></a><a href="#npm-info">npm-info</a>npm info</h3><p><code>npm info</code> å‘½ä»¤å¯ä»¥æŸ¥çœ‹æ¯ä¸ªæ¨¡å—çš„å…·ä½“ä¿¡æ¯ã€‚æ¯”å¦‚ï¼ŒæŸ¥çœ‹ <code>underscore</code> æ¨¡å—çš„ä¿¡æ¯ã€‚</p>
<pre><code>$ npm info underscore
</code></pre><p>ä¸Šé¢å‘½ä»¤è¿”å›ä¸€ä¸ª <code>JavaScript</code> å¯¹è±¡ï¼ŒåŒ…å«äº† <code>underscore</code> æ¨¡å—çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡çš„æ¯ä¸ªæˆå‘˜ï¼Œéƒ½å¯ä»¥ç›´æ¥ä» <code>info</code> å‘½ä»¤æŸ¥è¯¢ã€‚</p>
<pre><code>$ npm info underscore description

$ npm info underscore homepage

$ npm info underscore version
</code></pre><h3 id="npm-searchnpm-search"><a href="#npm-searchnpm-search" class="headerlink" title="npm-searchnpm search"></a><a href="#npm-search">npm-search</a>npm search</h3><p><code>npm search</code> å‘½ä»¤ç”¨äºæœç´¢ <code>npm</code> ä»“åº“ï¼Œå®ƒåé¢å¯ä»¥è·Ÿå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥è·Ÿæ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
<pre><code>$ npm search &lt;æœç´¢è¯&gt;
</code></pre><h3 id="npm-listnpm-list"><a href="#npm-listnpm-list" class="headerlink" title="npm-listnpm list"></a><a href="#npm-list">npm-list</a>npm list</h3><p><code>npm list</code> å‘½ä»¤ä»¥æ ‘å½¢ç»“æ„åˆ—å‡ºå½“å‰é¡¹ç›®å®‰è£…çš„æ‰€æœ‰æ¨¡å—ï¼Œä»¥åŠå®ƒä»¬ä¾èµ–çš„æ¨¡å—ã€‚</p>
<pre><code>$ npm list

# åŠ ä¸Š global å‚æ•°ï¼Œä¼šåˆ—å‡ºå…¨å±€å®‰è£…çš„æ¨¡å—
$ npm list -global

# npm list å‘½ä»¤ä¹Ÿå¯ä»¥åˆ—å‡ºå•ä¸ªæ¨¡å—
$ npm list underscore
</code></pre><h3 id="npm-installnpm-install"><a href="#npm-installnpm-install" class="headerlink" title="npm-installnpm install"></a><a href="#npm-install">npm-install</a>npm install</h3><p>ä½¿ç”¨ <code>npm</code> å®‰è£…åŒ…çš„å‘½ä»¤æ ¼å¼ä¸ºï¼š<code>npm [install/i] [package_name]</code></p>
<h4 id="æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼"><a href="#æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼" class="headerlink" title="æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼"></a><a href="#æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼">æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼</a>æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼</h4><p><code>npm</code> åœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šä» <a href="http://npmjs.org" target="_blank" rel="noopener">NPM</a> æœç´¢æˆ–ä¸‹è½½åŒ…ï¼Œå°†åŒ…å®‰è£…åˆ°å½“å‰ç›®å½•çš„ <code>node_modules</code> å­ç›®å½•ä¸‹ã€‚</p>
<p>å¦‚æœä½ ç†Ÿæ‚‰ <code>Ruby</code> çš„ <code>gem</code> æˆ–è€… <code>Python</code> çš„ <code>pip</code> ï¼Œä½ ä¼šå‘ç° <code>npm</code> ä¸å®ƒä»¬çš„è¡Œä¸ºä¸åŒï¼Œ <code>gem</code> æˆ– <code>pip</code> æ€»æ˜¯ä»¥å…¨å±€æ¨¡å¼å®‰è£…ï¼Œä½¿åŒ…å¯ä»¥ä¾›æ‰€æœ‰çš„ç¨‹åºä½¿ç”¨ï¼Œè€Œ <code>npm</code> é»˜è®¤ä¼šæŠŠåŒ…å®‰è£…åˆ°å½“å‰ç›®å½•ä¸‹ã€‚è¿™åæ˜ äº† <code>npm</code> ä¸åŒçš„è®¾è®¡å“²å­¦ã€‚å¦‚æœæŠŠåŒ…å®‰è£…åˆ°å…¨å±€ï¼Œå¯ä»¥æä¾›ç¨‹åºçš„é‡å¤åˆ©ç”¨ç¨‹åº¦ï¼Œé¿å…åŒæ ·çš„å†…å®¹çš„å¤šåˆ†å‰¯æœ¬ï¼Œä½†åå¤„æ˜¯éš¾ä»¥å¤„ç†ä¸åŒçš„ç‰ˆæœ¬ä¾èµ–ã€‚å¦‚æœæŠŠåŒ…å®‰è£…åˆ°å½“å‰ç›®å½•ï¼Œæˆ–è€…è¯´æœ¬åœ°ï¼Œåˆ™ä¸ä¼šæœ‰ä¸åŒç¨‹åºä¾èµ–ä¸åŒç‰ˆæœ¬çš„åŒ…çš„å†²çªé—®é¢˜ï¼ŒåŒæ—¶è¿˜å‡è½»äº†åŒ…ä½œè€…çš„ <code>API</code> å…¼å®¹æ€§å‹åŠ›ï¼Œä½†ç¼ºé™·åˆ™æ˜¯åŒä¸€ä¸ªåŒ…å¯èƒ½ä¼šè¢«å®‰è£…è®¸å¤šæ¬¡ã€‚</p>
<p>æˆ‘ä»¬åœ¨ä½¿ç”¨ <code>supervisor</code> çš„æ—¶å€™ä½¿ç”¨äº† <code>npm install -g supervisor</code> å‘½ä»¤ï¼Œå°±æ˜¯ä»¥å…¨å±€æ¨¡å¼å®‰è£… <code>supervisor</code> ã€‚</p>
<p>è¿™é‡Œæ³¨æ„ä¸€ç‚¹çš„å°±æ˜¯ï¼Œ <code>supervisor</code> å¿…é¡»å®‰è£…åˆ°å…¨å±€ï¼Œå¦‚æœä½ ä¸å®‰è£…åˆ°å…¨å±€ï¼Œé”™è¯¯å‘½ä»¤ä¼šæç¤ºä½ å®‰è£…åˆ°å…¨å±€ã€‚å¦‚æœä¸æƒ³å®‰è£…åˆ°é»˜è®¤çš„å…¨å±€ï¼Œä¹Ÿå¯ä»¥è‡ªå·±ä¿®æ”¹å…¨å±€è·¯å¾„åˆ°å½“å‰è·¯å¾„ <code>npm config set prefix &quot;è·¯å¾„&quot;</code> å®‰è£…å®Œä»¥åå°±å¯ä»¥ç”¨ <code>supervisor</code> æ¥å¯åŠ¨æœåŠ¡äº†ã€‚<br><code>supervisor</code> å¯ä»¥å¸®åŠ©ä½ å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œå®ƒä¼šç›‘è§†ä½ å¯¹ä»£ç çš„é©±åŠ¨ï¼Œå¹¶è‡ªåŠ¨é‡å¯ <code>Node</code> ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå…¨å±€å®‰è£…åªé€‚ç”¨äºå·¥å…·æ¨¡å—ï¼Œæ¯”å¦‚ <code>eslint</code> å’Œ <code>gulp</code> ã€‚å…³äºä½¿ç”¨å…¨å±€æ¨¡å¼ï¼Œå¤šæ•°æ—¶å€™å¹¶ä¸æ˜¯å› ä¸ºè®¸å¤šç¨‹åºéƒ½æœ‰å¯èƒ½ç”¨åˆ°äº†å®ƒï¼Œä¸ºäº†å‡å°‘å¤šé‡å‰¯æœ¬è€Œä½¿ç”¨å…¨å±€æ¨¡å¼ï¼Œè€Œæ˜¯å› ä¸º <strong>æœ¬åœ°æ¨¡å¼ä¸ä¼šæ³¨å†Œ <code>PATH</code> ç¯å¢ƒå˜é‡</strong>ã€‚<br>â€œæœ¬åœ°å®‰è£…â€æŒ‡çš„æ˜¯å°†ä¸€ä¸ªæ¨¡å—ä¸‹è½½åˆ°å½“å‰é¡¹ç›®çš„ <code>node_modules</code> å­ç›®å½•ï¼Œç„¶ååªæœ‰åœ¨é¡¹ç›®ç›®å½•ä¹‹ä¸­ï¼Œæ‰èƒ½è°ƒç”¨è¿™ä¸ªæ¨¡å—ã€‚</p>
<p>æœ¬åœ°æ¨¡å¼å’Œå…¨å±€æ¨¡å¼çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š<br>æ¨¡å¼å¯é€šè¿‡ require ä½¿ç”¨æ³¨å†Œ PATHæœ¬åœ°æ¨¡å¼æ˜¯å¦å…¨å±€æ¨¡å¼å¦æ˜¯</p>
<pre><code># æœ¬åœ°å®‰è£…
$ npm install &lt;package name&gt;

# å…¨å±€å®‰è£…
$ sudo npm install -global &lt;package name&gt;
$ sudo npm install -g &lt;package name&gt;
</code></pre><p><code>npm install</code> ä¹Ÿæ”¯æŒç›´æ¥è¾“å…¥ <code>Github</code> ä»£ç åº“åœ°å€ã€‚</p>
<pre><code>$ npm install git://github.com/package/path.git
$ npm install git://github.com/package/path.git#0.1.0
</code></pre><p>å®‰è£…ä¹‹å‰ï¼Œ<code>npm install</code> ä¼šå…ˆæ£€æŸ¥ï¼Œ<code>node_modules</code> ç›®å½•ä¹‹ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŒ‡å®šæ¨¡å—ã€‚å¦‚æœå­˜åœ¨ï¼Œå°±ä¸å†é‡æ–°å®‰è£…äº†ï¼Œå³ä½¿è¿œç¨‹ä»“åº“å·²ç»æœ‰äº†ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
<p>å¦‚æœä½ å¸Œæœ›ï¼Œä¸€ä¸ªæ¨¡å—ä¸ç®¡æ˜¯å¦å®‰è£…è¿‡ï¼Œ <code>npm</code> éƒ½è¦å¼ºåˆ¶é‡æ–°å®‰è£…ï¼Œå¯ä»¥ä½¿ç”¨ <code>-f</code> æˆ– <code>--force</code> å‚æ•°ã€‚</p>
<pre><code>$ npm install &lt;packageName&gt; --force
</code></pre><h4 id="å®‰è£…ä¸åŒç‰ˆæœ¬å®‰è£…ä¸åŒç‰ˆæœ¬"><a href="#å®‰è£…ä¸åŒç‰ˆæœ¬å®‰è£…ä¸åŒç‰ˆæœ¬" class="headerlink" title="å®‰è£…ä¸åŒç‰ˆæœ¬å®‰è£…ä¸åŒç‰ˆæœ¬"></a><a href="#å®‰è£…ä¸åŒç‰ˆæœ¬">å®‰è£…ä¸åŒç‰ˆæœ¬</a>å®‰è£…ä¸åŒç‰ˆæœ¬</h4><p><code>install</code> å‘½ä»¤æ€»æ˜¯å®‰è£…æ¨¡å—çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¦‚æœè¦å®‰è£…æ¨¡å—çš„ç‰¹å®šç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨æ¨¡å—ååé¢åŠ ä¸Š <code>@</code> å’Œç‰ˆæœ¬å·ã€‚</p>
<pre><code>$ npm install sax@latest
$ npm install sax@0.1.1
$ npm install sax@&quot;&gt;=0.1.0 &lt;0.2.0&quot;
</code></pre><p><code>install</code> å‘½ä»¤å¯ä»¥ä½¿ç”¨ä¸åŒå‚æ•°ï¼ŒæŒ‡å®šæ‰€å®‰è£…çš„æ¨¡å—å±äºå“ªä¸€ç§æ€§è´¨çš„ä¾èµ–å…³ç³»ï¼Œå³å‡ºç°åœ¨ <code>packages.json</code> æ–‡ä»¶çš„å“ªä¸€é¡¹ä¸­ã€‚</p>
<blockquote>
<p>â€“saveï¼šæ¨¡å—åå°†è¢«æ·»åŠ åˆ° dependenciesï¼Œå¯ä»¥ç®€åŒ–ä¸ºå‚æ•°-Sã€‚<br>â€“save-devï¼šæ¨¡å—åå°†è¢«æ·»åŠ åˆ° devDependenciesï¼Œå¯ä»¥ç®€åŒ–ä¸ºå‚æ•°-Dã€‚</p>
</blockquote>
<pre><code>$ npm install sax --save
$ npm install node-tap --save-dev
# æˆ–è€…
$ npm install sax -S
$ npm install node-tap -D
</code></pre><h5 id="dependencies-ä¾èµ–dependencies-ä¾èµ–"><a href="#dependencies-ä¾èµ–dependencies-ä¾èµ–" class="headerlink" title="dependencies-ä¾èµ–dependencies ä¾èµ–"></a><a href="#dependencies-ä¾èµ–">dependencies-ä¾èµ–</a>dependencies ä¾èµ–</h5><p>è¿™ä¸ªå¯ä»¥è¯´æ˜¯æˆ‘ä»¬ <code>npm</code> æ ¸å¿ƒä¸€é¡¹å†…å®¹ï¼Œä¾èµ–ç®¡ç†ï¼Œè¿™ä¸ªå¯¹è±¡é‡Œé¢çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®æ‰€ä¾èµ–çš„ <code>js</code> æ¨¡å—åŒ…ã€‚ä¸‹é¢è¿™æ®µä»£ç è¡¨ç¤ºæˆ‘ä»¬ä¾èµ–äº† <code>markdown-it</code> è¿™ä¸ªåŒ…ï¼Œç‰ˆæœ¬æ˜¯ <code>^8.1.0</code> ï¼Œä»£è¡¨æœ€å°ä¾èµ–ç‰ˆæœ¬æ˜¯ <code>8.1.0</code> ï¼Œå¦‚æœè¿™ä¸ªåŒ…æœ‰æ›´æ–°ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ä½¿ç”¨ <code>npm install</code> å‘½ä»¤çš„æ—¶å€™ï¼Œ <code>npm</code> ä¼šå¸®æˆ‘ä»¬ä¸‹è½½æœ€æ–°çš„åŒ…ã€‚å½“åˆ«äººå¼•ç”¨æˆ‘ä»¬è¿™ä¸ªåŒ…çš„æ—¶å€™ï¼ŒåŒ…å†…çš„ä¾èµ–åŒ…ä¹Ÿä¼šè¢«ä¸‹è½½ä¸‹æ¥ã€‚</p>
<pre><code>&quot;dependencies&quot;: {
&quot;markdown-it&quot;: &quot;^8.1.0&quot;
}
</code></pre><h5 id="devDependencies-å¼€å‘ä¾èµ–devDependencies-å¼€å‘ä¾èµ–"><a href="#devDependencies-å¼€å‘ä¾èµ–devDependencies-å¼€å‘ä¾èµ–" class="headerlink" title="devDependencies-å¼€å‘ä¾èµ–devDependencies å¼€å‘ä¾èµ–"></a><a href="#devDependencies-å¼€å‘ä¾èµ–">devDependencies-å¼€å‘ä¾èµ–</a>devDependencies å¼€å‘ä¾èµ–</h5><p>åœ¨æˆ‘ä»¬å¼€å‘çš„æ—¶å€™ä¼šç”¨åˆ°çš„ä¸€äº›åŒ…ï¼Œåªæ˜¯åœ¨å¼€å‘ç¯å¢ƒä¸­éœ€è¦ç”¨åˆ°ï¼Œä½†æ˜¯åœ¨åˆ«äººå¼•ç”¨æˆ‘ä»¬åŒ…çš„æ—¶å€™ï¼Œä¸ä¼šç”¨åˆ°è¿™äº›å†…å®¹ï¼Œæ”¾åœ¨ <code>devDependencies</code> çš„åŒ…ï¼Œåœ¨åˆ«äººå¼•ç”¨çš„æ—¶å€™ä¸ä¼šè¢« <code>npm</code> ä¸‹è½½ã€‚</p>
<pre><code>&quot;devDependencies&quot;: {
&quot;autoprefixer&quot;: &quot;^6.4.0&quot;,
&quot;babel-preset-es2015&quot;: &quot;^6.0.0&quot;,
&quot;babel-preset-stage-2&quot;: &quot;^6.0.0&quot;,
&quot;babel-register&quot;: &quot;^6.0.0&quot;,
&quot;webpack&quot;: &quot;^1.13.2&quot;,
&quot;webpack-dev-middleware&quot;: &quot;^1.8.3&quot;,
&quot;webpack-hot-middleware&quot;: &quot;^2.12.2&quot;,
&quot;webpack-merge&quot;: &quot;^0.14.1&quot;,
&quot;highlightjs&quot;: &quot;^9.8.0&quot;
}
</code></pre><p>å½“ä½ æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„ <code>package.json</code>æ–‡ä»¶çš„æ—¶å€™ï¼Œå°±å¯ä»¥è®©äººä¸€çœ¼çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªæ¨¡å—çš„åŸºæœ¬ä¿¡æ¯ï¼Œå’Œè¿™ä¸ªæ¨¡å—æ‰€éœ€è¦ä¾èµ–çš„åŒ…ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>npm install</code> å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä¸‹è½½å¥½è¿™ä¸ªæ¨¡å—æ‰€éœ€è¦çš„åŒ…ã€‚</p>
<p><code>npm install</code> é»˜è®¤ä¼šå®‰è£… <code>dependencies</code> å­—æ®µå’Œ <code>devDependencies</code> å­—æ®µä¸­çš„æ‰€æœ‰æ¨¡å—ï¼Œå¦‚æœä½¿ç”¨ <code>--production</code> å‚æ•°ï¼Œå¯ä»¥åªå®‰è£… <code>dependencies</code> å­—æ®µçš„æ¨¡å—ã€‚</p>
<pre><code>$ npm install --production
# æˆ–è€…
$ NODE_ENV=production npm install
</code></pre><p>ä¸€æ—¦å®‰è£…äº†æŸä¸ªæ¨¡å—ï¼Œå°±å¯ä»¥åœ¨ä»£ç ä¸­ç”¨ <code>require</code> å‘½ä»¤åŠ è½½è¿™ä¸ªæ¨¡å—ã€‚</p>
<pre><code>var backbone = require(&apos;backbone&apos;)
console.log(backbone.VERSION)
</code></pre><h3 id="npm-runnpm-run"><a href="#npm-runnpm-run" class="headerlink" title="npm-runnpm run"></a><a href="#npm-run">npm-run</a>npm run</h3><p><code>npm</code> ä¸ä»…å¯ä»¥ç”¨äºæ¨¡å—ç®¡ç†ï¼Œè¿˜å¯ä»¥ç”¨äºæ‰§è¡Œè„šæœ¬ã€‚<code>package.json</code> æ–‡ä»¶æœ‰ä¸€ä¸ª <code>scripts</code> å­—æ®µï¼Œå¯ä»¥ç”¨äºæŒ‡å®šè„šæœ¬å‘½ä»¤ï¼Œä¾› <code>npm</code> ç›´æ¥è°ƒç”¨ã€‚<br><code>package.json</code> æ–‡ä»¶å†…å®¹ï¼š</p>
<pre><code>{
&quot;name&quot;: &quot;myproject&quot;,
&quot;devDependencies&quot;: {
&quot;jshint&quot;: &quot;latest&quot;,
&quot;browserify&quot;: &quot;latest&quot;,
&quot;mocha&quot;: &quot;latest&quot;
  },
&quot;scripts&quot;: {
&quot;lint&quot;: &quot;jshint **.js&quot;,
&quot;test&quot;: &quot;mocha test/&quot;
  }
}
</code></pre><h4 id="scripts-è„šæœ¬scripts-è„šæœ¬"><a href="#scripts-è„šæœ¬scripts-è„šæœ¬" class="headerlink" title="scripts-è„šæœ¬scripts è„šæœ¬"></a><a href="#scripts-è„šæœ¬">scripts-è„šæœ¬</a>scripts è„šæœ¬</h4><p>é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€äº›è„šæœ¬ä»£ç ï¼Œå¯ä»¥é€šè¿‡ <code>npm run script-key</code> æ¥è°ƒç”¨ï¼Œä¾‹å¦‚åœ¨è¿™ä¸ª <code>package.json</code> çš„æ–‡ä»¶å¤¹ä¸‹ä½¿ç”¨ <code>npm run dev</code> å°±ç›¸å½“äºè¿è¡Œäº† <code>node build/dev-server.js</code> è¿™ä¸€æ®µä»£ç ã€‚ä½¿ç”¨ <code>scripts</code> çš„ç›®çš„å°±æ˜¯ä¸ºäº†æŠŠä¸€äº›è¦æ‰§è¡Œçš„ä»£ç åˆå¹¶åˆ°ä¸€èµ·ï¼Œä½¿ç”¨ npm run æ¥å¿«é€Ÿçš„è¿è¡Œï¼Œæ–¹ä¾¿çœäº‹ã€‚<br><code>npm run</code> æ˜¯ <code>npm run-script</code> çš„ç¼©å†™ï¼Œä¸€èˆ¬éƒ½ä½¿ç”¨å‰è€…ï¼Œä½†æ˜¯åè€…å¯ä»¥æ›´å¥½çš„ååº”è¿™ä¸ªå‘½ä»¤çš„æœ¬è´¨ã€‚</p>
<pre><code>// è„šæœ¬
&quot;scripts&quot;: {
&quot;dev&quot;: &quot;node build/dev-server.js&quot;,
&quot;build&quot;: &quot;node build/build.js&quot;,
&quot;docs&quot;: &quot;node build/docs.js&quot;,
&quot;build-docs&quot;: &quot;npm run docs &amp; git checkout gh-pages &amp; xcopy /sy dist\\* . &amp; git add . &amp; git commit -m &apos;auto-pages&apos; &amp; git push &amp; git checkout master&quot;,
&quot;build-publish&quot;: &quot;rmdir /S /Q lib &amp; npm run build &amp;git add . &amp; git commit -m auto-build &amp; npm version patch &amp; npm publish &amp; git push&quot;,
&quot;lint&quot;: &quot;eslint --ext .js,.vue src&quot;
}
</code></pre><p><code>npm run</code> å¦‚æœä¸åŠ ä»»ä½•å‚æ•°ï¼Œç›´æ¥è¿è¡Œï¼Œä¼šåˆ—å‡º <code>package.json</code> é‡Œé¢æ‰€æœ‰å¯ä»¥æ‰§è¡Œçš„è„šæœ¬å‘½ä»¤ã€‚<br><code>npm</code> å†…ç½®äº†ä¸¤ä¸ªå‘½ä»¤ç®€å†™ï¼Œ <code>npm test</code> ç­‰åŒäºæ‰§è¡Œ <code>npm run test</code> ï¼Œ<code>npm start</code> ç­‰åŒäºæ‰§è¡Œ <code>npm run start</code>ã€‚</p>
<pre><code>&quot;build&quot;: &quot;npm run build-js &amp;&amp; npm run build-css&quot;
</code></pre><p>ä¸Šé¢çš„å†™æ³•æ˜¯å…ˆè¿è¡Œ <code>npm run build-js</code> ï¼Œç„¶åå†è¿è¡Œ <code>npm run build-css</code> ï¼Œä¸¤ä¸ªå‘½ä»¤ä¸­é—´ç”¨ <code>&amp;&amp;</code> è¿æ¥ã€‚å¦‚æœå¸Œæœ›ä¸¤ä¸ªå‘½ä»¤åŒæ—¶å¹³è¡Œæ‰§è¡Œï¼Œå®ƒä»¬ä¸­é—´å¯ä»¥ç”¨ <code>&amp;</code> è¿æ¥ã€‚</p>
<p>å†™åœ¨ <code>scripts</code> å±æ€§ä¸­çš„å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥åœ¨ <code>node_modules/.bin</code> ç›®å½•ä¸­ç›´æ¥å†™æˆ <code>bash</code> è„šæœ¬ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª <code>bash</code> è„šæœ¬ã€‚</p>
<pre><code>#!/bin/bash

cd site/main
browserify browser/main.js | uglifyjs -mc &gt; static/bundle.js
</code></pre><p>å‡å®šä¸Šé¢çš„è„šæœ¬æ–‡ä»¶åä¸º <code>build.sh</code> ï¼Œå¹¶ä¸”æƒé™ä¸ºå¯æ‰§è¡Œï¼Œå°±å¯ä»¥åœ¨ <code>scripts</code> å±æ€§ä¸­å¼•ç”¨è¯¥æ–‡ä»¶ã€‚</p>
<pre><code>&quot;build-js&quot;: &quot;bin/build.sh&quot;
</code></pre><h3 id="pre-å’Œ-post-è„šæœ¬pre-å’Œ-post-è„šæœ¬"><a href="#pre-å’Œ-post-è„šæœ¬pre-å’Œ-post-è„šæœ¬" class="headerlink" title="pre-å’Œ-post-è„šæœ¬pre- å’Œ post- è„šæœ¬"></a><a href="#pre-å’Œ-post-è„šæœ¬">pre-å’Œ-post-è„šæœ¬</a>pre- å’Œ post- è„šæœ¬</h3><p><code>npm run</code> ä¸ºæ¯æ¡å‘½ä»¤æä¾›äº† <code>pre-</code> å’Œ <code>post-</code> ä¸¤ä¸ªé’©å­ï¼ˆ <code>hook</code> ï¼‰ã€‚ä»¥ <code>npm run lint</code> ä¸ºä¾‹ï¼Œæ‰§è¡Œè¿™æ¡å‘½ä»¤ä¹‹å‰ï¼Œ <code>npm</code> ä¼šå…ˆæŸ¥çœ‹æœ‰æ²¡æœ‰å®šä¹‰ <code>prelint</code> å’Œ <code>postlint</code> ä¸¤ä¸ªé’©å­ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±ä¼šå…ˆæ‰§è¡Œ <code>npm run prelint</code> ï¼Œç„¶åæ‰§è¡Œ <code>npm run lint</code> ï¼Œæœ€åæ‰§è¡Œ <code>npm run postlint</code> ã€‚</p>
<pre><code>{
&quot;name&quot;: &quot;myproject&quot;,
&quot;devDependencies&quot;: {
&quot;eslint&quot;: &quot;latest&quot;
&quot;karma&quot;: &quot;latest&quot;
  },
&quot;scripts&quot;: {
&quot;lint&quot;: &quot;eslint --cache --ext .js --ext .jsx src&quot;,
&quot;test&quot;: &quot;karma start --log-leve=error karma.config.js --single-run=true&quot;,
&quot;pretest&quot;: &quot;npm run lint&quot;,
&quot;posttest&quot;: &quot;echo &apos;Finished running tests&apos;&quot;
  }
}
</code></pre><p>ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ª <code>package.json</code> æ–‡ä»¶çš„ä¾‹å­ã€‚å¦‚æœæ‰§è¡Œ <code>npm test</code>ï¼Œä¼šæŒ‰ä¸‹é¢çš„é¡ºåºæ‰§è¡Œç›¸åº”çš„å‘½ä»¤ã€‚</p>
<ol>
<li><code>pretest</code></li>
<li><code>test</code></li>
<li><code>posttest</code></li>
</ol>
<p>å¦‚æœæ‰§è¡Œè¿‡ç¨‹å‡ºé”™ï¼Œå°±ä¸ä¼šæ‰§è¡Œæ’åœ¨åé¢çš„è„šæœ¬ï¼Œå³å¦‚æœ <code>prelint</code> è„šæœ¬æ‰§è¡Œå‡ºé”™ï¼Œå°±ä¸ä¼šæ¥ç€æ‰§è¡Œ <code>lint</code> å’Œ <code>postlint</code> è„šæœ¬ã€‚</p>
<h3 id="npm-binnpm-bin"><a href="#npm-binnpm-bin" class="headerlink" title="npm-binnpm bin"></a><a href="#npm-bin">npm-bin</a>npm bin</h3><p><code>npm bin</code> å‘½ä»¤æ˜¾ç¤ºç›¸å¯¹äºå½“å‰ç›®å½•çš„ï¼Œ<code>Node</code> æ¨¡å—çš„å¯æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•ï¼ˆå³ <code>.bin</code> ç›®å½•ï¼‰ã€‚</p>
<pre><code># é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œ
$ npm bin
./node_modules/.bin
</code></pre><h1 id="åˆ›å»ºå…¨å±€é“¾æ¥åˆ›å»ºå…¨å±€é“¾æ¥"><a href="#åˆ›å»ºå…¨å±€é“¾æ¥åˆ›å»ºå…¨å±€é“¾æ¥" class="headerlink" title="åˆ›å»ºå…¨å±€é“¾æ¥åˆ›å»ºå…¨å±€é“¾æ¥"></a><a href="#åˆ›å»ºå…¨å±€é“¾æ¥">åˆ›å»ºå…¨å±€é“¾æ¥</a>åˆ›å»ºå…¨å±€é“¾æ¥</h1><p><code>npm</code> æä¾›äº†ä¸€ä¸ªæœ‰è¶£çš„å‘½ä»¤ <code>npm link</code>ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯åœ¨æœ¬åœ°åŒ…å’Œå…¨å±€åŒ…ä¹‹é—´åˆ›å»ºç¬¦å·é“¾æ¥ã€‚æˆ‘ä»¬è¯´è¿‡ä½¿ç”¨å…¨å±€æ¨¡å¼å®‰è£…çš„åŒ…ä¸èƒ½ç›´æ¥é€šè¿‡ <code>require</code> ä½¿ç”¨ã€‚ä½†é€šè¿‡ <code>npm link</code> å‘½ä»¤å¯ä»¥æ‰“ç ´è¿™ä¸€é™åˆ¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»é€šè¿‡ <code>npm install -g express</code> å®‰è£…äº† <code>express</code> ï¼Œè¿™æ—¶åœ¨å·¥ç¨‹çš„ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤ï¼š<code>npm link express ./node_modules/express -&gt; /user/local/lib/node_modules/express</code><br>æˆ‘ä»¬å¯ä»¥åœ¨ <code>node_modules</code> å­ç›®å½•ä¸­å‘ç°ä¸€ä¸ªæŒ‡å‘å®‰è£…åˆ°å…¨å±€çš„åŒ…çš„ç¬¦å·é“¾æ¥ã€‚é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠå…¨å±€åŒ…å½“åšæœ¬åœ°åŒ…æ¥ä½¿ç”¨äº†ã€‚<br>é™¤äº†å°†å…¨å±€çš„åŒ…é“¾æ¥åˆ°æœ¬åœ°ä»¥å¤–ï¼Œä½¿ç”¨ <code>npm link</code> å‘½ä»¤è¿˜å¯ä»¥å°†æœ¬åœ°çš„åŒ…é“¾æ¥åˆ°å…¨å±€ã€‚ä½¿ç”¨æ–¹æ³•æ˜¯åœ¨åŒ…ç›®å½•ï¼ˆ<code>package.json</code> æ‰€åœ¨ç›®å½•ï¼‰ä¸­è¿è¡Œ <code>npm link</code> å‘½ä»¤ã€‚å¦‚æœæˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªåŒ…ï¼Œåˆ©ç”¨è¿™ç§æ–¹æ³•å¯ä»¥éå¸¸æ–¹ä¾¿åœ°åœ¨ä¸åŒçš„å·¥ç¨‹é—´è¿›è¡Œæµ‹è¯•ã€‚</p>
<h1 id="åˆ›å»ºåŒ…åˆ›å»ºåŒ…"><a href="#åˆ›å»ºåŒ…åˆ›å»ºåŒ…" class="headerlink" title="åˆ›å»ºåŒ…åˆ›å»ºåŒ…"></a><a href="#åˆ›å»ºåŒ…">åˆ›å»ºåŒ…</a>åˆ›å»ºåŒ…</h1><p>åŒ…æ˜¯åœ¨æ¨¡å—åŸºç¡€ä¸Šæ›´æ·±ä¸€æ­¥çš„æŠ½è±¡ï¼Œ<code>Node</code> çš„åŒ…ç±»ä¼¼äº <code>C/C++</code> çš„å‡½æ•°åº“æˆ–è€… <code>Java</code> ã€<code>.Net</code> çš„ç±»åº“ã€‚å®ƒå°†æŸä¸ªç‹¬ç«‹çš„åŠŸèƒ½å°è£…èµ·æ¥ï¼Œç”¨äºå‘å¸ƒã€æ›´æ–°ã€ä¾èµ–ç®¡ç†å’Œç‰ˆæœ¬æ§åˆ¶ã€‚<code>Node</code> æ ¹æ® <code>CommonJS</code> è§„èŒƒå®ç°äº†åŒ…æœºåˆ¶ï¼Œå¼€å‘äº† <code>npm</code> æ¥è§£å†³åŒ…çš„å‘å¸ƒå’Œè·å–éœ€æ±‚ã€‚<br><code>Node</code> çš„åŒ…æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«äº†ä¸€ä¸ª <code>JSON</code> æ ¼å¼çš„åŒ…è¯´æ˜æ–‡ä»¶ <code>package.json</code>ã€‚ä¸¥æ ¼ç¬¦åˆ <code>CommonJS</code> è§„èŒƒçš„åŒ…åº”è¯¥å…·å¤‡ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ul>
<li><code>package.json</code> å¿…é¡»åœ¨åŒ…çš„é¡¶å±‚ç›®å½•ä¸‹ï¼›</li>
<li>äºŒè¿›åˆ¶æ–‡ä»¶åº”è¯¥åœ¨ <code>bin</code> ç›®å½•ä¸‹ï¼›</li>
<li><code>JavaScript</code> ä»£ç åº”è¯¥åœ¨ <code>lib</code> ç›®å½•ä¸‹ï¼›</li>
<li>æ–‡æ¡£åº”è¯¥åœ¨ <code>doc</code> ç›®å½•ä¸‹ï¼›</li>
<li>å•å…ƒæµ‹è¯•åº”è¯¥åœ¨ <code>test</code> ç›®å½•ä¸‹ã€‚</li>
</ul>
<p><code>Node</code> å¯¹åŒ…çš„è¦æ±‚å¹¶æ²¡æœ‰è¿™ä¹ˆä¸¥æ ¼ï¼Œåªè¦é¡¶å±‚ç›®å½•ä¸‹æœ‰ <code>package.json</code>ï¼Œå¹¶ç¬¦åˆä¸€äº›è§„èŒƒå³å¯ã€‚å½“ç„¶ä¸ºäº†æé«˜å…¼å®¹æ€§ï¼Œæˆ‘ä»¬è¿˜æ˜¯å»ºè®®ä½ åœ¨åˆ¶ä½œåŒ…çš„æ—¶å€™ï¼Œä¸¥æ ¼éµå®ˆ <code>CommonJS</code> è§„èŒƒã€‚</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠæ–‡ä»¶å¤¹å°è£…ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œå³æ‰€è°“çš„åŒ…ã€‚åŒ…é€šå¸¸æ˜¯ä¸€äº›æ¨¡å—çš„é›†åˆï¼Œåœ¨æ¨¡å—çš„åŸºç¡€ä¸Šæä¾›äº†æ›´é«˜å±‚çš„æŠ½è±¡ï¼Œç›¸å½“äºæä¾›äº†ä¸€äº›å›ºå®šæ¥å£çš„å‡½æ•°åº“ã€‚é€šè¿‡å®šåˆ¶ <code>package.json</code>ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºæ›´å¤æ‚ï¼Œæ›´å®Œå–„ï¼Œæ›´ç¬¦åˆè§„èŒƒçš„åŒ…ç”¨äºå‘å¸ƒã€‚</p>
<p><code>Node</code> åœ¨è°ƒç”¨æŸä¸ªåŒ…æ—¶ï¼Œä¼šé¦–å…ˆæ£€æŸ¥åŒ…ä¸­ <code>packgage.json</code> æ–‡ä»¶çš„ <code>main</code> å­—æ®µï¼Œå°†å…¶ä½œä¸ºåŒ…çš„æ¥å£æ¨¡å—ï¼Œå¦‚æœ <code>package.json</code> æˆ– <code>main</code> å­—æ®µä¸å­˜åœ¨ï¼Œä¼šå°è¯•å¯»æ‰¾ index.js æˆ– index.node ä½œä¸ºåŒ…çš„æ¥å£ã€‚</p>
<p><code>package.json</code> æ˜¯ <code>CommonJS</code> è§„å®šçš„ç”¨æ¥æè¿°åŒ…çš„æ–‡ä»¶ï¼Œå®Œå…¨ç¬¦åˆè§„èŒƒçš„ <code>package.json</code> æ–‡ä»¶åº”è¯¥å«æœ‰ä»¥ä¸‹å­—æ®µï¼š<br>name: åŒ…çš„åå­—ï¼Œå¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œç”±å°å†™è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ç»„æˆï¼Œä¸èƒ½åŒ…å«ç©ºæ ¼ã€‚<br>description: åŒ…çš„ç®€è¦è¯´æ˜ã€‚<br>version: ç¬¦åˆè¯­ä¹‰åŒ–ç‰ˆæœ¬è¯†åˆ«è§„èŒƒçš„ç‰ˆæœ¬å­—ç¬¦ä¸²ã€‚<br>keywords: å…³é”®å­—æ•°ç»„ï¼Œé€šå¸¸ç”¨äºæœç´¢ã€‚<br>maintainers: ç»´æŠ¤è€…æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ è¦åŒ…å« <code>name</code> ã€ <code>email</code>(å¯é€‰)ã€ <code>web</code>(å¯é€‰)å­—æ®µã€‚<br>contributors: è´¡çŒ®è€…æ•°ç»„ï¼Œæ ¼å¼ä¸ <code>maintainers</code> ç›¸åŒã€‚åŒ…çš„ä½œè€…åº”è¯¥æ˜¯è´¡çŒ®è€…æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚<br>bugs: æäº¤ <code>bug</code> çš„åœ°å€ï¼Œå¯ä»¥æ˜¯ç½‘å€æˆ–è€…ç”µå­é‚®ä»¶åœ°å€ã€‚<br>licenses: è®¸å¯è¯æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ è¦åŒ…å« <code>type</code> ï¼ˆè®¸å¯è¯çš„åç§°ï¼‰å’Œ urlï¼ˆé“¾æ¥åˆ°è®¸å¯è¯æ–‡æœ¬çš„åœ°å€ï¼‰å­—æ®µã€‚<br>repositories: ä»“åº“æ‰˜ç®¡åœ°å€æ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ è¦åŒ…å« <code>type</code> ï¼ˆä»“åº“çš„ç±»å‹ï¼Œå¦‚ gitï¼‰ã€URLï¼ˆä»“åº“çš„åœ°å€ï¼‰å’Œ pathï¼ˆç›¸å¯¹äºä»“åº“çš„è·¯å¾„ï¼Œå¯é€‰ï¼‰å­—æ®µã€‚<br>dependencies: åŒ…çš„ä¾èµ–ï¼Œä¸€ä¸ªå…³è”æ•°ç»„ï¼Œç”±åŒ…åç§°å’Œç‰ˆæœ¬å·ç»„æˆã€‚</p>
<h1 id="åŒ…çš„å‘å¸ƒåŒ…çš„å‘å¸ƒ"><a href="#åŒ…çš„å‘å¸ƒåŒ…çš„å‘å¸ƒ" class="headerlink" title="åŒ…çš„å‘å¸ƒåŒ…çš„å‘å¸ƒ"></a><a href="#åŒ…çš„å‘å¸ƒ">åŒ…çš„å‘å¸ƒ</a>åŒ…çš„å‘å¸ƒ</h1><p>é€šè¿‡ä½¿ç”¨ <code>npm init</code> å¯ä»¥æ ¹æ®äº¤äº’å¼å›ç­”äº§ç”Ÿä¸€ä¸ªç¬¦åˆæ ‡å‡†çš„ <code>package.json</code>ã€‚åˆ›å»ºä¸€ä¸ª <code>index.js</code> ä½œä¸ºåŒ…çš„æ¥å£,ä¸€ä¸ªç®€å•çš„åŒ…å°±åˆ¶ä½œå®Œæˆäº†ã€‚<br>åœ¨å‘å¸ƒå‰,æˆ‘ä»¬è¿˜éœ€è¦è·å¾—ä¸€ä¸ªè´¦å·ç”¨äºä»Šåç»´æŠ¤è‡ªå·±çš„åŒ…,ä½¿ç”¨ <code>npm adduser</code> æ ¹æ®æç¤ºå®Œæˆè´¦å·çš„åˆ›å»º<br>å®Œæˆåå¯ä»¥ä½¿ç”¨ <code>npm whoami</code> æ£€æµ‹æ˜¯å¦å·²ç»å–å¾—äº†è´¦å·ã€‚<br>æ¥ä¸‹æ¥,åœ¨ <code>package.json</code> æ‰€åœ¨ç›®å½•ä¸‹è¿è¡Œ <code>npm publish</code>ï¼Œç¨ç­‰ç‰‡åˆ»å°±å¯ä»¥å®Œæˆå‘å¸ƒäº†ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® <a href="http://search.npmjs.org/" target="_blank" rel="noopener">NPMæœç´¢</a> å°±å¯ä»¥æ‰¾åˆ°è‡ªå·±åˆšåˆšå‘å¸ƒçš„åŒ…äº†ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨ä¸–ç•Œçš„ä»»æ„ä¸€å°è®¡ç®—æœºä¸Šä½¿ç”¨ <code>npm install neveryumodule</code> å‘½ä»¤æ¥å®‰è£…å®ƒã€‚<br>å¦‚æœä½ çš„åŒ…å°†æ¥æœ‰æ›´æ–°,åªéœ€è¦åœ¨ <code>package.json</code> æ–‡ä»¶ä¸­ä¿®æ”¹ <code>version</code> å­—æ®µ,ç„¶åé‡æ–°ä½¿ç”¨ <code>npm publish</code>å‘½ä»¤å°±è¡Œäº†ã€‚<br>å¦‚æœä½ å¯¹å·²å‘å¸ƒçš„åŒ…ä¸æ»¡æ„ï¼Œå¯ä»¥ä½¿ç”¨ <code>npm unpublish</code> å‘½ä»¤æ¥å–æ¶ˆå‘å¸ƒã€‚</p>
<p><em>éœ€è¦è¯´æ˜çš„æ˜¯ï¼š <code>json</code> æ–‡ä»¶ä¸èƒ½æœ‰æ³¨é‡Š</em></p>
<h3 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">package.json å¥½å¤„</span><br><span class="line"> 1.ä»¥jsonæ–‡ä»¶æ ¼å¼å®šä¹‰é¡¹ç›®æ‰€ä¾èµ–çš„åŒ…ï¼›</span><br><span class="line"> 2.ç¡®å®šæ¯ä¸ªåŒ…çš„ä½¿ç”¨ç‰ˆæœ¬ï¼›</span><br><span class="line"> 3.é¡¹ç›®æ„å»ºå¯é‡å¤ï¼Œå¤šäººååŠ©å…¬ç”¨ä¸€å¥—åŸºç¡€ä»£ç ï¼›</span><br><span class="line"> 4.npm init åˆå§‹åŒ– ã€å¿…é¡»å«æœ‰çš„ä¸¤ä¸ªï¼šname å’Œ versionã€‘</span><br><span class="line">   &#123;</span><br><span class="line">     &quot;name&quot;: &quot;react-redux-webpack&quot;,</span><br><span class="line">     &quot;version&quot;: &quot;1.1.0&quot;,</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">devDependencies    ï¼šå¼€å‘ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒæ‰€ä¾èµ–çš„åŒ…åˆ—è¡¨</span><br><span class="line">dependencies       ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨çš„ä¾èµ–åŒ…åˆ—è¡¨</span><br><span class="line"></span><br><span class="line">    dependenciesä¸‹è®°å½•çš„æ˜¯é¡¹ç›®åœ¨è¿è¡Œæ—¶å¿…é¡»ä¾èµ–çš„æ’ä»¶ï¼Œå¸¸è§çš„ä¾‹å¦‚react jqueryç­‰ï¼Œå³åŠæ—¶é¡¹ç›®æ‰“åŒ…å¥½äº†ã€ä¸Šçº¿äº†ï¼Œ</span><br><span class="line">   è¿™äº›ä¹Ÿæ˜¯éœ€è¦ç”¨çš„ï¼Œå¦åˆ™ç¨‹åºæ— æ³•æ­£å¸¸æ‰§è¡Œã€‚</span><br><span class="line">    devDependenciesä¸‹è®°å½•çš„æ˜¯é¡¹ç›®åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨çš„æ’ä»¶ï¼Œä¾‹å¦‚è¿™é‡Œæˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨webpackæ‰“åŒ…ï¼Œ</span><br><span class="line">    è€Œæˆ‘åœ¨å·¥ä½œä¸­ä½¿ç”¨fis3æ‰“åŒ…ï¼Œä½†æ˜¯ä¸€æ—¦é¡¹ç›®æ‰“åŒ…å‘å¸ƒã€ä¸Šçº¿äº†ä¹‹åï¼Œwebpackå’Œfis3å°±éƒ½æ²¡æœ‰ç”¨äº†ï¼Œå¯å¸ç£¨æ€é©´ã€‚</span><br><span class="line"></span><br><span class="line">æœ¬åœ°å®‰è£… npm install --save|--save-dev åˆ†åˆ«å†™å…¥  dependencies|devDependencies ä¸­ï¼›</span><br><span class="line">ç®€å†™ï¼š     npm i -S pkg      |  npm i -D pkg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">åŒ…ï¼ˆpackage)å’Œæ¨¡å—ï¼ˆmoduleï¼‰</span><br><span class="line">åŒ…ï¼špackage.json æ–‡ä»¶æ‰€æè¿°çš„æ–‡ä»¶å¤¹æˆ–è€…æ–‡ä»¶ï¼Œç¬¦åˆCommonJSè§„èŒƒ</span><br><span class="line">æ¨¡å—ï¼šä»»ä½•è¢«node.jsä¸­çš„requireæ‰€è½½å…¥çš„æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">~ ä¼šåŒ¹é…æœ€è¿‘çš„å°ç‰ˆæœ¬ä¾èµ–åŒ…ï¼Œæ¯”å¦‚~1.2.3ä¼šåŒ¹é…æ‰€æœ‰1.2.xç‰ˆæœ¬ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬1.3.0</span><br><span class="line">^ ä¼šåŒ¹é…æœ€æ–°çš„å¤§ç‰ˆæœ¬ä¾èµ–åŒ…ï¼Œæ¯”å¦‚^1.2.3ä¼šåŒ¹é…æ‰€æœ‰1.x.xçš„åŒ…ï¼ŒåŒ…æ‹¬1.3.0ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬2.0.0</span><br><span class="line">* è¿™æ„å‘³ç€å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ä¾èµ–åŒ…</span><br><span class="line"></span><br><span class="line">å¸¸ç”¨å‘½ä»¤:</span><br><span class="line">    npm init -y    //å¼ºåˆ¶ç”Ÿæˆ</span><br><span class="line">	npm init //åœ¨é¡¹ç›®ä¸­å¼•å¯¼åˆ›å»ºä¸€ä¸ªpackage.jsonæ–‡ä»¶</span><br><span class="line">	npm search mkdir   //å¯»æ‰¾åŒ…ä½¿ç”¨npm searchå‘½ä»¤</span><br><span class="line">	npm help //æŸ¥çœ‹æŸæ¡å‘½ä»¤çš„è¯¦ç»†å¸®åŠ© </span><br><span class="line">	npm root //æŸ¥çœ‹åŒ…çš„å®‰è£…è·¯å¾„</span><br><span class="line">	npm config //ç®¡ç†npmçš„é…ç½®è·¯å¾„</span><br><span class="line">	npm prefix -g   //æŸ¥çœ‹å…¨å±€å®‰è£…çš„åŒ…ä½ç½®  -gå…¨å±€</span><br><span class="line">	npm cache  //ç®¡ç†æ¨¡å—çš„ç¼“å­˜ ,å¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼Œå¶å°”æ¸…æ¥šä¸€ä¸‹ç¼“å­˜ï¼š      eg: npm cache clean</span><br><span class="line">	npm info webpack   //æŸ¥çœ‹webpack ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">	npm install pkg //å®‰è£…æ¨¡å— ç®€å†™ï¼šnpm i pkg   ,å¸¦ç‰ˆæœ¬:  npm install underscore@1.8.2</span><br><span class="line">	npm uninstall //å¸è½½æ¨¡å—   eg: npm uninstall webpack</span><br><span class="line">	npm update   // æ›´æ–°æ¨¡å—   npm update underscore</span><br><span class="line">	npm outdated  //æ£€æŸ¥æ¨¡å—æ˜¯å¦å·²ç»è¿‡æ—¶</span><br><span class="line">	npm ls   //æŸ¥çœ‹å®‰è£…çš„æ¨¡å— </span><br><span class="line">	npm list  //å¯ä»¥æŸ¥çœ‹å…¨å±€è·¯å¾„ä¸‹çš„æ‰€æœ‰åŒ…    eg:   npm list --global</span><br><span class="line">	          //ä¹Ÿå¯ä»¥ä½¿ç”¨--depth=0æ¥ç¼©çŸ­è¿”å›çš„ç»“æœ   eg:     npm list -g --depth=0</span><br><span class="line">	npm stop  //åœæ­¢æ¨¡å—</span><br><span class="line">	npm restart  //é‡æ–°å¯åŠ¨æ¨¡å—</span><br><span class="line">	npm test //æµ‹è¯•æ¨¡å— </span><br><span class="line">	npm version //æŸ¥çœ‹æ¨¡å—ç‰ˆæœ¬</span><br><span class="line">	npm publish //å‘å¸ƒæ¨¡å—</span><br><span class="line"></span><br><span class="line">ç®€å†™:</span><br><span class="line">	npm i â€“ å®‰è£…åŒ…</span><br><span class="line">	npm i -g â€“ å®‰è£…åŒ…åˆ°å…¨å±€ä¸‹</span><br><span class="line">	npm un â€“ åˆ é™¤æœ¬åœ°ä¸‹åŒ…</span><br><span class="line">	npm up â€“ æ›´æ–°åŒ…</span><br><span class="line">	npm t â€“ è¿è¡Œæµ‹è¯•</span><br><span class="line">	npm ls â€“ ç½—åˆ—å·²ç»å®‰è£…åŒ…</span><br><span class="line">	npm ll or npm la â€“ ç½—åˆ—åŒ…æ—¶æ˜¾ç¤ºé¢å¤–ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">    npm i express momemt lodash mongoose  webpack   //ä¹Ÿå¯ä»¥ä¸€æ¬¡å®‰è£…å¤šä¸ªåŒ…</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    yarn cache clean   //åˆ é™¤ç”µè„‘ä¸Šæ‰€æœ‰ yarn å®‰è£…çš„ç¼“å­˜</span><br><span class="line">    yarn   //å‘½ä»¤å®‰è£…é¡¹ç›®ç›¸å…³ä¾èµ–</span><br><span class="line">    yarn cache dir //è·å–ç¼“å­˜æ–‡ä»¶å¤¹åœ°å€</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/18/ç®€åŒ–ç‰ˆçš„vue-router/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/18/ç®€åŒ–ç‰ˆçš„vue-router/" itemprop="url">ç®€åŒ–ç‰ˆçš„vue-router</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-04-18T15:12:24+08:00">
                2017-04-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æœ¬æ–‡æ—¨åœ¨ä»‹ç»<code>vue-router</code>çš„å®ç°æ€è·¯ï¼Œå¹¶åŠ¨æ‰‹å®ç°ä¸€ä¸ªç®€åŒ–ç‰ˆçš„<code>vue-router</code>ã€‚<br>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ä¸€èˆ¬é¡¹ç›®ä¸­å¯¹<code>vue-router</code>æœ€åŸºæœ¬çš„ä¸€ä¸ªä½¿ç”¨ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œå®šä¹‰äº†å››ä¸ªè·¯ç”±ç»„ä»¶,æˆ‘ä»¬åªè¦åœ¨æ ¹<code>vue</code>å®ä¾‹ä¸­æ³¨å…¥è¯¥<code>router</code>å¯¹è±¡å°±å¯ä»¥ä½¿ç”¨äº†.</p>
<pre><code>import VueRouter from&apos;vue-router&apos;;
import Home from&apos;@/components/Home&apos;;
import A from&apos;@/components/A&apos;;
import B from&apos;@/components/B&apos;import C from&apos;@/components/C&apos;

Vue.use(VueRouter)

export default new VueRouter.Router({
  // mode: &apos;history&apos;,
  routes: [
    {
      path: &apos;/&apos;,
      component: Home
    },
    {
      path: &apos;/a&apos;,
      component: A
    },
    {
      path: &apos;/b&apos;,
      component: B
    },
    {
      path: &apos;/c&apos;,
      component: C
    }
  ]
})
</code></pre><p><code>vue-router</code>æä¾›ä¸¤ä¸ªå…¨å±€ç»„ä»¶ï¼Œ<code>router-view</code>å’Œ<code>router-link</code>ï¼Œå‰è€…æ˜¯ç”¨äºè·¯ç”±ç»„ä»¶çš„å ä½ï¼Œåè€…ç”¨äºç‚¹å‡»æ—¶è·³è½¬åˆ°æŒ‡å®šè·¯ç”±ã€‚æ­¤å¤–ç»„ä»¶å†…éƒ¨å¯ä»¥é€šè¿‡<code>this.$router.push</code>,<code>this.$rouer.replace</code>ç­‰apiå®ç°è·¯ç”±è·³è½¬ã€‚æœ¬æ–‡å°†å®ç°ä¸Šè¿°ä¸¤ä¸ªå…¨å±€ç»„ä»¶ä»¥åŠ<code>push</code>å’Œ<code>replace</code>ä¸¤ä¸ªapiï¼Œè°ƒç”¨çš„æ—¶å€™æ”¯æŒ<code>params</code>ä¼ å‚ï¼Œå¹¶ä¸”æ”¯æŒ<code>hash</code>å’Œ<code>history</code>ä¸¤ç§æ¨¡å¼ï¼Œå¿½ç•¥å…¶ä½™apiã€åµŒå¥—è·¯ç”±ã€å¼‚æ­¥è·¯ç”±ã€<code>abstract</code>è·¯ç”±ä»¥åŠå¯¼èˆªå®ˆå«ç­‰é«˜çº§åŠŸèƒ½çš„å®ç°ï¼Œè¿™æ ·æœ‰åŠ©äºç†è§£<code>vue-router</code>çš„æ ¸å¿ƒåŸç†ã€‚æœ¬æ–‡çš„æœ€ç»ˆä»£ç ä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼Œåªåšä¸€ä¸ªå­¦ä¹ ç”¨é€”ï¼Œä¸‹é¢æˆ‘ä»¬å°±æ¥ä¸€æ­¥æ­¥å®ç°å®ƒã€‚</p>
<h3 id="installå®ç°"><a href="#installå®ç°" class="headerlink" title="installå®ç°"></a>installå®ç°</h3><p>ä»»ä½•ä¸€ä¸ª<code>vue</code>æ’ä»¶éƒ½è¦å®ç°ä¸€ä¸ª<code>install</code>æ–¹æ³•ï¼Œé€šè¿‡<code>Vue.use</code>è°ƒç”¨æ’ä»¶çš„æ—¶å€™å°±æ˜¯åœ¨è°ƒç”¨æ’ä»¶çš„<code>install</code>æ–¹æ³•ï¼Œé‚£ä¹ˆè·¯ç”±çš„<code>install</code>è¦åšå“ªäº›äº‹æƒ…å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬çŸ¥é“ æˆ‘ä»¬ä¼šç”¨<code>new</code>å…³é”®å­—ç”Ÿæˆä¸€ä¸ª<code>router</code>å®ä¾‹ï¼Œå°±åƒå‰é¢çš„ä»£ç å®ä¾‹ä¸€æ ·ï¼Œç„¶åå°†å…¶æŒ‚è½½åˆ°æ ¹<code>vue</code>å®ä¾‹ä¸Šï¼Œé‚£ä¹ˆä½œä¸ºä¸€ä¸ªå…¨å±€è·¯ç”±ï¼Œæˆ‘ä»¬å½“ç„¶éœ€è¦åœ¨å„ä¸ªç»„ä»¶ä¸­éƒ½å¯ä»¥æ‹¿åˆ°è¿™ä¸ª<code>router</code>å®ä¾‹ã€‚å¦å¤–æˆ‘ä»¬ä½¿ç”¨äº†å…¨å±€ç»„ä»¶<code>router-view</code>å’Œ<code>router-link</code>ï¼Œç”±äº<code>install</code>ä¼šæ¥æ”¶åˆ°<code>Vue</code>æ„é€ å‡½æ•°ä½œä¸ºå®å‚ï¼Œæ–¹ä¾¿æˆ‘ä»¬è°ƒç”¨<code>Vue.component</code>æ¥æ³¨å†Œå…¨å±€ç»„ä»¶ã€‚å› æ­¤ï¼Œåœ¨<code>install</code>ä¸­ä¸»è¦å°±åšä¸¤ä»¶äº‹ï¼Œç»™å„ä¸ªç»„ä»¶éƒ½æŒ‚è½½<code>router</code>å®ä¾‹ï¼Œä»¥åŠå®ç°<code>router-view</code>å’Œ<code>router-link</code>ä¸¤ä¸ªå…¨å±€ç»„ä»¶ã€‚ä¸‹é¢æ˜¯ä»£ç ï¼š</p>
<pre><code>const install = (Vue) =&gt; {

  if (this._Vue) {
    return;
  };
  Vue.mixin({
    beforeCreate() {
      if (this.$options &amp;&amp; this.$options.router) {
        this._routerRoot = this;
        this._router = this.$options.router;
        Vue.util.defineReactive(this, &apos;_routeHistory&apos;, this._router.history)
      } else {
        this._routerRoot = (this.$parent &amp;&amp; this.$parent._routerRoot) || this
      }

      Object.defineProperty(this, &apos;$router&apos;, {
        get() {
          returnthis._routerRoot._router;
        }
      })

      Object.defineProperty(this, &apos;$route&apos;, {
        get() {
          return {
            current: this._routerRoot._routeHistory.current,
            ...this._routerRoot._router.route
          };
        }
      })
    }
  });

  Vue.component(&apos;router-view&apos;, {
    render(h) { ... }
  })

  Vue.component(&apos;router-link&apos;, {    
    props: {
      to: String,
      tag: String,
    },
    render(h) { ... }
  })
  this._Vue = Vue;
}
</code></pre><p>è¿™é‡Œçš„<code>this</code>ä»£è¡¨çš„å°±æ˜¯<code>vue-router</code>å¯¹è±¡ï¼Œå®ƒæœ‰ä¸¤ä¸ªå±æ€§æš´éœ²å‡ºæ¥ä¾›å¤–ç•Œè°ƒç”¨ï¼Œä¸€ä¸ªæ˜¯<code>install</code>ï¼Œä¸€ä¸ªæ˜¯<code>Router</code>æ„é€ å‡½æ•°ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ’ä»¶çš„æ­£ç¡®å®‰è£…ä»¥åŠè·¯ç”±å®ä¾‹åŒ–ã€‚æˆ‘ä»¬å…ˆå¿½ç•¥<code>Router</code>æ„é€ å‡½æ•°ï¼Œæ¥çœ‹<code>install</code>ï¼Œä¸Šé¢ä»£ç ä¸­çš„<code>this._Vue</code>æ˜¯ä¸ªå¼€å§‹æ²¡æœ‰å®šä¹‰çš„å±æ€§ï¼Œä»–çš„ç›®çš„æ˜¯é˜²æ­¢å¤šæ¬¡å®‰è£…ã€‚æˆ‘ä»¬ä½¿ç”¨<code>Vue.mixin</code>å¯¹æ¯ä¸ªç»„ä»¶çš„<code>beforeCreate</code>é’©å­åšå…¨å±€æ··å…¥ï¼Œç›®çš„æ˜¯è®©æ¯ä¸ªç»„ä»¶å®ä¾‹å…±äº«<code>router</code>å®ä¾‹ï¼Œå³é€šè¿‡<code>this.$router</code>æ‹¿åˆ°è·¯ç”±å®ä¾‹ï¼Œé€šè¿‡<code>this.$route</code>æ‹¿åˆ°è·¯ç”±çŠ¶æ€ã€‚éœ€è¦é‡ç‚¹å…³æ³¨çš„æ˜¯è¿™è¡Œä»£ç ï¼š</p>
<pre><code>Vue.util.defineReactive(this, &apos;_routeHistory&apos;, this._router.history)
</code></pre><p>è¿™è¡Œä»£ç åˆ©ç”¨<code>vue</code>çš„å“åº”å¼åŸç†ï¼Œå¯¹æ ¹<code>vue</code>å®ä¾‹æ³¨å†Œäº†ä¸€ä¸ª<code>_routeHistory</code>å±æ€§ï¼ŒæŒ‡å‘è·¯ç”±å®ä¾‹çš„<code>history</code>å¯¹è±¡ï¼Œè¿™æ ·<code>history</code>ä¹Ÿå˜æˆäº†å“åº”å¼çš„ã€‚å› æ­¤ä¸€æ—¦è·¯ç”±çš„<code>history</code>å‘ç”Ÿå˜åŒ–ï¼Œç”¨åˆ°è¿™ä¸ªå€¼çš„ç»„ä»¶å°±ä¼šè§¦å‘<code>render</code>å‡½æ•°é‡æ–°æ¸²æŸ“ï¼Œè¿™é‡Œçš„ç»„ä»¶å°±æ˜¯<code>router-view</code>ã€‚ä»è¿™é‡Œå¯ä»¥çª¥å¯Ÿåˆ°<code>vue-router</code>å®ç°çš„ä¸€ä¸ªåŸºæœ¬æ€è·¯ã€‚ä¸Šè¿°çš„ä»£ç ä¸­å¯¹äºä¸¤ä¸ªå…¨å±€ç»„ä»¶çš„<code>render</code>å‡½æ•°çš„å®ç°ï¼Œå› ä¸ºä¼šä¾èµ–äº<code>router</code>å¯¹è±¡ï¼Œæˆ‘ä»¬å…ˆæ”¾ä¸€æ”¾ï¼Œç¨åå†æ¥å®ç°å®ƒä»¬ï¼Œä¸‹é¢æˆ‘ä»¬åˆ†æä¸€ä¸‹<code>Router</code>æ„é€ å‡½æ•°ã€‚</p>
<h3 id="Routeræ„é€ å‡½æ•°"><a href="#Routeræ„é€ å‡½æ•°" class="headerlink" title="Routeræ„é€ å‡½æ•°"></a>Routeræ„é€ å‡½æ•°</h3><p>ç»è¿‡åˆšæ‰çš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“<code>router</code>å®ä¾‹éœ€è¦æœ‰ä¸€ä¸ª<code>history</code>å¯¹è±¡ï¼Œéœ€è¦ä¸€ä¸ªä¿å­˜å½“å‰è·¯ç”±çŠ¶æ€çš„å¯¹è±¡<code>route</code>ï¼Œå¦å¤–å¾ˆæ˜¾ç„¶è¿˜éœ€è¦æ¥å—è·¯ç”±é…ç½®è¡¨<code>routes</code>ï¼Œæ ¹æ®<code>routes</code>éœ€è¦ä¸€ä¸ªè·¯ç”±æ˜ å°„è¡¨<code>routerMap</code>æ¥å®ç°ç»„ä»¶æœç´¢ï¼Œè¿˜éœ€è¦ä¸€ä¸ªå˜é‡<code>mode</code>åˆ¤æ–­æ˜¯ä»€ä¹ˆæ¨¡å¼ä¸‹çš„è·¯ç”±ï¼Œéœ€è¦å®ç°<code>push</code>å’Œ<code>replace</code>ä¸¤ä¸ªapiï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>const Router = function (options) {
  this.routes = options.routes; // å­˜æ”¾è·¯ç”±é…ç½®this.mode = options.mode || &apos;hash&apos;;
  this.route = Object.create(null), // ç”Ÿæˆè·¯ç”±çŠ¶æ€this.routerMap = createMap(this.routes) // ç”Ÿæˆè·¯ç”±è¡¨this.history = new RouterHistory(); // å®ä¾‹åŒ–è·¯ç”±å†å²å¯¹è±¡this.init(); // åˆå§‹åŒ–
}

Router.prototype.push = (options) =&gt; { ... }

Router.prototype.replace = (options) =&gt; { ... }

Router.prototype.init = () =&gt; { ... }
</code></pre><p>æˆ‘ä»¬çœ‹ä¸€ä¸‹è·¯ç”±è¡¨<code>routerMap</code>çš„å®ç°ï¼Œç”±äºä¸è€ƒè™‘åµŒå¥—ç­‰å…¶ä»–æƒ…å†µï¼Œå®ç°å¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>const createMap = (routes) =&gt; {
  let resMap = Object.create(null);
  routes.forEach(route =&gt; {
    resMap[route[&apos;path&apos;]] = route[&apos;component&apos;];
  })
  return resMap;
}
</code></pre><p><code>RouterHistory</code>çš„å®ç°ä¹Ÿå¾ˆç®€å•ï¼Œæ ¹æ®å‰é¢åˆ†æï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ª<code>current</code>å±æ€§å°±å¯ä»¥ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>const RouterHistory = function (mode) {
  this.current = null; 
}
</code></pre><p>æœ‰äº†è·¯ç”±è¡¨å’Œ<code>history</code>ï¼Œ<code>router-view</code>çš„å®ç°å°±å¾ˆå®¹æ˜“äº†ï¼Œå¦‚ä¸‹ï¼š</p>
<pre><code>Vue.component(&apos;router-view&apos;, {
    render(h) {
      let routerMap = this._self.$router.routerMap;
      return h(routerMap[this._self.$route.current])
    }
  })
</code></pre><p>è¿™é‡Œçš„<code>this</code>æ˜¯ä¸€ä¸ª<code>renderProxy</code>å®ä¾‹ï¼Œä»–æœ‰ä¸€ä¸ªå±æ€§<code>_self</code>å¯ä»¥æ‹¿åˆ°å½“å‰çš„ç»„ä»¶å®ä¾‹ï¼Œè¿›è€Œè®¿é—®åˆ°<code>routerMap</code>ï¼Œå¯ä»¥çœ‹åˆ°è·¯ç”±å®ä¾‹<code>history</code>çš„<code>current</code>æœ¬è´¨ä¸Šå°±æ˜¯æˆ‘ä»¬é…ç½®çš„è·¯ç”±è¡¨ä¸­çš„<code>path</code>ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹<code>Router</code>è¦åšå“ªäº›åˆå§‹åŒ–å·¥ä½œã€‚å¯¹äº<code>hash</code>è·¯ç”±è€Œè¨€ï¼Œurlä¸Š<code>hash</code>å€¼çš„æ”¹å˜ä¸ä¼šå¼•èµ·é¡µé¢åˆ·æ–°ï¼Œä½†æ˜¯å¯ä»¥è§¦å‘ä¸€ä¸ª<code>hashchange</code>äº‹ä»¶ã€‚ç”±äºè·¯ç”±<code>history.current</code>åˆå§‹ä¸º<code>null</code>ï¼Œå› æ­¤åŒ¹é…ä¸åˆ°ä»»ä½•ä¸€ä¸ªè·¯ç”±ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´é¡µé¢åˆ·æ–°åŠ è½½ä¸å‡ºä»»ä½•è·¯ç”±ç»„ä»¶ã€‚åŸºäºè¿™ä¸¤ç‚¹ï¼Œåœ¨<code>init</code>æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®ç°å¯¹é¡µé¢åŠ è½½å®Œæˆçš„ç›‘å¬ï¼Œä»¥åŠ<code>hash</code>å˜åŒ–çš„ç›‘å¬ã€‚å¯¹äº<code>history</code>è·¯ç”±ï¼Œä¸ºäº†å®ç°æµè§ˆå™¨å‰è¿›åé€€æ—¶å‡†ç¡®æ¸²æŸ“å¯¹åº”ç»„ä»¶ï¼Œè¿˜è¦ç›‘å¬ä¸€ä¸ª<code>popstate</code>äº‹ä»¶ã€‚ä»£ç å¦‚ä¸‹:</p>
<pre><code>Router.prototype.init = function () {

  if (this.mode === &apos;hash&apos;) {
    fixHash()
    window.addEventListener(&apos;hashchange&apos;, () =&gt; {
      this.history.current = getHash();
    })
    window.addEventListener(&apos;load&apos;, () =&gt; {
      this.history.current = getHash();
    })
  }

  if (this.mode === &apos;history&apos;) {
    removeHash(this);
    window.addEventListener(&apos;load&apos;, () =&gt; {
      this.history.current = location.pathname;
    })
    window.addEventListener(&apos;popstate&apos;, (e) =&gt; {
      if (e.state) {
        this.history.current = e.state.path;
      }
    })
  }

}
</code></pre><p>å½“å¯ç”¨<code>hash</code>æ¨¡å¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦æ£€æµ‹urlä¸Šæ˜¯å¦å­˜åœ¨<code>hash</code>å€¼ï¼Œæ²¡æœ‰çš„è¯å¼ºåˆ¶èµ‹å€¼ä¸€ä¸ªé»˜è®¤<code>path</code>ï¼Œ<code>hash</code>è·¯ç”±æ—¶ä¼šæ ¹æ®<code>hash</code>å€¼ä½œä¸º<code>key</code>æ¥æŸ¥æ‰¾è·¯ç”±è¡¨ã€‚<code>fixHash</code>å’Œ<code>getHash</code>å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code>const fixHash = () =&gt; {
  if (!location.hash) {
    location.hash = &apos;/&apos;;
  }
}
const getHash = () =&gt; {
  return location.hash.slice(1) || &apos;/&apos;;
}
</code></pre><p>è¿™æ ·åœ¨åˆ·æ–°é¡µé¢å’Œ<code>hash</code>æ”¹å˜çš„æ—¶å€™ï¼Œ<code>current</code>å¯ä»¥å¾—åˆ°èµ‹å€¼å’Œæ›´æ–°ï¼Œé¡µé¢èƒ½æ ¹æ®<code>hash</code>å€¼å‡†ç¡®æ¸²æŸ“è·¯ç”±ã€‚<code>history</code>æ¨¡å¼ä¹Ÿæ˜¯ä¸€æ ·çš„é“ç†ï¼Œåªæ˜¯å®ƒé€šè¿‡<code>location.pathname</code>ä½œä¸º<code>key</code>æœç´¢è·¯ç”±ç»„ä»¶ï¼Œå¦å¤–<code>history</code>æ¨¡å¼éœ€è¦å»é™¤urlä¸Šå¯èƒ½å­˜åœ¨çš„<code>hash</code>,<code>removeHash</code>å®ç°å¦‚ä¸‹ï¼š</p>
<pre><code>const removeHash = (route) =&gt; {
  let url = location.href.split(&apos;#&apos;)[1]
  if (url) {
    route.current = url;
    history.replaceState({}, null, url)
  }
}
</code></pre><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“æµè§ˆå™¨åé€€çš„æ—¶å€™ï¼Œ<code>history</code>æ¨¡å¼ä¼šè§¦å‘<code>popstate</code>äº‹ä»¶ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯é€šè¿‡<code>state</code>çŠ¶æ€å»è·å–<code>path</code>çš„ï¼Œé‚£ä¹ˆ<code>state</code>çŠ¶æ€ä»å“ªé‡Œæ¥å‘¢ï¼Œç­”æ¡ˆæ˜¯ä»<code>window.history</code>å¯¹è±¡çš„<code>pushState</code>å’Œ<code>replaceState</code>è€Œæ¥ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æ­£å¥½å¯ä»¥ç”¨æ¥å®ç°<code>router</code>çš„<code>push</code>æ–¹æ³•å’Œ<code>replace</code>æ–¹æ³•ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™é‡Œå®ƒä»¬çš„å®ç°ï¼š</p>
<pre><code>Router.prototype.push = (options) =&gt; {
  this.history.current = options.path;
  if (this.mode === &apos;history&apos;) {
    history.pushState({
      path: options.path
    }, null, options.path);
  } elseif (this.mode === &apos;hash&apos;) {
    location.hash = options.path;
  }
  this.route.params = {
    ...options.params
  }
}

Router.prototype.replace = (options) =&gt; {
  this.history.current = options.path;
  if (this.mode === &apos;history&apos;) {
    history.replaceState({
      path: options.path
    }, null, options.path);
  } elseif (this.mode === &apos;hash&apos;) {
    location.replace(`#${options.path}`)
  }
  this.route.params = {
    ...options.params
  }
}
</code></pre><p><code>pushState</code>å’Œ<code>replaceState</code>èƒ½å¤Ÿå®ç°æ”¹å˜urlçš„å€¼ä½†ä¸å¼•èµ·é¡µé¢åˆ·æ–°ï¼Œä»è€Œä¸ä¼šå¯¼è‡´æ–°è¯·æ±‚å‘ç”Ÿï¼Œ<code>pushState</code>ä¼šç”Ÿæˆä¸€æ¡å†å²è®°å½•è€Œ<code>replaceState</code>ä¸ä¼šï¼Œåè€…åªæ˜¯æ›¿æ¢å½“å‰urlã€‚åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•æ‰§è¡Œçš„æ—¶å€™å°†<code>path</code>å­˜å…¥<code>state</code>ï¼Œè¿™å°±ä½¿å¾—<code>popstate</code>è§¦å‘çš„æ—¶å€™å¯ä»¥æ‹¿åˆ°è·¯å¾„ä»è€Œè§¦å‘ç»„ä»¶æ¸²æŸ“äº†ã€‚æˆ‘ä»¬åœ¨ç»„ä»¶å†…æŒ‰ç…§å¦‚ä¸‹æ–¹å¼è°ƒç”¨ï¼Œä¼šå°†<code>params</code>å†™å…¥<code>router</code>å®ä¾‹çš„<code>route</code>å±æ€§ä¸­ï¼Œä»è€Œåœ¨è·³è½¬åçš„ç»„ä»¶<code>B</code>å†…é€šè¿‡<code>this.$route.params</code>å¯ä»¥è®¿é—®åˆ°ä¼ å‚ã€‚</p>
<pre><code>this.$router.push({
    path: &apos;/b&apos;,
    params: {
      id: 55
    }
 });
</code></pre><h3 id="router-linkå®ç°"><a href="#router-linkå®ç°" class="headerlink" title="router-linkå®ç°"></a>router-linkå®ç°</h3><p><code>router-view</code>çš„å®ç°å¾ˆç®€å•ï¼Œå‰é¢å·²ç»è¯´è¿‡ã€‚æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>router-link</code>çš„å®ç°,å…ˆæ”¾ä¸Šä»£ç ï¼š</p>
<pre><code>Vue.component(&apos;router-link&apos;, {    
    props: {
      to: String,
      tag: String,
    },

    render(h) {
      let mode = this._self.$router.mode;
      let tag = this.tag || &apos;a&apos;;
      let routerHistory = this._self.$router.history;
      return h(tag, {
        attrs: tag === &apos;a&apos; ? {
          href: mode === &apos;hash&apos; ? &apos;#&apos; + this.to : this.to,

        } : {},
        on: {
          click: (e) =&gt; {
            if (this.to === routerHistory.current) {
              e.preventDefault();
              return;
            }
            routerHistory.current = this.to;
            switch (mode) {
              case&apos;hash&apos;:
                if (tag === &apos;a&apos;) return;
                location.hash = this.to;
                break;
              case&apos;history&apos;:
                history.pushState({
                  path: this.to
                }, null, this.to);
                break;
              default:
            }
            e.preventDefault();
          }
        },
        style: {
          cursor: &apos;pointer&apos;
        }
      }, this.$slots.default)
    }
  })
</code></pre><p><code>router-link</code>å¯ä»¥æ¥å—ä¸¤ä¸ªå±æ€§ï¼Œ<code>to</code>è¡¨ç¤ºè¦è·³è½¬çš„è·¯ç”±è·¯å¾„ï¼Œ<code>tag</code>è¡¨ç¤º<code>router-link</code>è¦æ¸²æŸ“çš„æ ‡ç­¾åï¼Œé»˜è®¤<code>a</code>ä¸ºæ ‡ç­¾ã€‚å¦‚æœæ˜¯<code>a</code>æ ‡ç­¾ï¼Œæˆ‘ä»¬ä¸ºå…¶æ·»åŠ ä¸€ä¸ª<code>href</code>å±æ€§ã€‚æˆ‘ä»¬ç»™æ ‡ç­¾ç»‘å®š<code>click</code>äº‹ä»¶ï¼Œå¦‚æœæ£€æµ‹åˆ°æœ¬æ¬¡è·³è½¬ä¸ºå½“å‰è·¯ç”±çš„è¯ä»€ä¹ˆéƒ½ä¸åšç›´æ¥è¿”å›ï¼Œå¹¶ä¸”é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œå¦åˆ™æ ¹æ®<code>to</code>æ›´æ¢è·¯ç”±ã€‚<code>hash</code>æ¨¡å¼ä¸‹å¹¶ä¸”æ˜¯<code>a</code>æ ‡ç­¾æ—¶å€™å¯ä»¥ç›´æ¥åˆ©ç”¨æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºå®Œæˆurlä¸Š<code>hash</code>çš„æ›¿æ¢ï¼Œå¦è€…é‡æ–°ä¸º<code>location.hash</code>èµ‹å€¼ã€‚<code>history</code>æ¨¡å¼ä¸‹åˆ™åˆ©ç”¨<code>pushState</code>å»æ›´æ–°urlã€‚</p>
<p>ä»¥ä¸Šå®ç°å°±æ˜¯ä¸€ä¸ªç®€å•çš„vue-router.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/02/Promise-å¿…çŸ¥å¿…ä¼š/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="èˆåŠ¨ä¹¾å¤">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/04/02/Promise-å¿…çŸ¥å¿…ä¼š/" itemprop="url">Promise å¿…çŸ¥å¿…ä¼š</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-04-02T23:18:00+08:00">
                2017-04-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="ä½ ä¸çŸ¥é“çš„-Promise-å¯¹è±¡é»‘ç§‘æŠ€"><a href="#ä½ ä¸çŸ¥é“çš„-Promise-å¯¹è±¡é»‘ç§‘æŠ€" class="headerlink" title="ä½ ä¸çŸ¥é“çš„ Promise å¯¹è±¡é»‘ç§‘æŠ€"></a><a href="https://zhuanlan.zhihu.com/p/30735250" target="_blank" rel="noopener">ä½ ä¸çŸ¥é“çš„ Promise å¯¹è±¡é»‘ç§‘æŠ€</a></h2><p>Promise æƒ³å¿…å¤§å®¶éƒ½ååˆ†ç†Ÿæ‚‰ï¼Œæƒ³æƒ³å°±é‚£ä¹ˆå‡ ä¸ª apiï¼Œå¯æ˜¯ä½ çœŸçš„äº†è§£ Promise å—ï¼Ÿæœ¬æ–‡æ ¹æ® Promise çš„ä¸€äº›çŸ¥è¯†ç‚¹æ€»ç»“äº†åé“é¢˜ï¼Œçœ‹çœ‹ä½ èƒ½åšå¯¹å‡ é“ã€‚</p>
<p>ä»¥ä¸‹ promise å‡æŒ‡ä»£ Promise å®ä¾‹ï¼Œç¯å¢ƒæ˜¯ Node.jsã€‚</p>
<h2 id="é¢˜ç›®ä¸€"><a href="#é¢˜ç›®ä¸€" class="headerlink" title="é¢˜ç›®ä¸€"></a>é¢˜ç›®ä¸€</h2><pre><code>const promise = new Promise((resolve, reject) =&gt; {
  console.log(1)
  resolve()
  console.log(2)
})
promise.then(() =&gt; {
  console.log(3)
})
console.log(4)
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>1
2
4
3
</code></pre><p>è§£é‡Šï¼šPromise æ„é€ å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œpromise.then ä¸­çš„å‡½æ•°æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚</p>
<h2 id="é¢˜ç›®äºŒ"><a href="#é¢˜ç›®äºŒ" class="headerlink" title="é¢˜ç›®äºŒ"></a>é¢˜ç›®äºŒ</h2><pre><code>const promise = new Promise((resolve, reject) =&gt; {
  setTimeout(() =&gt; {
    resolve(&apos;success&apos;)
  }, 1000)
})
console.log(promise)
promise
  .then(() =&gt; {
    console.log(promise)
    throw new Error(&apos;error!!!&apos;)
  })
  .catch(err =&gt; {
    console.log(promise)
  })
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>Promise { &lt;pending&gt; }
Promise { &apos;success&apos; }
Promise { &apos;success&apos; }
</code></pre><p>è§£é‡Šï¼špromise æœ‰ 3 ç§çŠ¶æ€ï¼špendingã€fulfilled å’Œ rejectedã€‚çŠ¶æ€æ”¹å˜åªèƒ½æ˜¯ pending-&gt;fulfilled æˆ–è€… pending-&gt;rejectedï¼ŒçŠ¶æ€ä¸€æ—¦æ”¹å˜åˆ™ä¸èƒ½å†å˜ã€‚</p>
<h2 id="é¢˜ç›®ä¸‰"><a href="#é¢˜ç›®ä¸‰" class="headerlink" title="é¢˜ç›®ä¸‰"></a>é¢˜ç›®ä¸‰</h2><pre><code>const promise = new Promise((resolve, reject) =&gt; {
  resolve(&apos;success1&apos;)
  reject(&apos;error&apos;)
  resolve(&apos;success2&apos;)
})

promise
  .then((res) =&gt; {
    console.log(&apos;then: &apos;, res)
  })
  .catch((err) =&gt; {
    console.log(&apos;catch: &apos;, err)
  })
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>then: success1
</code></pre><p>è§£é‡Šï¼šæ„é€ å‡½æ•°ä¸­çš„ resolve æˆ– reject åªæœ‰ç¬¬ä¸€æ¬¡æ‰§è¡Œæœ‰æ•ˆï¼Œå¤šæ¬¡è°ƒç”¨æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œå‘¼åº”ä»£ç äºŒç»“è®ºï¼špromise çŠ¶æ€ä¸€æ—¦æ”¹å˜åˆ™ä¸èƒ½å†å˜ã€‚</p>
<h2 id="é¢˜ç›®å››"><a href="#é¢˜ç›®å››" class="headerlink" title="é¢˜ç›®å››"></a>é¢˜ç›®å››</h2><pre><code>Promise.resolve(1)
  .then((res) =&gt; {
    console.log(res)
    return 2
  })
  .catch((err) =&gt; {
    return 3
  })
  .then((res) =&gt; {
    console.log(res)
  })
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>1
2
</code></pre><p>è§£é‡Šï¼špromise å¯ä»¥é“¾å¼è°ƒç”¨ã€‚æèµ·é“¾å¼è°ƒç”¨æˆ‘ä»¬é€šå¸¸ä¼šæƒ³åˆ°é€šè¿‡ return this å®ç°ï¼Œä¸è¿‡ Promise å¹¶ä¸æ˜¯è¿™æ ·å®ç°çš„ã€‚promise æ¯æ¬¡è°ƒç”¨ .then æˆ–è€… .catch éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„ promiseï¼Œä»è€Œå®ç°äº†é“¾å¼è°ƒç”¨ã€‚</p>
<h2 id="é¢˜ç›®äº”"><a href="#é¢˜ç›®äº”" class="headerlink" title="é¢˜ç›®äº”"></a>é¢˜ç›®äº”</h2><pre><code>const promise = new Promise((resolve, reject) =&gt; {
  setTimeout(() =&gt; {
    console.log(&apos;once&apos;)
    resolve(&apos;success&apos;)
  }, 1000)
})

const start = Date.now()
promise.then((res) =&gt; {
  console.log(res, Date.now() - start)
})
promise.then((res) =&gt; {
  console.log(res, Date.now() - start)
})
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>once
success 1005
success 1007
</code></pre><p>è§£é‡Šï¼špromise çš„ .then æˆ–è€… .catch å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡ï¼Œä½†è¿™é‡Œ Promise æ„é€ å‡½æ•°åªæ‰§è¡Œä¸€æ¬¡ã€‚æˆ–è€…è¯´ promise å†…éƒ¨çŠ¶æ€ä¸€ç»æ”¹å˜ï¼Œå¹¶ä¸”æœ‰äº†ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆåç»­æ¯æ¬¡è°ƒç”¨ .then æˆ–è€… .catch éƒ½ä¼šç›´æ¥æ‹¿åˆ°è¯¥å€¼ã€‚</p>
<h2 id="é¢˜ç›®å…­"><a href="#é¢˜ç›®å…­" class="headerlink" title="é¢˜ç›®å…­"></a>é¢˜ç›®å…­</h2><pre><code>Promise.resolve()
  .then(() =&gt; {
    return new Error(&apos;error!!!&apos;)
  })
  .then((res) =&gt; {
    console.log(&apos;then: &apos;, res)
  })
  .catch((err) =&gt; {
    console.log(&apos;catch: &apos;, err)
  })
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>then: Error: error!!!
    at Promise.resolve.then (...)
    at ...
</code></pre><p>è§£é‡Šï¼š.then æˆ–è€… .catch ä¸­ return ä¸€ä¸ª error å¯¹è±¡å¹¶ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œæ‰€ä»¥ä¸ä¼šè¢«åç»­çš„ .catch æ•è·ï¼Œéœ€è¦æ”¹æˆå…¶ä¸­ä¸€ç§ï¼š</p>
<ol>
<li>return Promise.reject(new Error(â€˜error!!!â€™))</li>
<li>throw new Error(â€˜error!!!â€™)</li>
</ol>
<p>å› ä¸ºè¿”å›ä»»æ„ä¸€ä¸ªé promise çš„å€¼éƒ½ä¼šè¢«åŒ…è£¹æˆ promise å¯¹è±¡ï¼Œå³ return new Error(â€˜error!!!â€™) ç­‰ä»·äº return Promise.resolve(new Error(â€˜error!!!â€™))ã€‚</p>
<h2 id="é¢˜ç›®ä¸ƒ"><a href="#é¢˜ç›®ä¸ƒ" class="headerlink" title="é¢˜ç›®ä¸ƒ"></a>é¢˜ç›®ä¸ƒ</h2><pre><code>const promise = Promise.resolve()
  .then(() =&gt; {
    return promise
  })
promise.catch(console.error)
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>TypeError: Chaining cycle detected for promise #&lt;Promise&gt;
    at &lt;anonymous&gt;
    at process._tickCallback (internal/process/next_tick.js:188:7)
    at Function.Module.runMain (module.js:667:11)
    at startup (bootstrap_node.js:187:16)
    at bootstrap_node.js:607:3
</code></pre><p>è§£é‡Šï¼š.then æˆ– .catch è¿”å›çš„å€¼ä¸èƒ½æ˜¯ promise æœ¬èº«ï¼Œå¦åˆ™ä¼šé€ æˆæ­»å¾ªç¯ã€‚ç±»ä¼¼äºï¼š</p>
<pre><code>process.nextTick(function tick () {
  console.log(&apos;tick&apos;)
  process.nextTick(tick)
})
</code></pre><h2 id="é¢˜ç›®å…«"><a href="#é¢˜ç›®å…«" class="headerlink" title="é¢˜ç›®å…«"></a>é¢˜ç›®å…«</h2><pre><code>Promise.resolve(1)
  .then(2)
  .then(Promise.resolve(3))
  .then(console.log)
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>1
</code></pre><p>è§£é‡Šï¼š.then æˆ–è€… .catch çš„å‚æ•°æœŸæœ›æ˜¯å‡½æ•°ï¼Œä¼ å…¥éå‡½æ•°åˆ™ä¼šå‘ç”Ÿå€¼ç©¿é€ã€‚</p>
<h2 id="é¢˜ç›®ä¹"><a href="#é¢˜ç›®ä¹" class="headerlink" title="é¢˜ç›®ä¹"></a>é¢˜ç›®ä¹</h2><pre><code>Promise.resolve()
  .then(function success (res) {
    throw new Error(&apos;error&apos;)
  }, function fail1 (e) {
    console.error(&apos;fail1: &apos;, e)
  })
  .catch(function fail2 (e) {
    console.error(&apos;fail2: &apos;, e)
  })
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>fail2: Error: error
    at success (...)
    at ...
</code></pre><p>è§£é‡Šï¼š.then å¯ä»¥æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¤„ç†æˆåŠŸçš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯å¤„ç†é”™è¯¯çš„å‡½æ•°ã€‚.catch æ˜¯ .then ç¬¬äºŒä¸ªå‚æ•°çš„ç®€ä¾¿å†™æ³•ï¼Œä½†æ˜¯å®ƒä»¬ç”¨æ³•ä¸Šæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼š.then çš„ç¬¬äºŒä¸ªå¤„ç†é”™è¯¯çš„å‡½æ•°æ•è·ä¸äº†ç¬¬ä¸€ä¸ªå¤„ç†æˆåŠŸçš„å‡½æ•°æŠ›å‡ºçš„é”™è¯¯ï¼Œè€Œåç»­çš„ .catch å¯ä»¥æ•è·ä¹‹å‰çš„é”™è¯¯ã€‚å½“ç„¶ä»¥ä¸‹ä»£ç ä¹Ÿå¯ä»¥ï¼š</p>
<pre><code>Promise.resolve()
  .then(function success1 (res) {
    throw new Error(&apos;error&apos;)
  }, function fail1 (e) {
    console.error(&apos;fail1: &apos;, e)
  })
  .then(function success2 (res) {
  }, function fail2 (e) {
    console.error(&apos;fail2: &apos;, e)
  })
</code></pre><h2 id="é¢˜ç›®å"><a href="#é¢˜ç›®å" class="headerlink" title="é¢˜ç›®å"></a>é¢˜ç›®å</h2><pre><code>process.nextTick(() =&gt; {
  console.log(&apos;nextTick&apos;)
})
Promise.resolve()
  .then(() =&gt; {
    console.log(&apos;then&apos;)
  })
setImmediate(() =&gt; {
  console.log(&apos;setImmediate&apos;)
})
console.log(&apos;end&apos;)
</code></pre><p>è¿è¡Œç»“æœï¼š</p>
<pre><code>end
nextTick
then
setImmediate
</code></pre><p>è§£é‡Šï¼šprocess.nextTick å’Œ promise.then éƒ½å±äº microtasksï¼Œè€Œ setImmediate å±äº macrotasksï¼Œåœ¨äº‹ä»¶å¾ªç¯çš„ check é˜¶æ®µæ‰§è¡Œã€‚äº‹ä»¶å¾ªç¯çš„æ¯ä¸ªé˜¶æ®µï¼ˆmacrotasksï¼‰ä¹‹é—´éƒ½ä¼šæ‰§è¡Œ microtasksï¼Œäº‹ä»¶å¾ªç¯çš„å¼€å§‹ä¼šå…ˆæ‰§è¡Œä¸€æ¬¡ microtasksã€‚</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/11/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/13/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/tx.jpg" alt="ææ–Œ">
            
              <p class="site-author-name" itemprop="name">ææ–Œ</p>
              <p class="site-description motion-element" itemprop="description">æƒ³è¦é£å¾—é«˜ï¼Œé‚£å°±æŠŠåœ°å¹³çº¿å¿˜æ‰</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">156</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">111</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/libin1991" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/57e737f6c4c971005f6bcd8d" target="_blank" title="juejin">
                      
                        <i class="fa fa-fw fa-spinner"></i>juejin</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ææ–Œ</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
<script type="text/javascript" src="/js/src/clicklove.js"></script>

