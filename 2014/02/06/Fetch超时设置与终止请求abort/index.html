<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="fetchè¯·æ±‚å’Œajaxè¯·æ±‚   fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯” ES6ä¸­æ–°å¢äº†ä¸€ç§HTTPæ•°æ®è¯·æ±‚çš„æ–¹å¼ï¼Œå°±æ˜¯fetchï¼Œå®ƒå’ŒXMLHttpRequestæœ‰è®¸å¤šç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç›¸æ¯”XMLHttpRequest,fetchè¢«è®¾è®¡æˆæ›´å…·å¯æ‰©å±•æ€§å’Œé«˜æ•ˆæ€§ã€‚æ±Ÿæ¹–ä¸Šä¸€ç›´æµä¼ ç€ â€œä¼ ç»Ÿajaxå·²æ­»ï¼Œfetchæ°¸ç”Ÿâ€çš„è¯´æ³•ï¼Œä¸‹é¢è¯¦ç»†è¯´ä¸‹äºŒè€…  1234567891011121314r">
<meta property="og:type" content="article">
<meta property="og:title" content="Fetchè¶…æ—¶è®¾ç½®ä¸ç»ˆæ­¢è¯·æ±‚abort">
<meta property="og:url" content="http://yoursite.com/2014/02/06/Fetchè¶…æ—¶è®¾ç½®ä¸ç»ˆæ­¢è¯·æ±‚abort/index.html">
<meta property="og:site_name" content="å•·å“©å’¯å•·">
<meta property="og:description" content="fetchè¯·æ±‚å’Œajaxè¯·æ±‚   fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯” ES6ä¸­æ–°å¢äº†ä¸€ç§HTTPæ•°æ®è¯·æ±‚çš„æ–¹å¼ï¼Œå°±æ˜¯fetchï¼Œå®ƒå’ŒXMLHttpRequestæœ‰è®¸å¤šç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç›¸æ¯”XMLHttpRequest,fetchè¢«è®¾è®¡æˆæ›´å…·å¯æ‰©å±•æ€§å’Œé«˜æ•ˆæ€§ã€‚æ±Ÿæ¹–ä¸Šä¸€ç›´æµä¼ ç€ â€œä¼ ç»Ÿajaxå·²æ­»ï¼Œfetchæ°¸ç”Ÿâ€çš„è¯´æ³•ï¼Œä¸‹é¢è¯¦ç»†è¯´ä¸‹äºŒè€…  1234567891011121314r">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-02-06T13:53:16.511Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fetchè¶…æ—¶è®¾ç½®ä¸ç»ˆæ­¢è¯·æ±‚abort">
<meta name="twitter:description" content="fetchè¯·æ±‚å’Œajaxè¯·æ±‚   fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯” ES6ä¸­æ–°å¢äº†ä¸€ç§HTTPæ•°æ®è¯·æ±‚çš„æ–¹å¼ï¼Œå°±æ˜¯fetchï¼Œå®ƒå’ŒXMLHttpRequestæœ‰è®¸å¤šç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç›¸æ¯”XMLHttpRequest,fetchè¢«è®¾è®¡æˆæ›´å…·å¯æ‰©å±•æ€§å’Œé«˜æ•ˆæ€§ã€‚æ±Ÿæ¹–ä¸Šä¸€ç›´æµä¼ ç€ â€œä¼ ç»Ÿajaxå·²æ­»ï¼Œfetchæ°¸ç”Ÿâ€çš„è¯´æ³•ï¼Œä¸‹é¢è¯¦ç»†è¯´ä¸‹äºŒè€…  1234567891011121314r">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2014/02/06/Fetchè¶…æ—¶è®¾ç½®ä¸ç»ˆæ­¢è¯·æ±‚abort/">





  <title>Fetchè¶…æ—¶è®¾ç½®ä¸ç»ˆæ­¢è¯·æ±‚abort | å•·å“©å’¯å•·</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband">
    	<div class="eevee"><div class="body"><div class="head"><div class="ears"><div class="ear"><div class="lobe"></div></div><div class="ear"><div class="lobe"></div></div></div><div class="face"><div class="eyes"><div class="eye"><div class="eyelid"></div></div><div class="eye"><div class="eyelid"></div></div></div><div class="nose"></div><div class="mouth"></div></div></div><div class="chest"><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div><div class="fur"><div class="patch"></div></div></div><div class="legs"><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div><div class="leg"><div class="inner-leg"></div></div></div><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail"><div class="tail -end"></div></div></div></div></div></div></div></div>
    </div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
    	<div id="sky">
				<div id="background" class="container">
			<!-- svg file -->
			<svg id="svgout" height="100%" width="100%" viewbox="0 0 550 400">
				<defs>
					<g id="bottomShadow">
						<path fill="#000000" stroke="none" d="
		M 270.5 225.95
		L 127.35 316.65 266.8 400 409.6 309.25 270.5 225.95 Z"/>
					</g>
					<g id="Layer52_0_FILL">
						<path class="topGrass" fill="#B9D668" stroke="none" d="
	M 397.85 229.3
	L 397.85 225.6 269.85 152 135.75 228.6 135.75 233.65 262.1 306.55 397.85 229.3 Z"/>
					</g>
					<g id="Layer51_0_FILL">
						<path class="leftSideGrass" fill="#6E9E4F" stroke="none" d="
	M 135.1 229.95
	L 135.1 256.85 262.1 328.4 262.1 301.85 135.1 229.95 Z"/>
					</g>
					<g id="Layer50_0_FILL">
						<path class="rightGrassTop" fill="#8CB154" stroke="none" d="
	M 397.85 225.95
	L 395.8 225.95 261.75 301.55 261.75 328.4 397.85 251.15 397.85 225.95 Z"/>
					</g>
					<g id="Layer48_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.45 282.4
	L 135.75 298.15 262.1 372.1 261.75 355.65 135.45 282.4 Z"/>
					</g>
					<g id="Layer47_0_FILL">
						<path class="middleLeftCrust" fill="#C77E61" stroke="none" d="
	M 135.1 270.3
	L 135.1 283.05 275.9 364.35 271.85 348.9 135.1 270.3 Z"/>
					</g>
					<g id="Layer46_0_FILL">
						<path class="crustLeftTop" fill="#955541" stroke="none" d="
	M 135.1 255.15
	L 135.1 270.3 262.1 343.55 262.1 328.05 135.1 255.15 Z"/>
					</g>
					<g id="Layer45_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 294.5
	L 397.5 277 261.75 355.3 261.75 372.75 397.5 294.5 Z"/>
					</g>
					<g id="Layer44_0_FILL">
						<path class="middleRightCrust" fill="#C89451" stroke="none" d="
	M 397.5 269.95
	L 397.15 266.6 262.1 343.2 262.1 355.95 397.5 279.7 397.5 269.95 Z"/>
					</g>
					<g id="Layer43_0_FILL">
						<path class="topRightCrust" fill="#A47237" stroke="none" d="
	M 397.5 266.6
	L 397.5 250.45 261.75 328.4 261.75 343.85 397.5 266.6 Z"/>
					</g>
					<g id="Layer41_0_FILL">
						<path class="greyRoad" fill="#B2B2B1" stroke="none" d="
	M 295.05 283.05
	Q 299.05 280.35 308.45 275.3 317.85 269.95 323.6 266.9
	L 268.8 233.65 338.05 191.35 309.15 174.55 177.75 254.5
	Q 191.55 262.2 198.25 266.25 204.65 269.95 209.7 271.95
	L 241.6 250.45 295.05 283.05 Z"/>
					</g>
					<g id="Layer40_0_FILL">
						<path fill="#FFFFFF" stroke="none" d="
	M 199.95 256.85
	Q 194.55 261.2 191.9 262.2
	L 194.9 263.9 200.95 259.2 199.95 256.85
	M 225.8 243.75
	L 224.8 241.75 211.05 250.8 212.05 252.8 225.8 243.75
	M 308.15 275.65
	L 296.7 266.6 295.35 268.6 306.8 277.7 308.15 275.65
	M 275.9 253.5
	L 274.55 255.5 285.95 264.55 287.3 262.55 275.9 253.5
	M 251.7 227.3
	L 250.7 225.25 236.9 234.35 237.9 236.35 251.7 227.3
	M 257.05 240.7
	L 254.05 240.7 268.8 249.8 269.5 247.75 257.05 240.7
	M 277.2 207.8
	L 263.45 216.85 264.45 218.9 278.25 209.8 277.2 207.8
	M 305.1 192.65
	L 304.1 190.65 290.3 199.75 291.35 201.75 305.1 192.65 Z"/>
					</g>
					<g id="Layer38_0_FILL">
						<path class="frontFascia" fill="#ECB27B" stroke="none" d="
	M 359.25 187.95
	L 346.4 174.95 333.85 202.9 359.25 187.95 Z"/>
					</g>
					<g id="Layer37_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 334 201.05
	L 334.35 232 359.2 217.55 359.25 187.95 334 201.05 Z"/>
					</g>
					<g id="Layer36_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 334.35 232.3
	L 334.35 205.1 305.1 191.35 305.1 216.85 334.35 232.3 Z"/>
					</g>
					<g id="Layer35_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 329.7 167.9
	L 331.05 167.9 344.55 176.7 347.85 176.7 363 192.25 363.15 189.55 350.65 176.7 350.55 176.7 334.25 167.5 334.25 159.1 329.7 159.1 329.7 164.9 322.65 160.95 322.3 162.15 329.7 167 329.7 167.9 Z"/>
					</g>
					<g id="Layer34_0_FILL">
						<path class="leftRoof" fill="#F2563B" stroke="none" d="
	M 334.05 207.05
	L 350.65 176.7 322.1 160.45 302.1 192.05 334.05 207.05 Z"/>
					</g>
					<g id="Layer30_0_FILL">
						<path id="windowFour" class="windows" stroke="none" fill="#975A42" d="
	M 341.35 203.3
	Q 340.9 203.45 340.5 203.8 340.1 204.2 339.85 204.75 339.7 205 339.7 205.3 339.6 205.75 339.7 206.1 339.7 206.15 339.7 206.2 339.8 206.5 340 206.8 340.55 207.4 341.45 207.4 342.35 207.4 343 206.8 343.4 206.5 343.65 206.1 343.85 205.75 343.95 205.3 344.05 204.4 343.55 203.8 343.3 203.45 343 203.3 342.65 203.15 342.2 203.15 341.8 203.15 341.35 203.3
	M 355.85 198.45
	Q 355.8 198.2 355.6 198 355.1 197.4 354.2 197.4 353.35 197.4 352.6 198 351.85 198.65 351.7 199.55 351.7 199.7 351.7 199.85 351.6 200.5 352 201.05 352.55 201.65 353.45 201.65 354.3 201.65 355.05 201.05 355.45 200.7 355.7 200.25 355.8 200.05 355.9 199.85 355.95 199.7 355.95 199.55 356.05 198.95 355.85 198.45 Z"/>
						<path class="door" fill="#B65041" stroke="none" d="
	M 351.95 211.2
	L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2
	M 351.2 211.2
	L 351.35 211.2 351.35 211.1 351.2 211.2 Z"/>
					</g>
					<g>
						<path id="Layer30_0_FILL" fill="#000000" fill-opacity="1" stroke="none" d="
	M 183.7 215.3
	L 183.7 215.6
	Q 187.25 231.75 212.25 234.35
	L 183.7 215.3 Z"/>
					</g>
					<g id="Layer29_0_FILL">
						<path fill="#000000" fill-opacity="0.4" stroke="none" d="
	M 305.1 216.85
	L 305.15 217.2
	Q 309.45 233.2 334.35 232.3
	L 305.1 216.85 Z"/>
					</g>
					<g id="Layer27_0_FILL">
						<path class="vegetation" fill="#78A950" stroke="none" d="
	M 177.45 231.65
	Q 175.75 235.35 181.8 239.35 185.5 235.7 185.15 231.3 182.8 230.65 181.45 234 179.45 231.3 177.45 231.65
	M 236.9 266.6
	Q 235.2 270.3 241.25 274.3 244.95 270.6 244.65 266.25 242.3 265.6 240.95 268.95 238.9 266.25 236.9 266.6
	M 254.7 277
	Q 253.05 280.7 259.1 284.75 262.75 281.05 262.45 276.65 260.1 276 258.75 279.35 256.7 276.65 254.7 277
	M 315.5 245.75
	Q 313.5 243.05 311.5 243.4 309.8 247.1 315.85 251.15 319.55 247.45 319.2 243.05 316.85 242.4 315.5 245.75
	M 295.35 232.65
	Q 293.7 236.35 299.75 240.4 303.45 236.7 303.1 232.3 300.75 231.65 299.4 235 297.4 232.3 295.35 232.65
	M 277.2 171.85
	Q 275.55 175.55 281.6 179.55 285.3 175.85 284.95 171.5 282.6 170.85 281.25 174.2 279.25 171.5 277.2 171.85 Z"/>
					</g>
					<g id="Layer26_0_FILL">
						<path class="treeWood" fill="#AE663D" stroke="none" d="
	M 175.1 177.55
	L 172.05 177.55 172.05 191.1 159.3 172.85
	Q 154.6 171.5 172.05 195.7
	L 172.05 212.5 175.1 212.5 175.1 177.55
	M 252.7 151.35
	L 249 151.35 249 176.9 252.7 176.9 252.7 151.35 Z"/>
					</g>
					<g id="Layer25_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 192.55 179.55
	Q 200.95 173.5 200.95 165.1 200.95 156.4 192.55 150 184.15 144.3 172.05 144.3 160.3 144.3 151.9 150 143.15 156.4 143.15 165.1 143.15 173.5 151.9 179.55 160.3 185.95 172.05 185.95 184.15 185.95 192.55 179.55
	M 236.25 106.65
	Q 230.2 116.05 230.2 129.15 230.2 142.25 236.25 151.35 242.3 160.75 250.7 160.75 258.75 160.75 264.8 151.35 270.85 142.25 270.85 129.15 270.85 116.05 264.8 106.65 258.75 97.6 250.7 97.6 242.3 97.6 236.25 106.65 Z"/>
					</g>
					<g id="Layer24_0_FILL">
						<path class="vegetation" fill="#77A951" stroke="none" d="
	M 158.3 221.9
	Q 160.65 221.9 161.95 220.2 163 219.55 163.3 218.55 164.65 218.9 166.35 218.9 170.05 218.9 172.4 216.2 175.1 213.85 175.1 210.15 175.1 206.45 172.4 203.75 170.05 201.4 166.35 201.4 162.65 201.4 159.95 203.75 157.6 206.45 157.6 210.15 157.6 210.8 157.6 211.15 155.95 211.5 154.6 212.5 152.9 214.15 152.9 216.55 152.9 218.9 154.6 220.2 156.25 221.9 158.3 221.9
	M 338.35 240.05
	Q 341.05 237.7 341.05 234 341.05 230.3 338.35 227.6 336 225.25 332.3 225.25 328.65 225.25 325.95 227.6 323.6 230.3 323.6 234 323.6 237.7 325.95 240.05 328.65 242.75 332.3 242.75 336 242.75 338.35 240.05 Z"/>
					</g>
					<g id="Layer22_0_FILL">
						<path class="rightRoof" fill="#D05041" stroke="none" d="
	M 220 173.85
	L 236.8 186.7 264.35 171.15 244.5 159.55 220 173.85 Z"/>
					</g>
					<g id="Layer21_0_FILL">
						<path class="leftWall" fill="#C57F42" stroke="none" d="
	M 212.25 191.35
	L 183.35 172.3 183.7 215.3 212.25 234.35 212.25 191.35 Z"/>
					</g>
					<g id="Layer20_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 192.1 149.85
	L 236.45 174.8 243.1 171.4
	Q 220.05 150.55 196.3 139.95
	L 192.1 149.85 Z"/>
					</g>
					<g id="Layer19_0_FILL">
						<path class="frontFascia" fill="#EBB17B" stroke="none" d="
	M 226.85 160.95
	L 212 190.6 229.75 192.6 239.75 172.85 226.85 160.95 Z"/>
					</g>
					<g id="Layer18_0_FILL">
						<path class="frontWall" fill="#EFA258" stroke="none" d="
	M 240.15 172.65
	L 211.9 191.6 212.25 233.65 264.35 201.7 264.35 170.8 240.8 184.45 240.15 172.65 Z"/>
					</g>
					<g id="Layer17_0_FILL">
						<path class="rightRoof" fill="#EF4427" stroke="none" d="
	M 210.9 142.2
	L 205.9 142.2 205.9 152.65 210.9 152.65 210.9 142.2 Z"/>
					</g>
					<g>
						<path id="Layer16_0_FILL" class="leftRoof" fill="#F2563B" stroke="none" d="
	M 210.25 195.5
	L 227.4 160.95 195.45 141.35 177.65 175.85 210.25 195.5 Z"/>
					</g>
					<g>
						<path id="sun" fill="#E3BD0E" stroke="none" d="
	M 257.05 15.95
	Q 251.7 15.95 248 19.65 244.3 23.35 244.3 28.7 244.3 34.1 248 37.8 251.7 41.5 257.05 41.5 262.45 41.5 266.15 37.8 269.85 34.1 269.85 28.7 269.85 23.35 266.15 19.65 262.45 15.95 257.05 15.95 Z"/>
					</g>
					<g id="Layer8_0_FILL">
						<path fill="#975A42" stroke="none" d="
	M 238.45 189.65
	Q 238.295703125 189.362109375 238.05 189.1 237.35 188.3 236.2 188.3 235.05 188.3 234.15 189.1 233.3 189.9 233.2 191.05 233.1 192.2 233.8 193 234.55 193.8 235.7 193.8 236.85 193.8 237.7 193 238.1970703125 192.558203125 238.45 192 238.6552734375 191.56484375 238.7 191.05 238.7671875 190.276953125 238.45 189.65
	M 220.55 197.55
	Q 220 197.55 219.5 197.75 218.95 197.95 218.5 198.35 217.933203125 198.8833984375 217.7 199.55 217.5833984375 199.916796875 217.55 200.3 217.4923828125 200.96171875 217.7 201.5 217.852734375 201.9103515625 218.15 202.25 218.95 203.05 220.1 203.05 221.25 203.05 222.05 202.25 222.95 201.45 223.05 200.3 223.15 199.15 222.4 198.35 222.05 197.95 221.65 197.75 221.15 197.55 220.55 197.55 Z"/>
					</g>
					<g id="Layer7_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 233.55 206.75
	L 225.9 211.95 226.25 225.5 233.95 220.35 233.55 206.75 Z"/>
					</g>
					<g>
						<path id="windowOne" class="windows" fill="#975A42" stroke="none" d="
	M 188.65 198.4
	L 188.8 204.1 198.65 210.45 198.55 204.75 188.65 198.4
	M 208.45 216.8
	L 208.35 211.1 198.55 204.75 198.65 210.45 208.45 216.8
	M 188.8 204.1
	L 188.95 209.8 198.8 216.15 198.65 210.45 188.8 204.1
	M 208.6 222.5
	L 208.45 216.8 198.65 210.45 198.8 216.15 208.6 222.5 Z"/>
					</g>
					<g>
						<path id="windowThree" class="windows" fill="#975A42" stroke="none" d="
	M 311.7 214.1
	L 318.55 217.55 318.45 211.9 311.6 208.45 311.7 214.1
	M 325.4 221
	L 325.25 215.35 318.45 211.9 318.55 217.55 325.4 221
	M 318.4 206.2
	L 311.5 202.75 311.6 208.45 318.45 211.9 318.4 206.2
	M 325.25 215.35
	L 325.2 209.7 318.4 206.2 318.45 211.9 325.25 215.35 Z"/>
					</g>
					<g id="Layer2_0_FILL">
						<path class="door" fill="#B65041" stroke="none" d="
	M 259.7 183.25
	L 244.6 191.9 244.6 213.8 259.7 204.55 259.7 183.25 Z"/>
					</g>
					<path id="windowTwo" fill="#975A42" class="windows" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" d="
	M 223.05 200.3
	Q 222.95 201.45 222.05 202.25 221.25 203.05 220.1 203.05 218.95 203.05 218.15 202.25 217.852734375 201.9103515625 217.7 201.5 217.4923828125 200.96171875 217.55 200.3 217.5833984375 199.916796875 217.7 199.575 217.933203125 198.8833984375 218.5 198.35 218.95 197.95 219.5 197.75 220 197.55 220.55 197.55 221.15 197.55 221.65 197.75 222.05 197.95 222.4 198.35 223.15 199.15 223.05 200.3 Z
	M 238.7 191.05
	Q 238.6552734375 191.56484375 238.45 192 238.1970703125 192.558203125 237.7 193 236.85 193.8 235.7 193.8 234.55 193.8 233.8 193 233.1 192.2 233.2 191.05 233.3 189.9 234.15 189.1 235.05 188.3 236.2 188.3 237.35 188.3 238.05 189.1 238.295703125 189.362109375 238.45 189.65 238.7671875 190.276953125 238.7 191.05 Z"/>
					<path fill="#F2563B" stroke="none" d=" M 351.95 211.2 L 351.8 211.2 346.05 215.1 346.05 225.2 351.95 221.6 351.95 211.2 Z"/>
					<path id="Layer6_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 198.55 204.75
	L 208.35 211.1 208.45 216.8 208.6 222.5 198.8 216.15 188.95 209.8 188.8 204.1 188.65 198.4 198.55 204.75 198.65 210.45 208.45 216.8
	M 198.8 216.15
	L 198.65 210.45 188.8 204.1"/>
					<path id="Layer5_0_1_STROKES" class="windowRims" stroke="#AE663D" stroke-width="1" stroke-linejoin="round" stroke-linecap="round" fill="none" d="
	M 325.25 215.35
	L 325.4 221 318.55 217.55 311.7 214.1 311.6 208.45 311.5 202.75 318.4 206.2 325.2 209.7 325.25 215.35 318.45 211.9 318.55 217.55
	M 318.4 206.2
	L 318.45 211.9 311.6 208.45"/>
				</defs>
				<g id="shadow">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use xlink:href="#bottomShadow"/>
					</g>
				</g>
				<g transform="matrix( 1, 0, 0, 1, 0,0) ">
					<use xlink:href="#sun"/>
				</g>
				<g id="earth">
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer52_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer51_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer50_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer48_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer47_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer46_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer45_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer44_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer43_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer41_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer40_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer38_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer37_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer36_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer35_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer34_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowFour"/>
						<use class="element" xlink:href="#Layer32_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer30_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer27_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer26_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer25_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer24_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer22_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer21_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer20_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer19_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer18_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer17_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer16_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer8_0_FILL"/>
						<use class="element" xlink:href="#windowTwo"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer7_0_FILL"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowOne"/>
						<use class="element" xlink:href="#Layer6_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#windowThree"/>
						<use class="element" xlink:href="#Layer5_0_1_STROKES"/>
					</g>
					<g transform="matrix( 1, 0, 0, 1, 0,0) ">
						<use class="element" xlink:href="#Layer2_0_FILL"/>
					</g>
				</g>
			</svg>
			<! -- End of SVG file -->
			<! -- Moon/Sun Toggle -->
			<div id="toggleButton" class="day-toggle">
				<div class="sun-icon"></div>
				<label class="switch">
            <input id="toggleCheckbox" type="checkbox">
            <div class="slider"></div>
        </label>
				<div class="cloud-icon"></div>
			</div>
			<! -- Moon/Sun Toggle -->
			<! -- End of Container -->
		</div>
			</div>
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">å•·å“©å’¯å•·</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">æ‰“å·¥ï¼Œ æ‰“å·¥æ˜¯ä¸å¯èƒ½æ‰“å·¥çš„ï¼Œ è¿™è¾ˆå­éƒ½ä¸å¯èƒ½æ‰“å·¥çš„ï¼</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            æœç´¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="æœç´¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2014/02/06/Fetchè¶…æ—¶è®¾ç½®ä¸ç»ˆæ­¢è¯·æ±‚abort/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ææ–Œ">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/tx.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="å•·å“©å’¯å•·">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Fetchè¶…æ—¶è®¾ç½®ä¸ç»ˆæ­¢è¯·æ±‚abort</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2014-02-06T17:18:23+08:00">
                2014-02-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="fetchè¯·æ±‚å’Œajaxè¯·æ±‚-fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯”"><a href="#fetchè¯·æ±‚å’Œajaxè¯·æ±‚-fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯”" class="headerlink" title="fetchè¯·æ±‚å’Œajaxè¯·æ±‚   fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯”"></a>fetchè¯·æ±‚å’Œajaxè¯·æ±‚   <a href="https://segmentfault.com/a/1190000013927644" target="_blank" rel="noopener">fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯”</a></h3><blockquote>
<p>ES6ä¸­æ–°å¢äº†ä¸€ç§HTTPæ•°æ®è¯·æ±‚çš„æ–¹å¼ï¼Œå°±æ˜¯fetchï¼Œå®ƒå’ŒXMLHttpRequestæœ‰è®¸å¤šç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯ç›¸æ¯”XMLHttpRequest,fetchè¢«è®¾è®¡æˆæ›´å…·å¯æ‰©å±•æ€§å’Œé«˜æ•ˆæ€§ã€‚æ±Ÿæ¹–ä¸Šä¸€ç›´æµä¼ ç€ â€œä¼ ç»Ÿajaxå·²æ­»ï¼Œfetchæ°¸ç”Ÿâ€çš„è¯´æ³•ï¼Œä¸‹é¢è¯¦ç»†è¯´ä¸‹äºŒè€…</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">response.arrayBuffer()</span><br><span class="line">è¯»å– Responseå¯¹è±¡å¹¶ä¸”å°†å®ƒè®¾ç½®ä¸ºå·²è¯»ï¼ˆå› ä¸ºResponseså¯¹è±¡è¢«è®¾ç½®ä¸ºäº† stream çš„æ–¹å¼ï¼Œæ‰€ä»¥å®ƒä»¬åªèƒ½è¢«è¯»å–ä¸€æ¬¡ï¼‰ ,å¹¶è¿”å›ä¸€ä¸ªè¢«è§£æä¸º<span class="built_in">ArrayBuffer</span>æ ¼å¼çš„promiseå¯¹è±¡</span><br><span class="line"></span><br><span class="line">response.blob()</span><br><span class="line">è¯»å– Responseå¯¹è±¡å¹¶ä¸”å°†å®ƒè®¾ç½®ä¸ºå·²è¯»ï¼ˆå› ä¸ºResponseså¯¹è±¡è¢«è®¾ç½®ä¸ºäº† stream çš„æ–¹å¼ï¼Œæ‰€ä»¥å®ƒä»¬åªèƒ½è¢«è¯»å–ä¸€æ¬¡ï¼‰ ,å¹¶è¿”å›ä¸€ä¸ªè¢«è§£æä¸ºBlobæ ¼å¼çš„promiseå¯¹è±¡</span><br><span class="line"></span><br><span class="line">response.formData()</span><br><span class="line">è¯»å–Responseå¯¹è±¡å¹¶ä¸”å°†å®ƒè®¾ç½®ä¸ºå·²è¯»ï¼ˆå› ä¸ºResponseså¯¹è±¡è¢«è®¾ç½®ä¸ºäº† stream çš„æ–¹å¼ï¼Œæ‰€ä»¥å®ƒä»¬åªèƒ½è¢«è¯»å–ä¸€æ¬¡ï¼‰ ,å¹¶è¿”å›ä¸€ä¸ªè¢«è§£æä¸ºFormDataæ ¼å¼çš„promiseå¯¹è±¡</span><br><span class="line"></span><br><span class="line">response.json()</span><br><span class="line">è¯»å– Responseå¯¹è±¡å¹¶ä¸”å°†å®ƒè®¾ç½®ä¸ºå·²è¯»ï¼ˆå› ä¸ºResponseså¯¹è±¡è¢«è®¾ç½®ä¸ºäº† stream çš„æ–¹å¼ï¼Œæ‰€ä»¥å®ƒä»¬åªèƒ½è¢«è¯»å–ä¸€æ¬¡ï¼‰ ,å¹¶è¿”å›ä¸€ä¸ªè¢«è§£æä¸º<span class="built_in">JSON</span>æ ¼å¼çš„promiseå¯¹è±¡</span><br><span class="line"></span><br><span class="line">response.text()</span><br><span class="line">è¯»å– Responseå¯¹è±¡å¹¶ä¸”å°†å®ƒè®¾ç½®ä¸ºå·²è¯»ï¼ˆå› ä¸ºResponseså¯¹è±¡è¢«è®¾ç½®ä¸ºäº† stream çš„æ–¹å¼ï¼Œæ‰€ä»¥å®ƒä»¬åªèƒ½è¢«è¯»å–ä¸€æ¬¡ï¼‰ ,å¹¶è¿”å›ä¸€ä¸ªè¢«è§£æä¸ºUSVStringæ ¼å¼çš„promiseå¯¹è±¡</span><br></pre></td></tr></table></figure>
<ul>
<li>è¯­æ³•ç®€æ´ï¼Œæ›´åŠ è¯­ä¹‰åŒ–</li>
<li>åŸºäºæ ‡å‡† Promise å®ç°ï¼Œæ”¯æŒ async/await</li>
<li>åŒæ„æ–¹ä¾¿ï¼Œä½¿ç”¨ isomorphic-fetch</li>
<li><strong>fetch ä¸€ç›´æ²¡æœ‰ä¼ ç»Ÿçš„ XHR æ‰€æ‹¥æœ‰çš„ abort() ,setTimeoutè¶…æ—¶å›è°ƒ å’Œ onprogress åŠŸèƒ½</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fetch(url,&#123;</span><br><span class="line">           method:&apos;POST&apos;,    // method:&apos;PUT&apos;,     method:&apos;DELETE&apos;,   </span><br><span class="line">           headers:&#123;</span><br><span class="line">               &apos;Content-type&apos;:&apos;application/json&apos;// è®¾ç½®è¯·æ±‚å¤´æ•°æ®ç±»å‹</span><br><span class="line">           &#125;,</span><br><span class="line">           body:data</span><br><span class="line">       &#125;)</span><br><span class="line">       .then(res=&gt;res.json())</span><br><span class="line">       .then(data=&gt;console.log(data))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="fetchå¯ä»¥åœ¨headerä¸­è®¾ç½®CORSè·¨åŸŸ"><a href="#fetchå¯ä»¥åœ¨headerä¸­è®¾ç½®CORSè·¨åŸŸ" class="headerlink" title="fetchå¯ä»¥åœ¨headerä¸­è®¾ç½®CORSè·¨åŸŸ"></a>fetchå¯ä»¥åœ¨headerä¸­è®¾ç½®CORSè·¨åŸŸ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">var u = new URLSearchParams();</span><br><span class="line">u.append(&apos;method&apos;, &apos;flickr.interestingness.getList&apos;);</span><br><span class="line">u.append(&apos;api_key&apos;, &apos;&lt;insert api key here&gt;&apos;);</span><br><span class="line">u.append(&apos;format&apos;, &apos;json&apos;);</span><br><span class="line">u.append(&apos;nojsoncallback&apos;, &apos;1&apos;);</span><br><span class="line"></span><br><span class="line">fetch(url,&#123;</span><br><span class="line">            method:&apos;POST&apos;,</span><br><span class="line">            headers:u,</span><br><span class="line">            body:data</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(res=&gt;res.json())</span><br><span class="line">        .then(data=&gt;console.log(data))</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"> u.append(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);  </span><br><span class="line">    u.append(&quot;Access-Control-Allow-Headers&quot;, &quot;X-Requested-With&quot;);  </span><br><span class="line">    u.append(&quot;Access-Control-Allow-Methods&quot;,&quot;PUT,POST,GET,DELETE,OPTIONS&quot;);  </span><br><span class="line">    u.append(&quot;X-Powered-By&quot;,&apos; 3.2.1&apos;)</span><br></pre></td></tr></table></figure>
<h4 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h4><ul>
<li>1.æ˜¯XMLHTTPRequestçš„ä¸€ä¸ªå®ä¾‹ï¼Œéœ€è¦new</li>
<li>2.åªæœ‰å½“çŠ¶æ€ä¸º200æˆ–è€…304æ—¶æ‰ä¼šè¯·æ±‚æˆåŠŸ</li>
<li>3.æ ¼å¼é›¶æ•£ï¼Œå®¹æ˜“å‡ºç°å›è°ƒåœ°ç‹±çš„é—®é¢˜</li>
</ul>
<h3 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h3><ul>
<li>1.fetchæ˜¯åŸºäºpromiseå®ç°çš„ï¼Œä¹Ÿå¯ä»¥ç»“åˆasync/await</li>
<li>2.fetchè¯·æ±‚é»˜è®¤æ˜¯ä¸å¸¦cookieçš„ï¼Œéœ€è¦è®¾ç½®fetchï¼ˆURLï¼Œ{credentials:â€™includeâ€™})ã€‚ </li>
<li>Credentialsæœ‰ä¸‰ç§å‚æ•°ï¼šsame-originï¼Œincludeï¼Œ*</li>
<li>3.æœåŠ¡å™¨è¿”å›400 500 çŠ¶æ€ç æ—¶å¹¶ä¸ä¼šrejectï¼Œåªæœ‰ç½‘ç»œå‡ºé”™å¯¼è‡´è¯·æ±‚ä¸èƒ½å®Œæˆæ—¶ï¼Œfetchæ‰ä¼šè¢«reject</li>
<li>4.<strong>æ‰€æœ‰ç‰ˆæœ¬çš„ IE å‡ä¸æ”¯æŒåŸç”Ÿ Fetch</strong></li>
<li>5.fetchæ˜¯widowçš„ä¸€ä¸ªæ–¹æ³•,ä¸éœ€è¦new</li>
<li>6.<strong>fetch ä¸€ç›´æ²¡æœ‰ä¼ ç»Ÿçš„ XHR æ‰€æ‹¥æœ‰çš„ abort() ,setTimeoutè¶…æ—¶å›è°ƒ å’Œ onprogress åŠŸèƒ½</strong></li>
</ul>
<h3 id="fetchå’Œajax-çš„ä¸»è¦åŒºåˆ«"><a href="#fetchå’Œajax-çš„ä¸»è¦åŒºåˆ«" class="headerlink" title="fetchå’Œajax çš„ä¸»è¦åŒºåˆ«"></a>fetchå’Œajax çš„ä¸»è¦åŒºåˆ«</h3><ul>
<li>1ã€fetch()è¿”å›çš„promiseå°†ä¸ä¼šæ‹’ç»httpçš„é”™è¯¯çŠ¶æ€ï¼Œå³ä½¿å“åº”æ˜¯ä¸€ä¸ªHTTP 404æˆ–è€…500 </li>
<li>2ã€åœ¨é»˜è®¤æƒ…å†µä¸‹ fetchä¸ä¼šæ¥å—æˆ–è€…å‘é€cookies</li>
<li>3ã€æ‰€æœ‰çš„IEæµè§ˆå™¨éƒ½ä¸ä¼šæ”¯æŒ fetch()æ–¹æ³•</li>
<li>4ã€æœåŠ¡å™¨ç«¯è¿”å› çŠ¶æ€ç  400 500çš„æ—¶å€™ ä¸ä¼šreject</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fetch(url).then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> response.json()   <span class="comment">//æ‰§è¡ŒæˆåŠŸç¬¬ä¸€æ­¥</span></span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span> (<span class="params">returnedValue</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//æ‰§è¡ŒæˆåŠŸçš„ç¬¬äºŒæ­¥</span></span><br><span class="line">&#125;).catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//ä¸­é€”çš„ä»»ä½•åœ°æ–¹å‡ºé”™  éƒ½ä¼šåœ¨è¿™é‡Œè¢«æ•è·åˆ°</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>fetch çš„ç¬¬äºŒå‚æ•°ä¸­<br>1ã€é»˜è®¤çš„è¯·æ±‚ä¸ºgetè¯·æ±‚ å¯ä»¥ä½¿ç”¨method:post æ¥è¿›è¡Œé…ç½®<br>2ã€ç¬¬ä¸€æ­¥ä¸­çš„ responseæœ‰è®¸å¤šæ–¹æ³• json() text() formData()<br>3ã€Fetchè·¨åŸŸçš„æ—¶å€™é»˜è®¤ä¸ä¼šå¸¦cookie éœ€è¦æ‰‹åŠ¨çš„æŒ‡å®š credentials:â€™includeâ€™<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var promise=fetch(&apos;http://localhost:3000/news&apos;, &#123;</span><br><span class="line">       method: &apos;get&apos;</span><br><span class="line">   &#125;).then(function(response) &#123;</span><br><span class="line">            return  response.json()</span><br><span class="line">   &#125;).catch(function(err) &#123;</span><br><span class="line">       // Error :(</span><br><span class="line">   &#125;);</span><br><span class="line">   promise.then(function (data) &#123;</span><br><span class="line">         console.log(data)</span><br><span class="line">   &#125;).catch(function (error) &#123;</span><br><span class="line">       console.log(error)</span><br><span class="line">   &#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="fetchæ¨¡æ‹Ÿabortè¯·æ±‚-ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"><a href="#fetchæ¨¡æ‹Ÿabortè¯·æ±‚-ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥" class="headerlink" title="fetchæ¨¡æ‹Ÿabortè¯·æ±‚ ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"></a>fetchæ¨¡æ‹Ÿabortè¯·æ±‚ ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥</h3><blockquote>
<p>è¶…æ—¶è®¾ç½®<br>åŸç”Ÿçš„XMLHttpRequestå¯ä»¥è®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´çš„æ–¹æ³•å›è°ƒï¼›<br>ES6ä»¥åPromise å‡ºç°è§£å†³åœ°ç‹±å›è°ƒç­‰ä¸ä¼˜é›…çš„ä»£ç é£æ ¼ã€‚ä¸ªäººç†è§£è¿™ä¸ªæ›´åƒæ˜¯ä¸€ä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å…³ç³»ï¼ŒæŸ¥çœ‹ Promiseæ–‡æ¡£ï¼Œæœ‰ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•</p>
</blockquote>
<ul>
<li>Promise.race([promise1,promise2]) ä¼ å…¥å¤šä¸ªPromiseå¯¹è±¡ï¼Œç­‰å¾…æœ€å¿«å¯¹è±¡å®Œæˆ</li>
<li>Promise.all([promise1,promise2]) ä¼ å…¥å¤šä¸ªPromise å¯¹è±¡ï¼Œç­‰å¾…æ‰€æœ‰å¯¹è±¡å®Œæˆ</li>
</ul>
<p>æœ‰äº†ä»¥ä¸ŠçŸ¥è¯†å,ç»“åˆå‡½æ•°setTimeoutå°±å¯ä»¥å®ç°è¶…æ—¶è®¾ç½®<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//ahutor:herbert qq:464884492</span><br><span class="line">let timeoutPromise = (timeout) =&gt; &#123;</span><br><span class="line"> return new Promise((resolve, reject) =&gt; &#123;</span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">   resolve(&quot;æˆ‘æ˜¯ timeoutPromiseï¼Œå·²ç»å®Œæˆäº†&quot;);</span><br><span class="line">  &#125;, timeout);</span><br><span class="line"> &#125;);</span><br><span class="line">&#125;</span><br><span class="line">let requestPromise = (url) =&gt; &#123;</span><br><span class="line"> return fetch(url);</span><br><span class="line">&#125;;</span><br><span class="line">Promise.race([timeoutPromise(1000), requestPromise(&quot;https://www.baidu.com&quot;)])</span><br><span class="line"> .then(resp =&gt; &#123;</span><br><span class="line">  console.log(resp);</span><br><span class="line"> &#125;)</span><br><span class="line"> .catch(error =&gt; &#123;</span><br><span class="line">  console.log(error);</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure></p>
<h3 id="Ajaxä¸Comet"><a href="#Ajaxä¸Comet" class="headerlink" title="Ajaxä¸Comet"></a><a href="https://libin1991.github.io/2015/04/26/Ajax%E4%B8%8EComet/" target="_blank" rel="noopener">Ajaxä¸Comet</a></h3><blockquote>
<p>å¯ä»¥æ£€æµ‹XHRå¯¹è±¡çš„readyStateå±æ€§ï¼Œè¯¥å±æ€§è¡¨ç¤ºè¯·æ±‚/å“åº”è¿‡ç¨‹çš„å½“å‰æ´»åŠ¨é˜¶æ®µ</p>
</blockquote>
<ul>
<li>0ï¼šæœªåˆå§‹åŒ–ã€‚å°šæœªè°ƒç”¨open()æ–¹æ³•</li>
<li>1ï¼šå¯åŠ¨ã€‚å·²ç»è°ƒç”¨open()æ–¹æ³•ï¼Œä½†å°šæœªè°ƒç”¨send()æ–¹æ³•</li>
<li>2ï¼šå‘é€ã€‚å·²ç»è°ƒç”¨send()æ–¹æ³•ï¼Œä½†å°šæœªæ¥æ”¶åˆ°å“åº”</li>
<li>3ï¼šæ¥æ”¶ã€‚å·²ç»æ¥æ”¶åˆ°éƒ¨åˆ†å“åº”æ•°æ®</li>
<li>4ï¼šå®Œæˆã€‚å·²ç»æ¥æ”¶å…¨éƒ¨å“åº”æ•°æ®ï¼Œè€Œä¸”å·²ç»å¯ä»¥åœ¨å®¢æˆ·ç«¯ä½¿ç”¨äº†ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">function createXHR() &#123;</span><br><span class="line">   try &#123;</span><br><span class="line">     return new XMLHttpRequest();</span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">     return new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">var xhr = createXHR();     // return new XMLHttpRequest()     or     new ActiveXObject()        </span><br><span class="line">xhr.onreadystatechange = function(event)&#123;</span><br><span class="line">    // ä¸è¦ä½¿ç”¨thisï¼Œä½œç”¨åŸŸä¼šäº§ç”Ÿé—®é¢˜ï¼Œåœ¨éƒ¨åˆ†æµè§ˆå™¨ä¸­ä¼šæ‰§è¡Œå¤±è´¥</span><br><span class="line">    if (xhr.readyState == 4)&#123;</span><br><span class="line">        if ((xhr.status &gt;= 200 &amp;&amp; xhr.status &lt; 300) || xhr.status == 304)&#123;</span><br><span class="line">            console.log(xhr.responseText);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            console.log(&quot;Request was unsuccessful: &quot; + xhr.status);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// xhr.setRequestHeader(&quot;Content-Type&quot;, &quot;application/x-www-form-urlencoded&quot;);</span><br><span class="line"></span><br><span class="line">xhr.open(&quot;get&quot;, &quot;example.txt&quot;, true);</span><br><span class="line">xhr.send(null);</span><br></pre></td></tr></table></figure>
<h3 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–å¼‚æ­¥è¯·æ±‚å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getXhr</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> xhr=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</span><br><span class="line">            xhr=<span class="keyword">new</span> XMLHttprequest();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">// å¦‚æœæµè§ˆå™¨ç‰ˆæœ¬æ˜¯IE8ä»¥ä¸‹æµè§ˆå™¨</span></span><br><span class="line">            xhr=<span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHttp'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> xhr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// url:"urlè·¯å¾„"  type:è¯·æ±‚æ–¹å¼  data:è¯·æ±‚å‚æ•°ç±»å‹  dataTypeï¼šè¿”å›çš„å­—ç¬¦ä¸²ç±»å‹</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ajax</span>(<span class="params">&#123;url,type,data,dataType&#125;</span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">open,err</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//1. åˆ›å»ºå¼‚æ­¥è¯·æ±‚å¯¹è±¡</span></span><br><span class="line">	<span class="keyword">var</span> xhr=<span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">	<span class="comment">//2.ç»‘å®šç›‘å¬äº‹ä»¶</span></span><br><span class="line">	xhr.onreadystatechange=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="comment">// å½“å¼‚æ­¥è¯·æ±‚çŠ¶æ€å˜ä¸º4æ—¶ï¼Œå¹¶ä¸”è¿”å›çš„çŠ¶æ€ç ä¸º200ï¼Œæ¥æ”¶å“åº”æˆåŠŸ</span></span><br><span class="line">		<span class="keyword">if</span>(xhr.readyState==<span class="number">4</span>&amp;&amp;xhr.status==<span class="number">200</span>)&#123;</span><br><span class="line">			<span class="comment">// å½“è¿”å›æ¥æ”¶çš„å­—ç¬¦ä¸²ç±»å‹ä¸ºjsonä¸²æ—¶ï¼Œè‡ªåŠ¨è½¬æ¢jsonä¸²</span></span><br><span class="line">			<span class="keyword">if</span>(dataType!==<span class="literal">undefined</span></span><br><span class="line">				&amp;&amp;dataType.toLowerCase()===<span class="string">"json"</span>)</span><br><span class="line">				<span class="keyword">var</span> res=<span class="built_in">JSON</span>.parse(xhr.responseText)</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				<span class="comment">// å¦åˆ™ç›´æ¥è·å–è¿”å›çš„å“åº”æ–‡æœ¬ä¸­çš„å†…å®¹</span></span><br><span class="line">				<span class="keyword">var</span> res=xhr.responseText</span><br><span class="line">			<span class="comment">// é€šè¿‡Promiseï¼Œå°†è¿”å›çš„æ•°æ®å‘åä¼ é€’	</span></span><br><span class="line">			open(res);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// å¦‚æœè¯·æ±‚æ–¹å¼ä¸ºgetè¯·æ±‚ï¼Œåˆ™å°†è¯·æ±‚å‚æ•°æ‹¼æ¥åœ¨urlå</span></span><br><span class="line">	<span class="keyword">if</span>(type.toLowerCase()==<span class="string">"get"</span>&amp;&amp;data!=<span class="literal">undefined</span>)&#123;</span><br><span class="line">		url+=<span class="string">"?"</span>+data;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//3.æ‰“å¼€è¿æ¥</span></span><br><span class="line">	xhr.open(type,url,<span class="literal">true</span>);</span><br><span class="line">	<span class="comment">// å¦‚æœè¯·æ±‚æ–¹å¼ä¸ºpostè¯·æ±‚ï¼Œåˆ™ä¿®æ”¹è¯·æ±‚æ¶ˆæ¯å¤´</span></span><br><span class="line">	<span class="keyword">if</span>(type.toLowerCase()===<span class="string">"post"</span>)</span><br><span class="line">		<span class="comment">//å¢åŠ ï¼šè®¾ç½®è¯·æ±‚æ¶ˆæ¯å¤´</span></span><br><span class="line">		xhr.setRequestHeader(<span class="string">"Content-Type"</span>,<span class="string">"application/x-www-form-urlencoded"</span>);</span><br><span class="line">	<span class="comment">//4.å‘é€è¯·æ±‚</span></span><br><span class="line">	<span class="keyword">if</span>(type.toLowerCase()==<span class="string">"post"</span>&amp;&amp;data!==<span class="literal">undefined</span>)</span><br><span class="line">		xhr.send(data);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		xhr.send(<span class="literal">null</span>);&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="HTTPç¼“å­˜æœºåˆ¶-200è¿˜æ˜¯304"><a href="#HTTPç¼“å­˜æœºåˆ¶-200è¿˜æ˜¯304" class="headerlink" title="HTTPç¼“å­˜æœºåˆ¶(200è¿˜æ˜¯304)"></a><a href="https://libin1991.github.io/2018/11/22/HTTP%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6-200%E8%BF%98%E6%98%AF304/" target="_blank" rel="noopener">HTTPç¼“å­˜æœºåˆ¶(200è¿˜æ˜¯304)</a></h3><blockquote>
<p>Expires Cache-Control</p>
<ul>
<li>Cache-Control: no-cache å¿…é¡»å…ˆä¸ä»£ç†æœåŠ¡å™¨ç¡®è®¤æ˜¯å¦æ›´æ”¹ï¼Œç„¶ååœ¨åœ¨å†³å®šä½¿ç”¨ç¼“å­˜è¿˜æ˜¯è¯·æ±‚ï¼Œç±»ä¼¼äºåå•†ç¼“å­˜ï¼ˆ304ï¼‰</li>
<li>Cache-Control: no-store æ‰æ˜¯çœŸæ­£çš„ä¸ç¼“å­˜æ•°æ®åˆ°æœ¬åœ°</li>
<li>Cache-Control: public å¯ä»¥è¢«æ‰€æœ‰ç”¨æˆ·ç¼“å­˜ï¼ˆå¤šç”¨æˆ·å…±äº«ï¼‰ï¼ŒåŒ…æ‹¬ç»ˆç«¯å’ŒCDNç­‰ä¸­é—´ä»£ç†æœåŠ¡å™¨</li>
<li>Cache-Control: private åªèƒ½è¢«ç»ˆç«¯æµè§ˆå™¨ç¼“å­˜ï¼ˆè€Œä¸”æ˜¯ç§æœ‰ç¼“å­˜ï¼‰ï¼Œä¸å…è®¸ä¸­ç»§ç¼“å­˜æœåŠ¡å™¨è¿›è¡Œç¼“å­˜</li>
<li>Cache-Control: must-revalidateå¦‚æœç¼“å­˜å†…å®¹å¤±æ•ˆï¼Œè¯·æ±‚å¿…é¡»å‘é€æœåŠ¡å™¨è¿›è¡ŒéªŒè¯</li>
<li>Cache-Control: max-age=s ç¼“å­˜å†…å®¹åœ¨<strong>sç§’</strong>åå¤±æ•ˆï¼Œä»…HTTP1.1å¯ç”¨</li>
</ul>
</blockquote>
<h3 id="HTTPç¼“å­˜æœºåˆ¶åŠåŸç†"><a href="#HTTPç¼“å­˜æœºåˆ¶åŠåŸç†" class="headerlink" title="HTTPç¼“å­˜æœºåˆ¶åŠåŸç†"></a><a href="https://libin1991.github.io/2019/03/31/HTTP%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6%E5%8F%8A%E5%8E%9F%E7%90%86/" target="_blank" rel="noopener">HTTPç¼“å­˜æœºåˆ¶åŠåŸç†</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Expires</span><br><span class="line">Expiresæ˜¯http1.0æå‡ºçš„ä¸€ä¸ªè¡¨ç¤ºèµ„æºè¿‡æœŸæ—¶é—´çš„headerï¼Œå®ƒæè¿°çš„æ˜¯ä¸€ä¸ªç»å¯¹æ—¶é—´ï¼Œç”±æœåŠ¡å™¨è¿”å›ã€‚</span><br><span class="line">Expiresç¬¬äºŒæ¬¡è¯·æ±‚æ—¶ï¼Œå°†å’Œæœ¬åœ°æ—¶é—´æ¯”å¯¹ã€‚</span><br><span class="line">Expires ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨æ˜¯ï¼Œå“åº”å¤´ä¼šè¿”å›ä¸€ä¸ªExpiresçš„æ–‡ä»¶è¿‡æœŸæ—¶é—´ã€‚</span><br><span class="line">Expires ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨æœ¬åœ°æ—¶é—´å’Œæ–‡ä»¶çš„è¿‡æœŸæ—¶é—´è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ–‡ä»¶æœªè¿‡æœŸåˆ™ç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼Œ</span><br><span class="line">        è¿”å›çŠ¶æ€ç 200(from memory cache)æˆ–200(from disk cache)ã€‚</span><br></pre></td></tr></table></figure>
<h3 id="BFCæ˜¯ä»€ä¹ˆ"><a href="#BFCæ˜¯ä»€ä¹ˆ" class="headerlink" title="BFCæ˜¯ä»€ä¹ˆ"></a><a href="https://www.cnblogs.com/mlw1814011067/p/10397999.html" target="_blank" rel="noopener">BFCæ˜¯ä»€ä¹ˆ</a></h3><h3 id="ä»€ä¹ˆæ˜¯BFCï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯BFCï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯BFCï¼Ÿ"></a><a href="https://www.jianshu.com/p/0d713b32cd0d" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯BFCï¼Ÿ</a></h3><ul>
<li>æ ¹å…ƒç´ æˆ–å…¶å®ƒåŒ…å«å®ƒçš„å…ƒç´ </li>
<li>æµ®åŠ¨å…ƒç´  (å…ƒç´ çš„ float ä¸æ˜¯ none)</li>
<li>ç»å¯¹å®šä½å…ƒç´  (å…ƒç´ å…·æœ‰ position ä¸º absolute æˆ– fixed)</li>
<li>å†…è”å— (å…ƒç´ å…·æœ‰ display: inline-block)</li>
<li>è¡¨æ ¼å•å…ƒæ ¼ (å…ƒç´ å…·æœ‰ display: table-cellï¼ŒHTMLè¡¨æ ¼å•å…ƒæ ¼é»˜è®¤å±æ€§)</li>
<li>è¡¨æ ¼æ ‡é¢˜ (å…ƒç´ å…·æœ‰ display: table-caption, HTMLè¡¨æ ¼æ ‡é¢˜é»˜è®¤å±æ€§)</li>
<li>å…·æœ‰overflow ä¸”å€¼ä¸æ˜¯ visible çš„å—å…ƒç´ ï¼Œ</li>
<li>display: flow-root</li>
<li>column-span: all åº”å½“æ€»æ˜¯ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼Œå³ä¾¿å…·æœ‰ column-span: all çš„å…ƒç´ å¹¶ä¸è¢«åŒ…è£¹åœ¨ä¸€ä¸ªå¤šåˆ—å®¹å™¨ä¸­ã€‚</li>
<li>ä¸€ä¸ªå—æ ¼å¼åŒ–ä¸Šä¸‹æ–‡åŒ…æ‹¬åˆ›å»ºå®ƒçš„å…ƒç´ å†…éƒ¨æ‰€æœ‰å†…å®¹ï¼Œé™¤äº†è¢«åŒ…å«äºåˆ›å»ºæ–°çš„å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡çš„åä»£å…ƒç´ å†…çš„å…ƒç´ ã€‚</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">å“ªäº›å…ƒç´ ä¼šç”ŸæˆBFC?</span><br><span class="line">æ ¹å…ƒç´ </span><br><span class="line">floatå±æ€§ä¸ä¸ºnone</span><br><span class="line">positionä¸ºabsoluteæˆ–fixed</span><br><span class="line">displayä¸ºinline-block, table-cell, table-caption, flex, inline-flex</span><br><span class="line">overflowä¸ä¸ºvisible</span><br></pre></td></tr></table></figure>
<h3 id="BFCçš„å¸ƒå±€è§„åˆ™-ä»€ä¹ˆæ˜¯BFCï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†"><a href="#BFCçš„å¸ƒå±€è§„åˆ™-ä»€ä¹ˆæ˜¯BFCï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†" class="headerlink" title="BFCçš„å¸ƒå±€è§„åˆ™ ä»€ä¹ˆæ˜¯BFCï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†"></a>BFCçš„å¸ƒå±€è§„åˆ™ <a href="https://blog.csdn.net/sinat_36422236/article/details/88763187" target="_blank" rel="noopener">ä»€ä¹ˆæ˜¯BFCï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†</a></h3><h4 id="BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚"><a href="#BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚" class="headerlink" title="BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚"></a>BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚</h4><blockquote>
<p>BFCæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¸ƒå±€ç¯å¢ƒï¼Œå…¶ä¸­çš„å…ƒç´ å¸ƒå±€æ˜¯ä¸å—å¤–ç•Œçš„å½±å“ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ªBFCä¸­ï¼Œå—ç›’ä¸è¡Œç›’ï¼ˆè¡Œç›’ç”±ä¸€è¡Œä¸­æ‰€æœ‰çš„å†…è”å…ƒç´ æ‰€ç»„æˆï¼‰éƒ½ä¼šå‚ç›´çš„æ²¿ç€å…¶çˆ¶å…ƒç´ çš„è¾¹æ¡†æ’åˆ—ã€‚</p>
</blockquote>
<ul>
<li>å†…éƒ¨çš„Boxä¼šåœ¨å‚ç›´æ–¹å‘ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ”¾ç½®ã€‚</li>
<li>Boxå‚ç›´æ–¹å‘çš„è·ç¦»ç”±marginå†³å®šã€‚å±äºåŒä¸€ä¸ªBFCçš„ä¸¤ä¸ªç›¸é‚»Boxçš„marginä¼šå‘ç”Ÿé‡å ã€‚</li>
<li><p>æ¯ä¸ªç›’å­ï¼ˆå—ç›’ä¸è¡Œç›’ï¼‰çš„margin boxçš„å·¦è¾¹ï¼Œä¸åŒ…å«å—border boxçš„å·¦è¾¹ç›¸æ¥è§¦(å¯¹äºä»å·¦å¾€å³çš„æ ¼å¼åŒ–ï¼Œå¦åˆ™ç›¸å)ã€‚å³ä½¿å­˜åœ¨æµ®åŠ¨ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p>
</li>
<li><p>BFCçš„åŒºåŸŸä¸ä¼šä¸float boxé‡å ã€‚</p>
</li>
<li>BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚åä¹‹ä¹Ÿå¦‚æ­¤ã€‚</li>
<li>è®¡ç®—BFCçš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿå‚ä¸è®¡ç®—ã€‚</li>
</ul>
<h3 id="å¦‚ä½•åˆ›å»ºBFC"><a href="#å¦‚ä½•åˆ›å»ºBFC" class="headerlink" title="å¦‚ä½•åˆ›å»ºBFC"></a>å¦‚ä½•åˆ›å»ºBFC</h3><p>1ã€floatçš„å€¼ä¸æ˜¯noneã€‚<br>2ã€positionçš„å€¼ä¸æ˜¯staticæˆ–è€…relativeã€‚<br>3ã€displayçš„å€¼æ˜¯inline-blockã€table-cellã€flexã€table-captionæˆ–è€…inline-flex<br>4ã€overflowçš„å€¼ä¸æ˜¯visible</p>
<h3 id="BFCçš„ä½œç”¨"><a href="#BFCçš„ä½œç”¨" class="headerlink" title="BFCçš„ä½œç”¨"></a>BFCçš„ä½œç”¨</h3><p>1.åˆ©ç”¨BFCé¿å…marginé‡å ã€‚<br>2.è‡ªé€‚åº”ä¸¤æ å¸ƒå±€<br>3.æ¸…æ¥šæµ®åŠ¨</p>
<h3 id="ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"><a href="#ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥" class="headerlink" title="ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"></a>ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥</h3><h3 id="React-HOCçš„ä¸¤ç§å®è·µ"><a href="#React-HOCçš„ä¸¤ç§å®è·µ" class="headerlink" title="React HOCçš„ä¸¤ç§å®è·µ"></a><a href="https://www.jianshu.com/p/9cf91fb065bf" target="_blank" rel="noopener">React HOCçš„ä¸¤ç§å®è·µ</a></h3><h3 id="ä»-0-åˆ°-1-å®ç°-React-ç³»åˆ—-â€”â€”-5-PureComponent-å®ç°-amp-amp-HOC-æ¢å¹½"><a href="#ä»-0-åˆ°-1-å®ç°-React-ç³»åˆ—-â€”â€”-5-PureComponent-å®ç°-amp-amp-HOC-æ¢å¹½" class="headerlink" title="ä» 0 åˆ° 1 å®ç° React ç³»åˆ— â€”â€” 5.PureComponent å®ç° &amp;&amp; HOC æ¢å¹½"></a><a href="https://www.cnblogs.com/MuYunyun/p/9541455.html" target="_blank" rel="noopener">ä» 0 åˆ° 1 å®ç° React ç³»åˆ— â€”â€” 5.PureComponent å®ç° &amp;&amp; HOC æ¢å¹½</a></h3><h3 id="reacté«˜é˜¶ç»„ä»¶çš„ç†è§£"><a href="#reacté«˜é˜¶ç»„ä»¶çš„ç†è§£" class="headerlink" title="reacté«˜é˜¶ç»„ä»¶çš„ç†è§£"></a><a href="http://www.bubuko.com/infodetail-2517494.html" target="_blank" rel="noopener">reacté«˜é˜¶ç»„ä»¶çš„ç†è§£</a></h3><h3 id="Reactè¿›é˜¶ä¹‹é«˜é˜¶ç»„ä»¶"><a href="#Reactè¿›é˜¶ä¹‹é«˜é˜¶ç»„ä»¶" class="headerlink" title="Reactè¿›é˜¶ä¹‹é«˜é˜¶ç»„ä»¶"></a><a href="https://www.cnblogs.com/libin-1/p/7087605.html" target="_blank" rel="noopener">Reactè¿›é˜¶ä¹‹é«˜é˜¶ç»„ä»¶</a></h3><ul>
<li>å±æ€§ä»£ç†</li>
<li>æ¸²æŸ“åŠ«æŒ</li>
<li>åå‘ç»§æ‰¿</li>
</ul>
<blockquote>
<p>å­˜åœ¨ä¸¤ç§é«˜é˜¶ç»„ä»¶ï¼š </p>
<ul>
<li>å±æ€§ä»£ç†â€”ä¸»è¦è¿›è¡Œç»„ä»¶çš„å¤ç”¨</li>
<li>åå‘é›†æˆã€æ¸²æŸ“çš„åŠ«æŒã€‘â€”ä¸»è¦è¿›è¡Œæ¸²æŸ“çš„åŠ«æŒ</li>
</ul>
</blockquote>
<h3 id="ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«-ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"><a href="#ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«-ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥" class="headerlink" title="ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ« ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"></a>ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ« ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥</h3><ul>
<li>ç®­å¤´å‡½æ•°æ˜¯åŒ¿åå‡½æ•°ï¼Œä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨new</li>
<li>ç®­å¤´å‡½æ•°çš„ this æ°¸è¿œæŒ‡å‘å…¶ä¸Šä¸‹æ–‡çš„  this ï¼Œä»»ä½•æ–¹æ³•éƒ½æ”¹å˜ä¸äº†å…¶æŒ‡å‘ï¼Œå¦‚ call() ,  bind() ,  apply() </li>
<li>ç®­å¤´å‡½æ•°é€šè¿‡ call()  æˆ–   apply() æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œåªä¼ å…¥äº†ä¸€ä¸ªå‚æ•°ï¼Œå¯¹ this å¹¶æ²¡æœ‰å½±å“ã€‚</li>
<li>ç®­å¤´å‡½æ•°ä¸èƒ½ç»‘å®šargumentsï¼Œå–è€Œä»£ä¹‹ç”¨restå‚æ•°â€¦è§£å†³</li>
<li>ç®­å¤´å‡½æ•°æ²¡æœ‰åŸå‹å±æ€§</li>
<li>å¤´å‡½æ•°çš„thisæ°¸è¿œæŒ‡å‘å…¶ä¸Šä¸‹æ–‡çš„thisï¼Œæ²¡æœ‰åŠæ”¹å˜å…¶æŒ‡å‘ï¼Œæ™®é€šå‡½æ•°çš„thisæŒ‡å‘è°ƒç”¨å®ƒçš„å¯¹è±¡</li>
<li>ç®­å¤´å‡½æ•°ä¸ç»‘å®šthisï¼Œä¼šæ•è·å…¶æ‰€åœ¨çš„ä¸Šä¸‹æ–‡çš„thiså€¼ï¼Œä½œä¸ºè‡ªå·±çš„thiså€¼</li>
<li>ç®­å¤´å‡½æ•°ä¸èƒ½å½“åšGeneratorå‡½æ•°,ä¸èƒ½ä½¿ç”¨yieldå…³é”®å­—</li>
<li>æ™®é€šå‡½æ•°çš„thisæŒ‡å‘è°ƒç”¨å®ƒçš„é‚£ä¸ªå¯¹è±¡</li>
</ul>
<h3 id="fetch-çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…-fetch-çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…"><a href="#fetch-çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…-fetch-çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…" class="headerlink" title="fetch çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…   fetch çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…"></a>fetch çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…   <a href="https://www.cnblogs.com/ziyunfei/p/6617900.html" target="_blank" rel="noopener">fetch çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…</a></h3><p>å› ä¸ºå— cancelable promise çš„æ‹–å»¶ï¼Œfetch ä¸€ç›´æ²¡æœ‰ä¼ ç»Ÿçš„ XHR æ‰€æ‹¥æœ‰çš„ abort() å’Œ onprogress åŠŸèƒ½ï¼Œå»å¹´å¹´åº• cancelable promise è‰æ¡ˆè¢«å½»åº•åºŸå¼ƒäº†ï¼Œæ‰€ä»¥ä»Šå¹´å¹´åˆçš„è¿™å‡ ä¸ªæœˆé‡Œï¼Œä¸€ä»½å®Œå…¨æ–°çš„ã€fetch ä¸“ç”¨çš„ã€ä¸ä¾èµ– JS è§„èŒƒã€ä¸ Promise æ²¡æœ‰ä»»ä½•ç›´æ¥å…³ç³»çš„è‰æ¡ˆè¯ç”Ÿäº†ï¼Œè€Œä¸” Firefox å·²ç»ç‡å…ˆå®ç°äº†å…¶ä¸­çš„å¤§éƒ¨åˆ†åŠŸèƒ½ã€‚</p>
<p>è¿™ä»½è‰æ¡ˆä¸­å¼•å…¥äº† 3 ç§æ–°çš„å¯¹è±¡ç±»å‹ï¼ŒFetchControllerï¼ˆfetch æ§åˆ¶å™¨ï¼‰ã€FetchSignalï¼ˆfetch ä¿¡å·ï¼‰ã€FetchObserverï¼ˆfetch è§‚å¯Ÿè€…ï¼‰ï¼Œè™½ç„¶è¿™ä¸‰ä¸ªéƒ½æ˜¯å…¨å±€æ„é€ å‡½æ•°ï¼Œä½†å…¶å®åªæœ‰ FetchController å¯¹è±¡æ˜¯çœŸçš„éœ€è¦ä½ æ‰‹åŠ¨ new å‡ºæ¥çš„ï¼Œå…¶å®ƒä¸¤ç§å¯¹è±¡éƒ½æ˜¯æµè§ˆå™¨ä¸ºä½ ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬ä¸‹é¢åˆ†åˆ«æ¼”ç¤ºä¸‹å¦‚ä½•ä¸­æ–­ï¼ˆå–æ¶ˆã€ä¸­æ­¢ï¼‰ä¸€ä¸ª fetch è¯·æ±‚ï¼Œä»¥åŠå¦‚ä½•ç›‘å¬ fetch è¯·æ±‚çš„æ‰§è¡Œè¿›åº¦ã€‚</p>
<h4 id="ä¸­æ–­-fetch-è¯·æ±‚"><a href="#ä¸­æ–­-fetch-è¯·æ±‚" class="headerlink" title="ä¸­æ–­ fetch è¯·æ±‚"></a>ä¸­æ–­ fetch è¯·æ±‚</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">const controller = new FetchController()</span><br><span class="line">const signal = controller.signal</span><br><span class="line"></span><br><span class="line">fetch(&quot;https://tc39.github.io/ecma262/&quot;, &#123; signal &#125;).then(() =&gt; &#123;</span><br><span class="line">  alert(&quot;è¯·æ±‚æˆåŠŸ&quot;)</span><br><span class="line">&#125;).catch(err =&gt; &#123;</span><br><span class="line">  if (err.name === &quot;AbortError&quot;) &#123;</span><br><span class="line">    alert(&quot;è¯·æ±‚è¢«ä¸­æ–­&quot;) </span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">setTimeout(() =&gt; controller.abort(), 500)</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºäº†ä¸€ä¸ª fetch æ§åˆ¶å™¨ controllerï¼Œæ¯ä¸ªæ§åˆ¶å™¨éƒ½è‡ªå¸¦ä¸€ä¸ª fetch ä¿¡å·å¯¹è±¡ï¼ˆsignal å±æ€§ï¼‰ï¼Œç„¶ååœ¨ä½ ç”¨ fetch() å‘é€è¯·æ±‚çš„æ—¶å€™æŠŠè¿™ä¸ªä¿¡å·å¯¹è±¡å¸¦ä¸Šï¼ˆsignal å‚æ•°ï¼‰ã€‚ä¹‹åï¼Œä½ å°±å¯ä»¥é€šè¿‡æ§åˆ¶å™¨çš„ abort() æ–¹æ³•ï¼Œæ¥ä¸­æ–­é‚£ä¸ª fetch è¯·æ±‚äº†ã€‚åªè¦åœ¨ä½ æ‰§è¡Œ abort() æ–¹æ³•çš„æ—¶å€™ï¼Œé‚£ä¸ª fetch è¯·æ±‚è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼ˆè¯·æ±‚è¿˜æ²¡å‘å‡ºå»ã€è¯·æ±‚å‘å‡ºå»äº†è¿˜æ²¡æ¥æ”¶åˆ°å“åº”ã€å“åº”è¿˜æ²¡æ¥æ”¶å®Œï¼‰ï¼Œé‚£ä¹ˆå½“åˆ fetch() è¿”å›çš„é‚£ä¸ª promise å°±ä¼šè¢« rejectï¼Œæ‰€äº§ç”Ÿçš„ error å¯¹è±¡çš„ name ä¸º AbortErrorã€‚</p>
<p>ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æ˜¯åœ¨ 500 æ¯«ç§’çš„æ—¶å€™ä¸­æ–­äº†è¿™ä¸ªè¯·æ±‚ï¼Œè¿™æ˜¯ä¸ªç»å¯¹çš„æ•°å­—ï¼Œæ‰€ä»¥æ ¹æ®ä½ çš„ç½‘é€Ÿä¸åŒï¼Œæ‰§è¡Œä»£ç æ—¶ä½ æœ‰å¯èƒ½ä¼šçœ‹åˆ°å¼¹å‡ºâ€œè¯·æ±‚æˆåŠŸâ€ï¼Œä¹Ÿæœ‰èƒ½çœ‹åˆ°â€œè¯·æ±‚è¢«ä¸­æ–­â€ã€‚</p>
<p>ä¸€ä¸ªä¿¡å·å¯¹è±¡è¿˜å¯ä»¥åŒæ—¶ä¼ é€’ç»™å¤šä¸ª fetch è¯·æ±‚ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> controller = <span class="keyword">new</span> FetchController()</span><br><span class="line"><span class="keyword">const</span> signal = controller.signal</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">"https://tc39.github.io/ecma262/"</span>, &#123; signal &#125;)</span><br><span class="line">fetch(<span class="string">"https://fetch.spec.whatwg.org/"</span>, &#123; signal &#125;)</span><br><span class="line">fetch(<span class="string">"https://dom.spec.whatwg.org/"</span>, &#123; signal &#125;)</span><br><span class="line"></span><br><span class="line">controller.abort() <span class="comment">// åŒæ—¶ä¸­æ–­ä¸‰ä¸ªè¯·æ±‚</span></span><br></pre></td></tr></table></figure></p>
<p>ä¿¡å·å¯¹è±¡æœ‰ä¸€ä¸ª aborted å±æ€§è¡¨æ˜è‡ªå·±æ˜¯å¦å·²ç»è¢«ä¸­æ–­è¿‡äº†ï¼Œä¸€æ—¦è¢«ä¸­æ–­ï¼Œå®ƒä¸å¯èƒ½å›åˆ°å½“åˆçš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä½ ä¸èƒ½äºŒæ¬¡åˆ©ç”¨ä¸€ä¸ªå·²ç»è¢«ä¸­æ–­è¿‡çš„ä¿¡å·å¯¹è±¡ï¼ŒæŠŠè¿™æ ·çš„ä¿¡å·å¯¹è±¡ä¼ ç»™ fetch() çš„è¯ï¼Œfetch() ä¼šç«‹å³ç»“æŸï¼Œä¸ä¼šå‘å‡ºè¯·æ±‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const controller = new FetchController()</span><br><span class="line">const signal = controller.signal</span><br><span class="line"></span><br><span class="line">controller.abort()</span><br><span class="line"></span><br><span class="line">alert(signal.aborted) // true</span><br><span class="line"></span><br><span class="line">fetch(&quot;https://tc39.github.io/ecma262/&quot;, &#123; signal &#125;) // ç›´æ¥è¢« rejectï¼Œè¯·æ±‚ä¸ä¼šå‘å‡º</span><br></pre></td></tr></table></figure></p>
<p>ä¿¡å·å¯¹è±¡ä¸Šè¿˜å¯ä»¥ç›‘å¬ abort äº‹ä»¶ï¼Œä¸è¿‡æˆ‘æƒ³ä¸€èˆ¬ç”¨ä¸ä¸Šï¼Œå› ä¸ºè¯·æ±‚ä¸­æ–­åçš„å¤„ç†ä»£ç ä¸€èˆ¬å†™åœ¨ fetch(â€¦).catch(â€¦) é‡Œé¢ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const controller = new FetchController()</span><br><span class="line">const signal = controller.signal</span><br><span class="line"></span><br><span class="line">signal.addEventListener(&quot;abort&quot;, function(e) &#123; // ä½¿ç”¨ signal.onabort = æ³¨å†Œç›‘å¬å‡½æ•°ä¹Ÿå¯ä»¥</span><br><span class="line">  alert(e.type) // abort</span><br><span class="line">  alert(signal.aborted) // true</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">alert(signal.aborted) // false</span><br><span class="line"></span><br><span class="line">controller.abort()</span><br></pre></td></tr></table></figure></p>
<p>ä¸€ä¸ªæ§åˆ¶å™¨é™¤äº†å¯ä»¥è®©è‡ªå·±çš„ä¿¡å·å¯¹è±¡ abortï¼Œè¿˜å¯ä»¥å…³æ³¨ï¼ˆè·Ÿéšã€ç›‘å¬ï¼‰ä¸€ä¸ªåˆ«çš„æ§åˆ¶å™¨çš„ä¿¡å·å¯¹è±¡ï¼Œåªè¦å…³æ³¨çš„è¿™ä¸ªä¿¡å·å¯¹è±¡è¢« abort äº†ï¼Œè‡ªå·±çš„ abort() æ–¹æ³•å°±ä¼šè¢«è‡ªåŠ¨æ‰§è¡Œï¼Œä»è€Œè‡ªå·±çš„ä¿¡å·å¯¹è±¡ä¹Ÿä¼šè¢« abortï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fc1 = <span class="keyword">new</span> FetchController()</span><br><span class="line"><span class="keyword">const</span> fc2 = <span class="keyword">new</span> FetchController()</span><br><span class="line"></span><br><span class="line">fc1.follow(fc2.signal)</span><br><span class="line"></span><br><span class="line">fc2.abort()</span><br><span class="line"></span><br><span class="line">alert(fc1.signal.aborted) <span class="comment">// trueï¼Œå³ä¾¿ä½ æ²¡æœ‰æ‰‹åŠ¨æ‰§è¡Œ fc1.abort()</span></span><br></pre></td></tr></table></figure>
<p>å†æ¥çœ‹ä¸ªæ›´å¤æ‚çš„ä¾‹å­ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fc1 = <span class="keyword">new</span> FetchController()</span><br><span class="line"><span class="keyword">const</span> fc2 = <span class="keyword">new</span> FetchController()</span><br><span class="line"><span class="keyword">const</span> fc3 = <span class="keyword">new</span> FetchController()</span><br><span class="line"></span><br><span class="line">fc1.follow(fc2.signal)</span><br><span class="line">fc2.follow(fc3.signal)</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">"https://tc39.github.io/ecma262/"</span>, &#123; <span class="attr">signal</span>: fc1.signal &#125;)</span><br><span class="line">fetch(<span class="string">"https://fetch.spec.whatwg.org/"</span>, &#123; <span class="attr">signal</span>: fc2.signal &#125;)</span><br><span class="line">fetch(<span class="string">"https://dom.spec.whatwg.org/"</span>, &#123; <span class="attr">signal</span>: fc3.signal &#125;)</span><br><span class="line"></span><br><span class="line">fc3.abort() <span class="comment">//  ä¸‰ä¸ªè¯·æ±‚éƒ½ä¸­æ–­äº†</span></span><br></pre></td></tr></table></figure></p>
<p>ä¸€ä¸ªæ§åˆ¶å™¨åªèƒ½å…³æ³¨ä¸€ä¸ªåˆ«äººå®¶çš„ä¿¡å·å¯¹è±¡ï¼Œè€Œä¸€ä¸ªä¿¡å·å¯¹è±¡å¯ä»¥è¢«ä»»æ„å¤šä¸ªåˆ«å®¶çš„æ§åˆ¶å™¨å…³æ³¨ã€‚ä¸èƒ½ç›´æ¥æˆ–é—´æ¥çš„å…³æ³¨è‡ªå·±çš„ä¿¡å·å¯¹è±¡ï¼Œæ¯”å¦‚ä¸Šé¢çš„ä»£ç ä¸­å†å¢åŠ ä¸€è¡Œ fc3.follow(fc1.signal) å°±ä¼šäº§ç”Ÿç¯å½¢å…³æ³¨ï¼Œæ‰€ä»¥é‚£å¥ä»£ç ä¼šæ²¡æœ‰ä»»ä½•æ•ˆæœã€‚è¿˜æœ‰ä¸€ä¸ª unfollow() æ–¹æ³•å¯ä»¥å–æ¶ˆå…³æ³¨ã€‚</p>
<p>æ€»ç»“ä¸‹å°±æ˜¯ï¼Œä¸€ä¸ªæ§åˆ¶å™¨å¯¹è±¡æœ‰ä¸€ä¸ª signal å±æ€§æŒ‡å‘ä¸€ä¸ªä¿¡å·å¯¹è±¡ï¼Œè¿˜æœ‰ abort()ã€follow()ã€unfollow() è¿™ä¸‰ä¸ªæ–¹æ³•ã€‚ä¸€ä¸ªä¿¡å·å¯¹è±¡æœ‰ä¸€ä¸ª aborted å±æ€§ï¼Œè¿˜æœ‰ä¸€ä¸ª onabort äº‹ä»¶ç›‘å¬å‡½æ•°ã€‚</p>
<h3 id="ç›‘å¬-fetch-è¯·æ±‚"><a href="#ç›‘å¬-fetch-è¯·æ±‚" class="headerlink" title="ç›‘å¬ fetch è¯·æ±‚"></a>ç›‘å¬ fetch è¯·æ±‚</h3><p>ä¸Šé¢è¯´åˆ°äº† FetchController å’Œ FetchSignalï¼Œæ¥ä¸‹æ¥è¦è¯´è¯´ fetch è§‚å¯Ÿè€… - FetchObserver å¯¹è±¡ã€‚fetch è§‚å¯Ÿè€…å¯¹è±¡ä¸Šå¯ä»¥ç›‘å¬ statechangeã€requestprogressã€responseprogress ä¸‰ç§äº‹ä»¶ï¼Œåˆ†åˆ«ç”¨æ¥è·å– fetch è¯·æ±‚çš„çŠ¶æ€ä¿¡æ¯å˜åŒ–ã€è¯·æ±‚æ•°æ®å‘é€çš„å¤§å°å˜åŒ–ï¼ˆPOST è¯·æ±‚ï¼‰ã€å“åº”æ•°æ®æ¥æ”¶çš„å¤§å°å˜åŒ–ä¿¡æ¯ï¼Œå…ˆæ¥çœ‹çœ‹å¦‚ä½•ç›‘å¬çŠ¶æ€ä¿¡æ¯çš„å˜åŒ–ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">"https://tc39.github.io/ecma262/"</span>, &#123;</span><br><span class="line">  observe(observer) &#123;</span><br><span class="line">    observer.onstatechange = <span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="comment">// ä¹Ÿå¯ä»¥ç”¨ addEventListener("statechange"...</span></span><br><span class="line">      alert(observer.state) <span class="comment">// "requesting"ã€"responding"ã€"aborted", "errored"ã€"complete" ä¸­çš„æŸä¸ªå€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>FetchObserver å¯¹è±¡ä¸ç”¨ä½ æ‰‹åŠ¨ newï¼Œæµè§ˆå™¨ä¼šä¸ºä½  new ä¸€ä¸ªï¼Œåœ¨ fetch è¯·æ±‚å¼€å§‹ä¹‹å‰ï¼Œé€šè¿‡ä½ äº‹å…ˆæŒ‡å®šçš„ observe å›è°ƒå‡½æ•°çš„å‚æ•°ä¼ é€’ç»™ä½ ã€‚ç„¶åä½ åœ¨è¿™ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ä¸Šæ³¨å†Œ statechange ç›‘å¬å‡½æ•°ï¼Œå°±å¯ä»¥åœ¨è¯·æ±‚çš„ä¸åŒé˜¶æ®µæ‰§è¡Œç‰¹å®šçš„ä»£ç äº†ã€‚</p>
<p>ç›‘å¬å“åº”çš„æ¥æ”¶è¿›åº¦ä½¿ç”¨ responseprogress äº‹ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fetch(&quot;https://img.alicdn.com/tfscom/TB1y6icQXXXXXaQXFXXXXXXXXXX.mp4&quot;, &#123;</span><br><span class="line">  observe(observer) &#123;</span><br><span class="line">    observer.onresponseprogress = e =&gt; &#123; </span><br><span class="line">      if(e.lengthComputable) &#123;</span><br><span class="line">        console.log(&quot;è§†é¢‘ä¸‹è½½è¿›åº¦ï¼š&quot; + parseInt(e.loaded / e.total * 100) + &quot;%&quot;)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç›‘å¬ POST æ•°æ®çš„å‘é€è¿›åº¦ä½¿ç”¨ requestprogress äº‹ä»¶ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">"/upload"</span>, &#123;</span><br><span class="line">  method: <span class="string">"POST"</span>,</span><br><span class="line">  credentials: <span class="string">"include"</span>,</span><br><span class="line">  body: canvas.toBlob(),</span><br><span class="line">  observe(observer) &#123;</span><br><span class="line">    observer.onrequestprogress = <span class="function"><span class="params">e</span> =&gt;</span> &#123; </span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">"å›¾ç‰‡ä¸Šä¼ è¿›åº¦ï¼š"</span> + <span class="built_in">parseInt</span>(e.loaded / e.total * <span class="number">100</span>) + <span class="string">"%"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>åœ¨æœ¬æ–‡å‘å¸ƒçš„ç°åœ¨ï¼Œè§„èŒƒè‰æ¡ˆè¿˜åªæ˜¯æœ€åˆçš„é˜¶æ®µï¼Œå¯èƒ½æœ‰å¾ˆå¤šç»†èŠ‚æ²¡è€ƒè™‘ï¼Œç›®å‰ Firefox ä¹Ÿæ²¡æœ‰å®ç°æˆ‘ä¸Šé¢æ‰€è¯´çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå®ç°äº†çš„ä¹Ÿæœ‰ä¸€äº› bugï¼Œè€Œä¸”è¿˜éœ€è¦äº‹å…ˆåœ¨ about:config æ‰‹åŠ¨æ·»åŠ æŸä¸¤ä¸ªé€‰é¡¹æ‰å¯ä»¥ä½¿ç”¨ï¼Œæ‰€ä»¥æœ¬æ–‡ä»…ä»…æ˜¯ç®€è¦ä»‹ç»ï¼Œå¤§å®¶æš‚æ—¶çœ¼ç›çœ‹çœ‹å°±å¤Ÿäº†ã€‚</p>
<p>ä»¥å fetch æ§åˆ¶å™¨çš„åŠŸèƒ½å¯èƒ½è¿˜ä¼šå¢åŠ ï¼Œä¸ä»…ä»…èƒ½è®©ä¸€ä¸ª fetch è¯·æ±‚ä¸­æ–­ï¼Œæ¯”å¦‚è¿˜å¯ä»¥æŒ‡å®šè¿™ä¸ªè¯·æ±‚çš„ä¼˜å…ˆçº§ï¼Œfetch è§‚å¯Ÿè€…åŒæ—¶ä¹Ÿå¯ä»¥ç”¨æ¥ç›‘å¬ fetch è¯·æ±‚ä¼˜å…ˆçº§çš„å˜åŒ–ã€‚</p>
<h3 id="fetché»˜è®¤ä¸æºå¸¦cookie"><a href="#fetché»˜è®¤ä¸æºå¸¦cookie" class="headerlink" title="fetché»˜è®¤ä¸æºå¸¦cookie"></a>fetché»˜è®¤ä¸æºå¸¦cookie</h3><p>fetchå‘é€è¯·æ±‚é»˜è®¤æ˜¯ä¸å‘é€cookieçš„ï¼Œä¸ç®¡æ˜¯åŒåŸŸè¿˜æ˜¯è·¨åŸŸï¼›é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œå¯¹äºé‚£äº›éœ€è¦æƒé™éªŒè¯çš„è¯·æ±‚å°±å¯èƒ½æ— æ³•æ­£å¸¸è·å–æ•°æ®ï¼Œè¿™æ—¶å¯ä»¥é…ç½®å…¶credentialsé¡¹ï¼Œå…¶æœ‰3ä¸ªå€¼ï¼š</p>
<ul>
<li>omit: é»˜è®¤å€¼ï¼Œå¿½ç•¥cookieçš„å‘é€</li>
<li>same-origin: è¡¨ç¤ºcookieåªèƒ½åŒåŸŸå‘é€ï¼Œä¸èƒ½è·¨åŸŸå‘é€</li>
<li>include: cookieæ—¢å¯ä»¥åŒåŸŸå‘é€ï¼Œä¹Ÿå¯ä»¥è·¨åŸŸå‘é€</li>
</ul>
<p>credentialsæ‰€è¡¨è¾¾çš„å«ä¹‰ï¼Œå…¶å®ä¸XHR2ä¸­çš„withCredentialså±æ€§ç±»ä¼¼ï¼Œè¡¨ç¤ºè¯·æ±‚æ˜¯å¦æºå¸¦cookieï¼›å…·ä½“å¯ä»¥å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„è·¨åŸŸèµ„æºå…±äº« CORS è¯¦è§£ä¸­withCredentialsä¸€èŠ‚çš„ä»‹ç»ï¼›<br>è‹¥è¦fetchè¯·æ±‚æºå¸¦cookieä¿¡æ¯ï¼Œåªéœ€è®¾ç½®ä¸€ä¸‹credentialsé€‰é¡¹å³å¯ï¼Œä¾‹å¦‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fetch(url, &#123;credentials: &apos;include&apos;&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject"><a href="#fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject" class="headerlink" title="fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject"></a>fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject</h3><p>è¿™ä¸»è¦æ˜¯ç”±fetchè¿”å›promiseå¯¼è‡´çš„ï¼Œå› ä¸ºfetchè¿”å›çš„promiseåœ¨æŸäº›é”™è¯¯çš„httpçŠ¶æ€ä¸‹å¦‚400 ã€500ç­‰ä¸ä¼šrejectï¼Œç›¸åå®ƒä¼šè¢«resolveï¼›åªæœ‰ç½‘ç»œé”™è¯¯ä¼šå¯¼è‡´è¯·æ±‚ä¸èƒ½å®Œæˆæ—¶ï¼Œfetch æ‰ä¼šè¢« rejectï¼›æ‰€ä»¥ä¸€èˆ¬ä¼šå¯¹fetchè¯·æ±‚åšä¸€å±‚å°è£…ï¼Œä¾‹å¦‚ä¸‹é¢ä»£ç æ‰€ç¤ºï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkStatus</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (response.status &gt;= <span class="number">200</span> &amp;&amp; response.status &lt; <span class="number">300</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> error = <span class="keyword">new</span> <span class="built_in">Error</span>(response.statusText);</span><br><span class="line">  error.response = response;</span><br><span class="line">  <span class="keyword">throw</span> error;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseJSON</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> response.json();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">url, options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> opt = options||&#123;&#125;;</span><br><span class="line">  <span class="keyword">return</span> fetch(url, &#123;<span class="attr">credentials</span>: <span class="string">'include'</span>, ...opt&#125;)</span><br><span class="line">    .then(checkStatus)</span><br><span class="line">    .then(parseJSON)</span><br><span class="line">    .then(<span class="function">(<span class="params">data</span>) =&gt;</span> ( data ))</span><br><span class="line">    .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> ( err ));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†"><a href="#fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†" class="headerlink" title="fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†"></a>fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†</h3><p>ç”¨è¿‡fetchçš„éƒ½çŸ¥é“ï¼Œfetchä¸åƒå¤§å¤šæ•°ajaxåº“é‚£æ ·å¯¹è¯·æ±‚è®¾ç½®è¶…æ—¶timeoutï¼Œå®ƒæ²¡æœ‰æœ‰å…³è¯·æ±‚è¶…æ—¶çš„featureï¼Œè¿™ä¸€ç‚¹æ¯”è¾ƒè›‹ç–¼ã€‚æ‰€ä»¥åœ¨fetchæ ‡å‡†æ·»åŠ è¶…æ—¶featureä¹‹å‰ï¼Œéƒ½éœ€è¦polyfillè¯¥ç‰¹æ€§ã€‚</p>
<p>å®é™…ä¸Šï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯abort()ï¼Œ timeoutå¯ä»¥é€šè¿‡timeout+abortæ–¹å¼æ¥å®ç°ï¼Œèµ·åˆ°çœŸæ­£è¶…æ—¶ä¸¢å¼ƒå½“å‰çš„è¯·æ±‚ã€‚</p>
<p>è€Œåœ¨ç›®å‰çš„fetchæŒ‡å¯¼è§„èŒƒä¸­ï¼Œfetchå¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“å®ä¾‹ï¼Œè€Œåªæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼›å…¶è¿”å›çš„promiseå®ä¾‹æ ¹æ®PromiseæŒ‡å¯¼è§„èŒƒæ ‡å‡†æ˜¯ä¸èƒ½abortçš„ï¼Œä¹Ÿä¸èƒ½æ‰‹åŠ¨æ”¹å˜promiseå®ä¾‹çš„çŠ¶æ€ï¼Œåªèƒ½ç”±å†…éƒ¨æ¥æ ¹æ®è¯·æ±‚ç»“æœæ¥æ”¹å˜promiseçš„çŠ¶æ€ã€‚</p>
<p>æ—¢ç„¶ä¸èƒ½æ‰‹åŠ¨æ§åˆ¶fetchæ–¹æ³•æ‰§è¡Œåè¿”å›çš„promiseå®ä¾‹çŠ¶æ€ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å¯ä»¥åˆ›å»ºä¸€ä¸ªå¯ä»¥æ‰‹åŠ¨æ§åˆ¶çŠ¶æ€çš„æ–°Promiseå®ä¾‹å‘¢ã€‚æ‰€ä»¥ï¼š</p>
<h4 id="æ–¹æ³•ä¸€ï¼šå•çº¯setTimeoutæ–¹å¼"><a href="#æ–¹æ³•ä¸€ï¼šå•çº¯setTimeoutæ–¹å¼" class="headerlink" title="æ–¹æ³•ä¸€ï¼šå•çº¯setTimeoutæ–¹å¼"></a>æ–¹æ³•ä¸€ï¼šå•çº¯setTimeoutæ–¹å¼</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> oldFetchfn = fetch; <span class="comment">//æ‹¦æˆªåŸå§‹çš„fetchæ–¹æ³•</span></span><br><span class="line"><span class="built_in">window</span>.fetch = <span class="function"><span class="keyword">function</span>(<span class="params">input, opts</span>)</span>&#123;<span class="comment">//å®šä¹‰æ–°çš„fetchæ–¹æ³•ï¼Œå°è£…åŸæœ‰çš„fetchæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> timeoutId = setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"fetch timeout"</span>))</span><br><span class="line">        &#125;, opts.timeout);</span><br><span class="line">        oldFetchfn(input, opts).then(</span><br><span class="line">            res=&gt;&#123;</span><br><span class="line">                clearTimeout(timeoutId);</span><br><span class="line">                resolve(res)</span><br><span class="line">            &#125;,</span><br><span class="line">            err=&gt;&#123;</span><br><span class="line">                clearTimeout(timeoutId);</span><br><span class="line">                reject(err)</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ–¹æ³•äºŒï¼šåˆ©ç”¨Promise-raceæ–¹æ³•"><a href="#æ–¹æ³•äºŒï¼šåˆ©ç”¨Promise-raceæ–¹æ³•" class="headerlink" title="æ–¹æ³•äºŒï¼šåˆ©ç”¨Promise.raceæ–¹æ³•"></a>æ–¹æ³•äºŒï¼šåˆ©ç”¨Promise.raceæ–¹æ³•</h4><p>Promise.raceæ–¹æ³•æ¥å—ä¸€ä¸ªpromiseå®ä¾‹æ•°ç»„å‚æ•°ï¼Œè¡¨ç¤ºå¤šä¸ªpromiseå®ä¾‹ä¸­ä»»ä½•ä¸€ä¸ªæœ€å…ˆæ”¹å˜çŠ¶æ€ï¼Œé‚£ä¹ˆraceæ–¹æ³•è¿”å›çš„promiseå®ä¾‹çŠ¶æ€å°±è·Ÿç€æ”¹å˜ï¼Œå…·ä½“å¯ä»¥å‚è€ƒè¿™é‡Œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var oldFetchfn = fetch; //æ‹¦æˆªåŸå§‹çš„fetchæ–¹æ³•</span><br><span class="line">window.fetch = function(input, opts)&#123;//å®šä¹‰æ–°çš„fetchæ–¹æ³•ï¼Œå°è£…åŸæœ‰çš„fetchæ–¹æ³•</span><br><span class="line">    var fetchPromise = oldFetchfn(input, opts);</span><br><span class="line">    var timeoutPromise = new Promise(function(resolve, reject)&#123;</span><br><span class="line">        setTimeout(()=&gt;&#123;</span><br><span class="line">             reject(new Error(&quot;fetch timeout&quot;))</span><br><span class="line">        &#125;, opts.timeout)</span><br><span class="line">    &#125;);</span><br><span class="line">    retrun Promise.race([fetchPromise, timeoutPromise])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="fetchä¸æ”¯æŒå–æ¶ˆè¯·æ±‚"><a href="#fetchä¸æ”¯æŒå–æ¶ˆè¯·æ±‚" class="headerlink" title="fetchä¸æ”¯æŒå–æ¶ˆè¯·æ±‚"></a>fetchä¸æ”¯æŒå–æ¶ˆè¯·æ±‚</h3><p>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹AbortController</p>
<p>é¦–å…ˆé€šè¿‡AbortController() æ„é€ å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªcontrollerå®ä¾‹, ç„¶åé€šè¿‡AbortController.signal å±æ€§è·å–åˆ°å®ƒçš„å…³è”å¯¹è±¡AbortSignal çš„å¼•ç”¨.</p>
<p>å½“ fetch request åˆå§‹åŒ–å, å°† AbortSignal ä½œä¸ºä¸€ä¸ªé€‰é¡¹ä¼ å…¥è¯·æ±‚çš„é€‰é¡¹å‚æ•°ä¸­ (å¦‚ä¸‹ {signal}). è¿™å°†signal,controllerä¸fetchè¯·æ±‚å…³è”èµ·æ¥, å…è®¸æˆ‘ä»¬é€šè¿‡è°ƒç”¨AbortController.abort()æ¥å–æ¶ˆfetchè¯·æ±‚, æ­£å¦‚ä¸‹ç¬¬äºŒä¸ªäº‹ä»¶ç›‘å¬å™¨æ‰€ç¤º.</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">var</span> oldFetchfn = fetch; </span><br><span class="line"><span class="keyword">var</span> controller = <span class="keyword">new</span> AbortController();</span><br><span class="line"><span class="keyword">var</span> signal = controller.signal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> downloadBtn = <span class="built_in">document</span>.querySelector(<span class="string">'.download'</span>);</span><br><span class="line"><span class="keyword">var</span> abortBtn = <span class="built_in">document</span>.querySelector(<span class="string">'.abort'</span>);</span><br><span class="line"></span><br><span class="line">downloadBtn.addEventListener(<span class="string">'click'</span>, fetchVideo);</span><br><span class="line"></span><br><span class="line">abortBtn.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  controller.abort();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Download aborted'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchVideo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  ...</span><br><span class="line">  fetch(url, &#123;signal&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    reports.textContent = <span class="string">'Download error: '</span> + e.message;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Fetch-â€”â€”-ä¸­æ­¢å°šæœªå®Œæˆçš„æ¥å£è¯·æ±‚"><a href="#Fetch-â€”â€”-ä¸­æ­¢å°šæœªå®Œæˆçš„æ¥å£è¯·æ±‚" class="headerlink" title="Fetch â€”â€” ä¸­æ­¢å°šæœªå®Œæˆçš„æ¥å£è¯·æ±‚"></a><a href="https://blog.csdn.net/Wu_shuxuan/article/details/80831150" target="_blank" rel="noopener">Fetch â€”â€” ä¸­æ­¢å°šæœªå®Œæˆçš„æ¥å£è¯·æ±‚</a></h3>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/01/01/JSåŸç”Ÿå¸¸ç”¨APIå¤§å…¨/" rel="prev" title="JSåŸç”Ÿå¸¸ç”¨APIå¤§å…¨">
                JSåŸç”Ÿå¸¸ç”¨APIå¤§å…¨ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/tx.jpg" alt="ææ–Œ">
            
              <p class="site-author-name" itemprop="name">ææ–Œ</p>
              <p class="site-description motion-element" itemprop="description">äººç”Ÿå¦‚é€†æ—…     æˆ‘äº¦æ˜¯è¡Œäºº</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">204</span>
                  <span class="site-state-item-name">æ—¥å¿—</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">121</span>
                  <span class="site-state-item-name">æ ‡ç­¾</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/libin1991" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/57e737f6c4c971005f6bcd8d" target="_blank" title="juejin">
                      
                        <i class="fa fa-fw fa-spinner"></i>juejin</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#fetchè¯·æ±‚å’Œajaxè¯·æ±‚-fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯”"><span class="nav-number">1.</span> <span class="nav-text">fetchè¯·æ±‚å’Œajaxè¯·æ±‚   fetchä¸ajaxï¼ˆXMLHttpRequestï¼‰ç›¸æ¯”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetchå¯ä»¥åœ¨headerä¸­è®¾ç½®CORSè·¨åŸŸ"><span class="nav-number">2.</span> <span class="nav-text">fetchå¯ä»¥åœ¨headerä¸­è®¾ç½®CORSè·¨åŸŸ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ajax"><span class="nav-number">2.1.</span> <span class="nav-text">ajax</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetch"><span class="nav-number">3.</span> <span class="nav-text">fetch</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetchå’Œajax-çš„ä¸»è¦åŒºåˆ«"><span class="nav-number">4.</span> <span class="nav-text">fetchå’Œajax çš„ä¸»è¦åŒºåˆ«</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetchæ¨¡æ‹Ÿabortè¯·æ±‚-ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"><span class="nav-number">5.</span> <span class="nav-text">fetchæ¨¡æ‹Ÿabortè¯·æ±‚ ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ajaxä¸Comet"><span class="nav-number">6.</span> <span class="nav-text">Ajaxä¸Comet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ajax"><span class="nav-number">7.</span> <span class="nav-text">Ajax</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTPç¼“å­˜æœºåˆ¶-200è¿˜æ˜¯304"><span class="nav-number">8.</span> <span class="nav-text">HTTPç¼“å­˜æœºåˆ¶(200è¿˜æ˜¯304)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTPç¼“å­˜æœºåˆ¶åŠåŸç†"><span class="nav-number">9.</span> <span class="nav-text">HTTPç¼“å­˜æœºåˆ¶åŠåŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BFCæ˜¯ä»€ä¹ˆ"><span class="nav-number">10.</span> <span class="nav-text">BFCæ˜¯ä»€ä¹ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»€ä¹ˆæ˜¯BFCï¼Ÿ"><span class="nav-number">11.</span> <span class="nav-text">ä»€ä¹ˆæ˜¯BFCï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BFCçš„å¸ƒå±€è§„åˆ™-ä»€ä¹ˆæ˜¯BFCï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†"><span class="nav-number">12.</span> <span class="nav-text">BFCçš„å¸ƒå±€è§„åˆ™ ä»€ä¹ˆæ˜¯BFCï¼Ÿçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚"><span class="nav-number">12.1.</span> <span class="nav-text">BFCå°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¦‚ä½•åˆ›å»ºBFC"><span class="nav-number">13.</span> <span class="nav-text">å¦‚ä½•åˆ›å»ºBFC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BFCçš„ä½œç”¨"><span class="nav-number">14.</span> <span class="nav-text">BFCçš„ä½œç”¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"><span class="nav-number">15.</span> <span class="nav-text">ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#React-HOCçš„ä¸¤ç§å®è·µ"><span class="nav-number">16.</span> <span class="nav-text">React HOCçš„ä¸¤ç§å®è·µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä»-0-åˆ°-1-å®ç°-React-ç³»åˆ—-â€”â€”-5-PureComponent-å®ç°-amp-amp-HOC-æ¢å¹½"><span class="nav-number">17.</span> <span class="nav-text">ä» 0 åˆ° 1 å®ç° React ç³»åˆ— â€”â€” 5.PureComponent å®ç° &amp;&amp; HOC æ¢å¹½</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reacté«˜é˜¶ç»„ä»¶çš„ç†è§£"><span class="nav-number">18.</span> <span class="nav-text">reacté«˜é˜¶ç»„ä»¶çš„ç†è§£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reactè¿›é˜¶ä¹‹é«˜é˜¶ç»„ä»¶"><span class="nav-number">19.</span> <span class="nav-text">Reactè¿›é˜¶ä¹‹é«˜é˜¶ç»„ä»¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«-ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥"><span class="nav-number">20.</span> <span class="nav-text">ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ« ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetch-çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…-fetch-çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…"><span class="nav-number">21.</span> <span class="nav-text">fetch çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…   fetch çš„æ§åˆ¶å™¨å’Œè§‚å¯Ÿè€…</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¸­æ–­-fetch-è¯·æ±‚"><span class="nav-number">21.1.</span> <span class="nav-text">ä¸­æ–­ fetch è¯·æ±‚</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç›‘å¬-fetch-è¯·æ±‚"><span class="nav-number">22.</span> <span class="nav-text">ç›‘å¬ fetch è¯·æ±‚</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetché»˜è®¤ä¸æºå¸¦cookie"><span class="nav-number">23.</span> <span class="nav-text">fetché»˜è®¤ä¸æºå¸¦cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject"><span class="nav-number">24.</span> <span class="nav-text">fetchè¯·æ±‚å¯¹æŸäº›é”™è¯¯httpçŠ¶æ€ä¸ä¼šreject</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†"><span class="nav-number">25.</span> <span class="nav-text">fetchä¸æ”¯æŒè¶…æ—¶timeoutå¤„ç†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ–¹æ³•ä¸€ï¼šå•çº¯setTimeoutæ–¹å¼"><span class="nav-number">25.1.</span> <span class="nav-text">æ–¹æ³•ä¸€ï¼šå•çº¯setTimeoutæ–¹å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ–¹æ³•äºŒï¼šåˆ©ç”¨Promise-raceæ–¹æ³•"><span class="nav-number">25.2.</span> <span class="nav-text">æ–¹æ³•äºŒï¼šåˆ©ç”¨Promise.raceæ–¹æ³•</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fetchä¸æ”¯æŒå–æ¶ˆè¯·æ±‚"><span class="nav-number">26.</span> <span class="nav-text">fetchä¸æ”¯æŒå–æ¶ˆè¯·æ±‚</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fetch-â€”â€”-ä¸­æ­¢å°šæœªå®Œæˆçš„æ¥å£è¯·æ±‚"><span class="nav-number">27.</span> <span class="nav-text">Fetch â€”â€” ä¸­æ­¢å°šæœªå®Œæˆçš„æ¥å£è¯·æ±‚</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ææ–Œ</span>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

  
  <!--
  	æè¿°ï¼šç‚¹å‡»çº¢å¿ƒ
  -->
  <script type="text/javascript" src="/js/src/clicklove.js"></script>
  <!--
  	æè¿°ï¼šå¤åˆ¶ä»£ç 
  -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
</body>
</html>


